
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The Data Science Extensions provides helpful utilities and extensions for data science projects.">
      
      
        <meta name="author" content="[Chris Mahoney](mailto:chris@mahoneyconsultingservices.com)">
      
      
      
        <link rel="prev" href="../">
      
      
      
      <link rel="icon" href="../../assets/images/dse.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Querying Data - Data Science Extensions</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CConsolas,+'Courier+New',+monospace:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Consolas, 'Courier New', monospace"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/style.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/admonitions.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/code_chunks.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/columns.css">
    
      <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.4.2/css/all.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-querying-for-data-scientists" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Data Science Extensions" class="md-header__button md-logo" aria-label="Data Science Extensions" data-md-component="logo">
      
  <img src="../../assets/images/dse.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Data Science Extensions
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Querying Data
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/data-science-extensions/data-science-extensions" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </div>
  <div class="md-source__repository">
    data-science-extensions
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../toolboxes/toolbox-python/" class="md-tabs__link">
          
  
  
    
  
  Toolboxes

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Data Science Extensions" class="md-nav__button md-logo" aria-label="Data Science Extensions" data-md-component="logo">
      
  <img src="../../assets/images/dse.png" alt="logo">

    </a>
    Data Science Extensions
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/data-science-extensions/data-science-extensions" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </div>
  <div class="md-source__repository">
    data-science-extensions
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Toolboxes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Toolboxes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../toolboxes/toolbox-python/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.25.18.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"/></svg>
  
  <span class="md-ellipsis">
    Python Toolbox
    
      <br>
      <small>Helper files/functions/classes for generic Python processes</small>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../toolboxes/toolbox-pyspark/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.6 3.6 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a552 552 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a5 5 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535q.001.033 0 .073c-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098q.523.174 1.045.347h.001q.03.017.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.8 2.8 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353 353 0 0 0-2.421-4.018 4.6 4.6 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.6.6 0 0 1 .189.211q1.307 2.168 2.609 4.338c.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217q.55-.146 1.103-.289a.4.4 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019q-.807-.269-1.615-.539c-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.4.4 0 0 1-.18.132q.051-.567.104-1.136.222-2.358.451-4.716c-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.6.6 0 0 1 .24-.134q2.695-.856 5.394-1.705c.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441q.362-2.045.726-4.088.104-.578.21-1.157"/></svg>
  
  <span class="md-ellipsis">
    PySpark Toolbox
    
      <br>
      <small>Helper files/functions/classes for generic PySpark processes</small>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../toolboxes/synthetic-data-generators/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 8c-1.5 0-2.3 1.4-1.9 2.5l-3.6 3.6c-.3-.1-.7-.1-1 0l-2.6-2.6c.4-1.1-.4-2.5-1.9-2.5-1.4 0-2.3 1.4-1.9 2.5L3.5 16c-1.1-.3-2.5.5-2.5 2 0 1.1.9 2 2 2 1.4 0 2.3-1.4 1.9-2.5l4.5-4.6c.3.1.7.1 1 0l2.6 2.6c-.3 1 .5 2.5 2 2.5s2.3-1.4 1.9-2.5l3.6-3.6c1.1.3 2.5-.5 2.5-1.9 0-1.1-.9-2-2-2m-6 1 .9-2.1L18 6l-2.1-.9L15 3l-.9 2.1L12 6l2.1.9zM3.5 11 4 9l2-.5L4 8l-.5-2L3 8l-2 .5L3 9z"/></svg>
  
  <span class="md-ellipsis">
    Synthetic Data Generators
    
      <br>
      <small>Helper methods for generating synthetic data for testing and development</small>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Querying Data
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Querying Data
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-comprehensive-guide-of-using-pandas-sql-pyspark-and-polars-for-data-manipulation-techniques-with-practical-examples-and-visualisations" class="md-nav__link">
    <span class="md-ellipsis">
      A Comprehensive Guide of using Pandas, SQL, PySpark, and Polars for Data Manipulation Techniques, with Practical Examples and Visualisations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview-of-the-different-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      Overview of the Different Libraries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      Create the DataFrames
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-filtering-and-selecting" class="md-nav__link">
    <span class="md-ellipsis">
      1. Filtering and Selecting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-grouping-and-aggregation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Grouping and Aggregation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-joining" class="md-nav__link">
    <span class="md-ellipsis">
      3. Joining
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-window-functions" class="md-nav__link">
    <span class="md-ellipsis">
      4. Window Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-ranking-and-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      5. Ranking and Partitioning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conclusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tool-comparison-and-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Tool Comparison and Use Cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-techniques-covered" class="md-nav__link">
    <span class="md-ellipsis">
      Key Techniques Covered
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices-and-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices and Recommendations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#moving-forward" class="md-nav__link">
    <span class="md-ellipsis">
      Moving Forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-comprehensive-guide-of-using-pandas-sql-pyspark-and-polars-for-data-manipulation-techniques-with-practical-examples-and-visualisations" class="md-nav__link">
    <span class="md-ellipsis">
      A Comprehensive Guide of using Pandas, SQL, PySpark, and Polars for Data Manipulation Techniques, with Practical Examples and Visualisations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview-of-the-different-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      Overview of the Different Libraries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      Create the DataFrames
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-filtering-and-selecting" class="md-nav__link">
    <span class="md-ellipsis">
      1. Filtering and Selecting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-grouping-and-aggregation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Grouping and Aggregation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-joining" class="md-nav__link">
    <span class="md-ellipsis">
      3. Joining
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-window-functions" class="md-nav__link">
    <span class="md-ellipsis">
      4. Window Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-ranking-and-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      5. Ranking and Partitioning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conclusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tool-comparison-and-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Tool Comparison and Use Cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-techniques-covered" class="md-nav__link">
    <span class="md-ellipsis">
      Key Techniques Covered
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices-and-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices and Recommendations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#moving-forward" class="md-nav__link">
    <span class="md-ellipsis">
      Moving Forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/data-science-extensions/data-science-extensions/edit/main/docs/guides/querying-data/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/data-science-extensions/data-science-extensions/raw/main/docs/guides/querying-data/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="data-querying-for-data-scientists">Data Querying for Data Scientists<a class="headerlink" href="#data-querying-for-data-scientists" title="Permanent link">🔗</a></h1>
<h3 id="a-comprehensive-guide-of-using-pandas-sql-pyspark-and-polars-for-data-manipulation-techniques-with-practical-examples-and-visualisations">A Comprehensive Guide of using Pandas, SQL, PySpark, and Polars for Data Manipulation Techniques, with Practical Examples and Visualisations<a class="headerlink" href="#a-comprehensive-guide-of-using-pandas-sql-pyspark-and-polars-for-data-manipulation-techniques-with-practical-examples-and-visualisations" title="Permanent link">🔗</a></h3>
<p>If you wanted to run the code yourself, you can download just that Jupyter notebook:</p>
<p><a :download=":download" class="md-button md-button-fifth" href="index-r.ipynb"><img alt="" src="../../assets/images/dse.png" width="70px" /><br>Download<br>- ALL</a>
<a :download=":download" class="md-button md-button-fifth" href="index-pandas-r.ipynb"><img alt="" src="../../assets/icons/pandas.svg" width="100%" /><br>Download<br>- Pandas</a>
<a :download=":download" class="md-button md-button-fifth" href="index-sql-r.ipynb"><img alt="" src="../../assets/icons/sql.svg" width="100%" /><br>Download<br>- SQL</a>
<a :download=":download" class="md-button md-button-fifth" href="index-pyspark-r.ipynb"><img alt="" src="../../assets/icons/spark.svg" width="100%" /><br>Download<br>- PySpark</a>
<a :download=":download" class="md-button md-button-fifth" href="index-polars-r.ipynb"><img alt="" src="../../assets/icons/polars.svg" width="100%" /><br>Download<br>- Polars</a></p>
<p>Or you can follow along on this page...</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">🔗</a></h2>
<p>Working as a Data Scientist or Data Engineer often involves querying data from various sources. There are many tools and libraries available to perform these tasks, each with its own strengths and weaknesses. Also, there are many different ways to achieve similar results, depending on the tool or library used. It's important to be familiar with these different methods to choose the best one for your specific use case.</p>
<p>This article provides a comprehensive guide on how to query data using different tools and libraries, including Pandas, SQL, PySpark, and Polars. Each section will cover the setup, data creation, and various querying techniques such as filtering, grouping, joining, window functions, ranking, and sorting. The output will be identical across all tools, but the transformations will be implemented using the specific syntax and features of each library. Therefore allowing you to compare the different approaches and understand the nuances of each method.</p>
<h2 id="overview-of-the-different-libraries">Overview of the Different Libraries<a class="headerlink" href="#overview-of-the-different-libraries" title="Permanent link">🔗</a></h2>
<p>Before we dive into the querying techniques, let's take a moment to understand the different libraries and tools we will be using in this article. Each library has its own strengths and weaknesses, and understanding these can help you choose the right tool for your specific use case.</p>
<p>Throughout this article, you can easily switch between the different libraries by selecting the appropriate tab. Each section will provide the same functionality, but implemented using the specific syntax and features of each library.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Pandas</label><label for="__tabbed_1_2">SQL</label><label for="__tabbed_1_3">PySpark</label><label for="__tabbed_1_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a href="https://pandas.pydata.org/">Pandas</a> is a powerful data manipulation library in Python that provides data structures and functions for working with structured data. It is widely used for data analysis and manipulation tasks.</p>
<p>Historically, Pandas was one of the first libraries to provide a DataFrame structure, which is similar to a table in a relational database. It allows for easy data manipulation, filtering, grouping, and aggregation. Pandas is built on top of <a href="https://numpy.org/">NumPy</a> and provides a high-level interface for working with data. It is particularly well-suited for small to medium-sized datasets and is often used in Data Science and Machine Learning workflows.</p>
<p>Pandas provides a rich set of functionalities for data manipulation, including filtering, grouping, joining, and window functions. It also integrates well with other libraries such as Matplotlib and Seaborn for data visualization, making it a popular choice among data scientists and analysts.</p>
<p>While Pandas is both powerful and popular, it is important to note that it operates <strong>in-memory</strong>, which means that it may not be suitable for very large datasets that do not fit into memory. In such cases, other libraries like PySpark or Polars may be more appropriate.</p>
</div>
<div class="tabbed-block">
<p><a href="https://en.wikipedia.org/wiki/SQL">SQL</a> (Structured Query Language) is a standard language for managing and manipulating relational databases. It is widely used for querying and modifying data in databases. SQL is a declarative language, meaning that you specify what you want to retrieve or manipulate without detailing how to do it. This makes SQL queries concise and expressive. SQL is particularly well-suited for working with large datasets and complex queries. It provides powerful features for filtering, grouping, joining, and aggregating data. SQL is the backbone of many database systems.</p>
<p>SQL is actually a language (like Python is a language), not a library (like Pandas is a library), and it is used to interact with relational databases. The core of the SQL language is actually an <a href="https://www.iso.org/standard/76583.html">ISO standard</a>, which means that the basic syntax and functionality are consistent across different database systems. However, each database system may have its own extensions or variations of SQL, which can lead to differences in syntax and features. Each database system can be considered as variations (or dialects) of SQL, with their own specific features and optimizations and syntax enhancements.</p>
<p>Some of the more popular SQL dialects include:</p>
<div class="mdx-three-columns" markdown>
<ul>
<li><a href="https://sqlite.org/">SQLite</a></li>
<li><a href="https://www.postgresql.org/">PostgreSQL</a></li>
<li><a href="https://www.mysql.com/">MySQL</a></li>
<li><a href="https://spark.apache.org/sql/">Spark SQL</a></li>
<li><a href="https://learn.microsoft.com/en-us/sql/t-sql/">SQL Server (t-SQL)</a></li>
<li><a href="https://www.oracle.com/au/database/technologies/appdev/plsql.html">Oracle SQL (pl-SQL)</a></li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><a href="https://spark.apache.org/docs/latest/api/python/">PySpark</a> is the Python API for Apache Spark, a distributed computing framework that allows for large-scale data processing. PySpark provides a high-level interface for working with Spark, making it easier to write distributed data processing applications in Python. It is particularly well-suited for big data processing and analytics.</p>
<p>PySpark provides a DataFrame API similar to Pandas, but it is designed to work with large datasets that do not fit into memory. It allows for distributed data processing across a cluster of machines, making it suitable for big data applications. PySpark supports various data sources, including <a href="https://hadoop.apache.org/docs/r1.2.1/hdfs_design.html">HDFS</a>, <a href="https://aws.amazon.com/s3/">S3</a>, <a href="https://learn.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-introduction">ADLS</a>, and <a href="https://spark.apache.org/docs/latest/sql-data-sources-jdbc.html">JDBC</a>, and provides powerful features for filtering, grouping, joining, and aggregating data.</p>
<p>While PySpark is a powerful tool for big data processing, it can be more complex to set up and use compared to Pandas. It requires a Spark cluster and may have a steeper learning curve for those unfamiliar with distributed computing concepts. However, it is an excellent choice for processing large datasets and performing complex data transformations.</p>
</div>
<div class="tabbed-block">
<p><a href="https://www.pola.rs/">Polars</a> is a fast DataFrame library for Python that is designed for high-performance data manipulation. It is built on top of Rust and provides a DataFrame API similar to Pandas, but with a focus on performance and memory efficiency. Polars is particularly well-suited for large datasets and complex queries.</p>
<p>Polars supports lazy evaluation, which allows for optimizations in query execution. Polars also provides powerful features for filtering, grouping, joining, and aggregating data, making it a great choice for data analysis tasks.</p>
<p>While Polars is a relatively new library compared to Pandas, it has gained popularity for its performance and ease of use. It is designed to be a drop-in replacement for Pandas, allowing users to leverage its performance benefits without significant changes to their existing code. It is particularly useful for data scientists and analysts who need to work with large datasets and require fast data manipulation capabilities. The setup is simple and straightforward, similar to Pandas, and less complex than PySpark. It is a great choice for data analysis tasks that require high performance and memory efficiency.</p>
</div>
</div>
</div>
<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">🔗</a></h2>
<p>Before we start querying data, we need to set up our environment. This includes importing the necessary libraries, creating sample data, and defining constants that will be used throughout the article. The following sections will guide you through this setup process. The code for this article is also available on GitHub: <a href="https://github.com/data-science-extensions/data-science-extensions/blob/main/docs/guides/querying-data/index.md">querying-data</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:4"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><input id="__tabbed_2_4" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Pandas</label><label for="__tabbed_2_2">SQL</label><label for="__tabbed_2_3">PySpark</label><label for="__tabbed_2_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># StdLib Imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>

<span class="c1"># Third Party Imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly</span><span class="w"> </span><span class="kn">import</span> <span class="n">express</span> <span class="k">as</span> <span class="n">px</span><span class="p">,</span> <span class="n">graph_objects</span> <span class="k">as</span> <span class="n">go</span><span class="p">,</span> <span class="n">io</span> <span class="k">as</span> <span class="n">pio</span>


<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Determine the number of records to generate</span>
<span class="n">n_records</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Set default Plotly template</span>
<span class="n">pio</span><span class="o">.</span><span class="n">templates</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;simple_white+gridon&quot;</span>

<span class="c1"># Set Pandas display options</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># StdLib Imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>

<span class="c1"># Third Party Imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly</span><span class="w"> </span><span class="kn">import</span> <span class="n">express</span> <span class="k">as</span> <span class="n">px</span><span class="p">,</span> <span class="n">graph_objects</span> <span class="k">as</span> <span class="n">go</span><span class="p">,</span> <span class="n">io</span> <span class="k">as</span> <span class="n">pio</span>


<span class="c1"># Set default Plotly template</span>
<span class="n">pio</span><span class="o">.</span><span class="n">templates</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;simple_white+gridon&quot;</span>

<span class="c1"># Set Pandas display options</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># StdLib Imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>

<span class="c1"># Third Party Imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly</span><span class="w"> </span><span class="kn">import</span> <span class="n">express</span> <span class="k">as</span> <span class="n">px</span><span class="p">,</span> <span class="n">graph_objects</span> <span class="k">as</span> <span class="n">go</span><span class="p">,</span> <span class="n">io</span> <span class="k">as</span> <span class="n">pio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">psDataFrame</span><span class="p">,</span>
    <span class="n">SparkSession</span><span class="p">,</span>
    <span class="n">Window</span><span class="p">,</span>
    <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span><span class="p">,</span>
    <span class="n">types</span> <span class="k">as</span> <span class="n">T</span><span class="p">,</span>
<span class="p">)</span>


<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Determine the number of records to generate</span>
<span class="n">n_records</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Set default Plotly template</span>
<span class="n">pio</span><span class="o">.</span><span class="n">templates</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;simple_white+gridon&quot;</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># StdLib Imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>

<span class="c1"># Third Party Imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly</span><span class="w"> </span><span class="kn">import</span> <span class="n">express</span> <span class="k">as</span> <span class="n">px</span><span class="p">,</span> <span class="n">graph_objects</span> <span class="k">as</span> <span class="n">go</span><span class="p">,</span> <span class="n">io</span> <span class="k">as</span> <span class="n">pio</span>


<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Determine the number of records to generate</span>
<span class="n">n_records</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Set default Plotly template</span>
<span class="n">pio</span><span class="o">.</span><span class="n">templates</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;simple_white+gridon&quot;</span>

<span class="c1"># Set Polars display options</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">set_tbl_cols</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p>Once the setup is complete, we can proceed to create our sample data. This data will be used for querying and will be consistent across all libraries. All tables will be created from scratch with randomly generated data to simulate a real-world scenario. This is to ensure that the examples are self-contained and can be run without any external dependencies, and also there is no issues about data privacy or security.</p>
<p>For the below data creation steps, we will be defining the tables using Python dictionaries. Each dictionary will represent a table, with keys as column names and values as lists of data. We will then convert these dictionaries into DataFrames or equivalent structures in each library.</p>
<p>First, we will create a sales fact table. This table will contain information about sales transactions, including the date, customer ID, product ID, category, sales amount, and quantity sold.</p>
<div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Create Sales Fact Data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">n_records</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
    <span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">n_records</span><span class="p">),</span>
    <span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">n_records</span><span class="p">),</span>
    <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;Electronics&quot;</span><span class="p">,</span> <span class="s2">&quot;Clothing&quot;</span><span class="p">,</span> <span class="s2">&quot;Food&quot;</span><span class="p">,</span> <span class="s2">&quot;Books&quot;</span><span class="p">,</span> <span class="s2">&quot;Home&quot;</span><span class="p">],</span> <span class="n">n_records</span><span class="p">),</span>
    <span class="s2">&quot;sales_amount&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">n_records</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n_records</span><span class="p">),</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Next, we will create a product dimension table. This table will contain information about products, including the product ID, name, price, category, and supplier ID.</p>
<div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Create Product Dimension Data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">product_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
    <span class="s2">&quot;product_name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Product </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)],</span>
    <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;Electronics&quot;</span><span class="p">,</span> <span class="s2">&quot;Clothing&quot;</span><span class="p">,</span> <span class="s2">&quot;Food&quot;</span><span class="p">,</span> <span class="s2">&quot;Books&quot;</span><span class="p">,</span> <span class="s2">&quot;Home&quot;</span><span class="p">],</span> <span class="mi">50</span><span class="p">),</span>
    <span class="s2">&quot;supplier_id&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Finally, we will create a customer dimension table. This table will contain information about customers, including the customer ID, name, city, state, and segment.</p>
<div class="python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Create Customer Dimension Data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">customer_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">),</span>
    <span class="s2">&quot;customer_name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Customer </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)],</span>
    <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;Los Angeles&quot;</span><span class="p">,</span> <span class="s2">&quot;Chicago&quot;</span><span class="p">,</span> <span class="s2">&quot;Houston&quot;</span><span class="p">,</span> <span class="s2">&quot;Phoenix&quot;</span><span class="p">],</span> <span class="mi">100</span><span class="p">),</span>
    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;NY&quot;</span><span class="p">,</span> <span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;IL&quot;</span><span class="p">,</span> <span class="s2">&quot;TX&quot;</span><span class="p">,</span> <span class="s2">&quot;AZ&quot;</span><span class="p">],</span> <span class="mi">100</span><span class="p">),</span>
    <span class="s2">&quot;segment&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;Consumer&quot;</span><span class="p">,</span> <span class="s2">&quot;Corporate&quot;</span><span class="p">,</span> <span class="s2">&quot;Home Office&quot;</span><span class="p">],</span> <span class="mi">100</span><span class="p">),</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now that we have our sample data created, we can proceed to the querying section. Each of the following sections will demonstrate how to perform similar operations using the different libraries and methods, allowing you to compare and contrast their capabilities.</p>
<h2 id="create-the-dataframes">Create the DataFrames<a class="headerlink" href="#create-the-dataframes" title="Permanent link">🔗</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="3:4"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><input id="__tabbed_3_4" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Pandas</label><label for="__tabbed_3_2">SQL</label><label for="__tabbed_3_3">PySpark</label><label for="__tabbed_3_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>To create the dataframes in Pandas, we will use the data we generated earlier. We will parse the dictionaries into Pandas DataFrames, which will allow us to perform various data manipulation tasks.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Create DataFrames</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df_sales_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sales_data</span><span class="p">)</span>
<span class="n">df_product_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">product_data</span><span class="p">)</span>
<span class="n">df_customer_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">customer_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Once the data is created, we can check that it has been loaded correctly by displaying the first few rows of each DataFrame. To do this, we will use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html"><code>.head()</code></a> method to display the first 5 rows of each DataFrame, and then parse to the <a href="https://docs.python.org/3/library/functions.html#print"><code>print()</code></a> function to display the DataFrame in a readable format.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Sales DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales DataFrame: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>        date  customer_id  product_id     category  sales_amount  quantity
0 2023-01-01           52          45         Food        490.76         7
1 2023-01-02           93          41  Electronics        453.94         5
2 2023-01-03           15          29         Home        994.51         5
3 2023-01-04           72          15  Electronics        184.17         7
4 2023-01-05           61          45         Food         27.89         9
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Product DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product DataFrame: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_product_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_product_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_product_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Product DataFrame: 50
</code></pre></div>
<div class="highlight"><pre><span></span><code>   product_id product_name   price  category  supplier_id
0           1    Product 1  257.57      Food            8
1           2    Product 2  414.96  Clothing            5
2           3    Product 3  166.82  Clothing            8
3           4    Product 4  448.81      Food            4
4           5    Product 5  200.71      Food            8
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">supplier_id</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Product 1</td>
<td style="text-align: right;">257.57</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Product 2</td>
<td style="text-align: right;">414.96</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Product 3</td>
<td style="text-align: right;">166.82</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Product 4</td>
<td style="text-align: right;">448.81</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 5</td>
<td style="text-align: right;">200.71</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Customer DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer DataFrame: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_customer_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_customer_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_customer_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Customer DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>   customer_id customer_name         city state      segment
0            1    Customer 1      Phoenix    NY    Corporate
1            2    Customer 2      Phoenix    CA  Home Office
2            3    Customer 3      Phoenix    NY  Home Office
3            4    Customer 4  Los Angeles    NY     Consumer
4            5    Customer 5  Los Angeles    IL  Home Office
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: left;">customer_name</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">segment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Customer 1</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Corporate</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Customer 2</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">Home Office</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Customer 3</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Home Office</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Customer 4</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Consumer</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Customer 5</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">IL</td>
<td style="text-align: left;">Home Office</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>To create the dataframes in SQL, we will use the data we generated earlier. Firstly, we need to create the SQLite database. This will be an in-memory database for demonstration purposes, but in a real-world scenario, you would typically connect to a persistent (on-disk) database. To do this, we will use the <a href="https://docs.python.org/3/library/sqlite3.html"><code>sqlite3</code></a> library to create a connection to the database, which we define with the <code>:memory:</code> parameter on the <a href="https://docs.python.org/3/library/sqlite3.html#sqlite3.connect"><code>.connect()</code></a> function. The result is to create a temporary database that exists only during the lifetime of the connection.</p>
<p>Next, we will then parse the dictionaries into Pandas DataFrames, which will then be loaded into an SQLite database. This allows us to perform various data manipulation tasks using SQL queries.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Create DataFrames</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Creates SQLite database and tables</span>
<span class="n">conn</span><span class="p">:</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Connection</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;:memory:&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sales_data</span><span class="p">)</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">product_data</span><span class="p">)</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">customer_data</span><span class="p">)</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;customer&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Once the data is created, we can check that it has been loaded correctly by displaying the first few rows of each DataFrame. To do this, we will use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_sql.html"><code>pd.read_sql()</code></a> function to execute SQL queries and retrieve the data from the database. We will then parse the results to the <a href="https://docs.python.org/3/library/functions.html#print"><code>print()</code></a> function to display the DataFrame in a readable format.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Sales DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales Table: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM sales&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM sales LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM sales LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales Table: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>                  date  customer_id  product_id     category  sales_amount  quantity
0  2023-01-01 00:00:00           52          45         Food        490.76         7
1  2023-01-02 00:00:00           93          41  Electronics        453.94         5
2  2023-01-03 00:00:00           15          29         Home        994.51         5
3  2023-01-04 00:00:00           72          15  Electronics        184.17         7
4  2023-01-05 00:00:00           61          45         Food         27.89         9
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Product DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product Table: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM product&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM product LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM product LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Product Table: 50
</code></pre></div>
<div class="highlight"><pre><span></span><code>   product_id product_name   price  category  supplier_id
0           1    Product 1  257.57      Food            8
1           2    Product 2  414.96  Clothing            5
2           3    Product 3  166.82  Clothing            8
3           4    Product 4  448.81      Food            4
4           5    Product 5  200.71      Food            8
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">supplier_id</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Product 1</td>
<td style="text-align: right;">257.57</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Product 2</td>
<td style="text-align: right;">414.96</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Product 3</td>
<td style="text-align: right;">166.82</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Product 4</td>
<td style="text-align: right;">448.81</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 5</td>
<td style="text-align: right;">200.71</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Customer DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer Table: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM customer&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM customer LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM customer LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Customer Table: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>   customer_id customer_name         city state      segment
0            1    Customer 1      Phoenix    NY    Corporate
1            2    Customer 2      Phoenix    CA  Home Office
2            3    Customer 3      Phoenix    NY  Home Office
3            4    Customer 4  Los Angeles    NY     Consumer
4            5    Customer 5  Los Angeles    IL  Home Office
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: left;">customer_name</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">segment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Customer 1</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Corporate</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Customer 2</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">Home Office</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Customer 3</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Home Office</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Customer 4</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Consumer</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Customer 5</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">IL</td>
<td style="text-align: left;">Home Office</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>Spark DataFrames are similar to Pandas DataFrames, but they are designed to work with large datasets that do not fit into memory. They can be distributed across a cluster of machines, allowing for parallel processing of data.</p>
<p>To create the dataframes in PySpark, we will use the data we generated earlier. We will first create a Spark session, which is the entry point to using PySpark. Then, we will parse the dictionaries into PySpark DataFrames, which will allow us to perform various data manipulation tasks.</p>
<p>The PySpark session is created using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.SparkSession.html#pyspark.sql.SparkSession.builder"><code>.builder</code></a> method on the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.SparkSession.html"><code>SparkSession</code></a> class, which allows us to configure the session with various options such as the application name. The <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.SparkSession.builder.getOrCreate.html"><code>.getOrCreate()</code></a> method is used to either get an existing session or create a new one if it doesn't exist.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Create Spark Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;SalesAnalysis&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>Once the Spark session is created, we can create the DataFrames from the dictionaries. We will  use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.SparkSession.createDataFrame.html"><code>.createDataFrame()</code></a> method on the Spark session to convert the dictionaries into PySpark DataFrames. The <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.SparkSession.createDataFrame.html"><code>.createDataFrame()</code></a> method is expecting the data to be oriented by <em>row</em>. Meaning that the data should be in the form of a list of dictionaries, where each dictionary represents a row of data. However, we currently have our data is oriented by <em>column</em>, where the dictionarieshave keys as column names and values as lists of data. Therefore, we will first need to convert the dictionaries from <em>column</em> orientation to <em>row</em> orientation. The easiest way to do this is by parse'ing the data to a Pandas DataFrames, and then using that to create our PySpark DataFrames from there.</p>
<p>A good description of how to create PySpark DataFrames from Python Dictionaries can be found in the PySpark documentation: <a href="https://sparkbyexamples.com/pyspark/pyspark-create-dataframe-from-dictionary/">PySpark Create DataFrame From Dictionary</a>.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Create DataFrames</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sales_data</span><span class="p">))</span>
<span class="n">df_product_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">product_data</span><span class="p">))</span>
<span class="n">df_customer_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">customer_data</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<p>Once the data is created, we can check that it has been loaded correctly by displaying the first few rows of each DataFrame. To do this, we will use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.show.html"><code>.show()</code></a> method to display the first <code>5</code> rows of each DataFrame. The <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.show.html"><code>.show()</code></a> method is used to display the data in a tabular format, similar to how it would be displayed in a SQL database.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Sales DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales DataFrame: </span><span class="si">{</span><span class="n">df_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-------------------+-----------+----------+-----------+------------+--------+
|               date|customer_id|product_id|   category|sales_amount|quantity|
+-------------------+-----------+----------+-----------+------------+--------+
|2023-01-01 00:00:00|         52|        45|       Food|      490.76|       7|
|2023-01-02 00:00:00|         93|        41|Electronics|      453.94|       5|
|2023-01-03 00:00:00|         15|        29|       Home|      994.51|       5|
|2023-01-04 00:00:00|         72|        15|Electronics|      184.17|       7|
|2023-01-05 00:00:00|         61|        45|       Food|       27.89|       9|
+-------------------+-----------+----------+-----------+------------+--------+
only showing top 10 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Product DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product DataFrame: </span><span class="si">{</span><span class="n">df_product_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df_product_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_product_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Product DataFrame: 50
</code></pre></div>
<div class="highlight"><pre><span></span><code>+----------+------------+------+--------+-----------+
|product_id|product_name| price|category|supplier_id|
+----------+------------+------+--------+-----------+
|         1|   Product 1|257.57|    Food|          8|
|         2|   Product 2|414.96|Clothing|          5|
|         3|   Product 3|166.82|Clothing|          8|
|         4|   Product 4|448.81|    Food|          4|
|         5|   Product 5|200.71|    Food|          8|
+----------+------------+------+--------+-----------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">supplier_id</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Product 1</td>
<td style="text-align: right;">257.57</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Product 2</td>
<td style="text-align: right;">414.96</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Product 3</td>
<td style="text-align: right;">166.82</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Product 4</td>
<td style="text-align: right;">448.81</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 5</td>
<td style="text-align: right;">200.71</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Customer DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer DataFrame: </span><span class="si">{</span><span class="n">df_customer_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df_customer_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_customer_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Customer DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-----------+-------------+-----------+-----+-----------+
|customer_id|customer_name|       city|state|    segment|
+-----------+-------------+-----------+-----+-----------+
|          1|   Customer 1|    Phoenix|   NY|  Corporate|
|          2|   Customer 2|    Phoenix|   CA|Home Office|
|          3|   Customer 3|    Phoenix|   NY|Home Office|
|          4|   Customer 4|Los Angeles|   NY|   Consumer|
|          5|   Customer 5|Los Angeles|   IL|Home Office|
+-----------+-------------+-----------+-----+-----------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: left;">customer_name</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">segment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Customer 1</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Corporate</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Customer 2</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">Home Office</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Customer 3</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Home Office</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Customer 4</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Consumer</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Customer 5</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">IL</td>
<td style="text-align: left;">Home Office</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>To create the dataframes in Polars, we will use the data we generated earlier. We will parse the dictionaries into Polars DataFrames, which will allow us to perform various data manipulation tasks.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Create DataFrames</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sales_data</span><span class="p">)</span>
<span class="n">df_product_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">product_data</span><span class="p">)</span>
<span class="n">df_customer_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">customer_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Once the data is created, we can check that it has been loaded correctly by displaying the first few rows of each DataFrame. To do this, we will use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.head.html"><code>.head()</code></a> method to display the first <code>5</code> rows of each DataFrame, and then parse to the <a href="https://docs.python.org/3/library/functions.html#print"><code>print()</code></a> function to display the DataFrame in a readable format.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Sales DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales DataFrame: </span><span class="si">{</span><span class="n">df_sales_pl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 6)
┌─────────────────────┬─────────────┬────────────┬─────────────┬──────────────┬──────────┐
│ date                ┆ customer_id ┆ product_id ┆ category    ┆ sales_amount ┆ quantity │
│ ---                 ┆ ---         ┆ ---        ┆ ---         ┆ ---          ┆ ---      │
│ datetime[ns]        ┆ i64         ┆ i64        ┆ str         ┆ f64          ┆ i64      │
╞═════════════════════╪═════════════╪════════════╪═════════════╪══════════════╪══════════╡
│ 2023-01-01 00:00:00 ┆ 52          ┆ 45         ┆ Food        ┆ 490.76       ┆ 7        │
│ 2023-01-02 00:00:00 ┆ 93          ┆ 41         ┆ Electronics ┆ 453.94       ┆ 5        │
│ 2023-01-03 00:00:00 ┆ 15          ┆ 29         ┆ Home        ┆ 994.51       ┆ 5        │
│ 2023-01-04 00:00:00 ┆ 72          ┆ 15         ┆ Electronics ┆ 184.17       ┆ 7        │
│ 2023-01-05 00:00:00 ┆ 61          ┆ 45         ┆ Food        ┆ 27.89        ┆ 9        │
└─────────────────────┴─────────────┴────────────┴─────────────┴──────────────┴──────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Product DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product DataFrame: </span><span class="si">{</span><span class="n">df_product_pl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_product_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_product_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Product DataFrame: 50
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 5)
┌────────────┬──────────────┬────────┬──────────┬─────────────┐
│ product_id ┆ product_name ┆ price  ┆ category ┆ supplier_id │
│ ---        ┆ ---          ┆ ---    ┆ ---      ┆ ---         │
│ i64        ┆ str          ┆ f64    ┆ str      ┆ i64         │
╞════════════╪══════════════╪════════╪══════════╪═════════════╡
│ 1          ┆ Product 1    ┆ 257.57 ┆ Food     ┆ 8           │
│ 2          ┆ Product 2    ┆ 414.96 ┆ Clothing ┆ 5           │
│ 3          ┆ Product 3    ┆ 166.82 ┆ Clothing ┆ 8           │
│ 4          ┆ Product 4    ┆ 448.81 ┆ Food     ┆ 4           │
│ 5          ┆ Product 5    ┆ 200.71 ┆ Food     ┆ 8           │
└────────────┴──────────────┴────────┴──────────┴─────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">supplier_id</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Product 1</td>
<td style="text-align: right;">257.57</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Product 2</td>
<td style="text-align: right;">414.96</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Product 3</td>
<td style="text-align: right;">166.82</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Product 4</td>
<td style="text-align: right;">448.81</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 5</td>
<td style="text-align: right;">200.71</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Check Customer DataFrame</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer DataFrame: </span><span class="si">{</span><span class="n">df_customer_pl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_customer_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_customer_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Customer DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 5)
┌─────────────┬───────────────┬─────────────┬───────┬─────────────┐
│ customer_id ┆ customer_name ┆ city        ┆ state ┆ segment     │
│ ---         ┆ ---           ┆ ---         ┆ ---   ┆ ---         │
│ i64         ┆ str           ┆ str         ┆ str   ┆ str         │
╞═════════════╪═══════════════╪═════════════╪═══════╪═════════════╡
│ 1           ┆ Customer 1    ┆ Phoenix     ┆ NY    ┆ Corporate   │
│ 2           ┆ Customer 2    ┆ Phoenix     ┆ CA    ┆ Home Office │
│ 3           ┆ Customer 3    ┆ Phoenix     ┆ NY    ┆ Home Office │
│ 4           ┆ Customer 4    ┆ Los Angeles ┆ NY    ┆ Consumer    │
│ 5           ┆ Customer 5    ┆ Los Angeles ┆ IL    ┆ Home Office │
└─────────────┴───────────────┴─────────────┴───────┴─────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: left;">customer_name</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">segment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Customer 1</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Corporate</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Customer 2</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">Home Office</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Customer 3</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Home Office</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Customer 4</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">Consumer</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Customer 5</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">IL</td>
<td style="text-align: left;">Home Office</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<h2 id="1-filtering-and-selecting">1. Filtering and Selecting<a class="headerlink" href="#1-filtering-and-selecting" title="Permanent link">🔗</a></h2>
<p>This first section will demonstrate how to filter and select data from the DataFrames. This is a common operation in data analysis, allowing us to focus on specific subsets of the data.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:4"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><input id="__tabbed_4_4" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Pandas</label><label for="__tabbed_4_2">SQL</label><label for="__tabbed_4_3">PySpark</label><label for="__tabbed_4_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can use boolean indexing to filter rows based on specific conditions. As you can see in this first example, this looks like using square brackets, within which we define a column and a condition. In the below example, we can use string values to filter categorical data.</p>
<p>For more information about filtering in Pandas, see the <a href="https://pandas.pydata.org/docs/getting_started/intro_tutorials/03_subset_data.html">Pandas documentation on filtering</a>.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Filter sales data for specific category</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">electronics_sales_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pd</span><span class="p">[</span><span class="n">df_sales_pd</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Electronics&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Electronics Sales: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">electronics_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">electronics_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">electronics_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Number of Electronics Sales: 28
</code></pre></div>
<div class="highlight"><pre><span></span><code>         date  customer_id  product_id     category  sales_amount  quantity
1  2023-01-02           93          41  Electronics        453.94         5
3  2023-01-04           72          15  Electronics        184.17         7
8  2023-01-09           75           9  Electronics        746.73         2
10 2023-01-11           88           1  Electronics        314.98         9
11 2023-01-12           24          44  Electronics        547.11         8
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: left;">2023-01-09 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">746.73</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">10</td>
<td style="text-align: left;">2023-01-11 00:00:00</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">314.98</td>
<td style="text-align: right;">9</td>
</tr>
<tr>
<td style="text-align: right;">11</td>
<td style="text-align: left;">2023-01-12 00:00:00</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">547.11</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the <code>WHERE</code> clause to filter rows based on specific conditions. The syntax should be very familiar to anyone who has worked with SQL before. We can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_sql.html"><code>pd.read_sql()</code></a> function to execute SQL queries and retrieve the data from the database. The result is a Pandas DataFrame that contains only the rows that match the specified condition. In the below example, we filter for sales in the "Electronics" category.</p>
<p>For more information about filtering in SQL, see the <a href="https://sqlite.org/lang_select.html#whereclause">SQL WHERE clause documentation</a>.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Filter sales for a specific category</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">electronics_sales_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT *</span>
<span class="s2">    FROM sales</span>
<span class="s2">    WHERE category = &#39;Electronics&#39;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">electronics_sales_sql</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">electronics_sales_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Electronics Sales: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">electronics_sales_sql</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">electronics_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">electronics_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Number of Electronics Sales: 28
</code></pre></div>
<div class="highlight"><pre><span></span><code>                  date  customer_id  product_id     category  sales_amount  quantity
0  2023-01-02 00:00:00           93          41  Electronics        453.94         5
1  2023-01-04 00:00:00           72          15  Electronics        184.17         7
2  2023-01-09 00:00:00           75           9  Electronics        746.73         2
3  2023-01-11 00:00:00           88           1  Electronics        314.98         9
4  2023-01-12 00:00:00           24          44  Electronics        547.11         8
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-09 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">746.73</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-11 00:00:00</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">314.98</td>
<td style="text-align: right;">9</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-12 00:00:00</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">547.11</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.filter.html"><code>.filter()</code></a> (or the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.where.html"><code>.where()</code></a>) method to filter rows based on specific conditions. This process is effectively doing a boolean indexing operation to filter the DataFrame. The syntax is similar to SQL, where we can specify the condition as a string or using column expressions. In the below example, we filter for sales in the "Electronics" category.</p>
<p>For more information about filtering in PySpark, see the <a href="https://sparkbyexamples.com/pyspark/pyspark-where-filter/">PySpark documentation on filtering</a>.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Filter sales for a specific category</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">electronics_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">df_sales_ps</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Electronics&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Electronics Sales: </span><span class="si">{</span><span class="n">electronics_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">electronics_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">electronics_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Number of Electronics Sales: 28
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-------------------+-----------+----------+-----------+------------+--------+
|               date|customer_id|product_id|   category|sales_amount|quantity|
+-------------------+-----------+----------+-----------+------------+--------+
|2023-01-02 00:00:00|         93|        41|Electronics|      453.94|       5|
|2023-01-04 00:00:00|         72|        15|Electronics|      184.17|       7|
|2023-01-09 00:00:00|         75|         9|Electronics|      746.73|       2|
|2023-01-11 00:00:00|         88|         1|Electronics|      314.98|       9|
|2023-01-12 00:00:00|         24|        44|Electronics|      547.11|       8|
+-------------------+-----------+----------+-----------+------------+--------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-09 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">746.73</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-11 00:00:00</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">314.98</td>
<td style="text-align: right;">9</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-12 00:00:00</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">547.11</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.filter.html"><code>.filter()</code></a> method to filter rows based on specific conditions. The syntax is similar to Pandas, where we can specify the condition using column expressions. In the below example, we filter for sales in the "Electronics" category.</p>
<p>For more information about filtering in Polars, see the <a href="https://docs.pola.rs/user-guide/transformations/time-series/filter/">Polars documentation on filtering</a>.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Filter sales for a specific category</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">electronics_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">df_sales_pl</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Electronics&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Electronics Sales: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">electronics_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">electronics_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">electronics_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Number of Electronics Sales: 28
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 6)
┌─────────────────────┬─────────────┬────────────┬─────────────┬──────────────┬──────────┐
│ date                ┆ customer_id ┆ product_id ┆ category    ┆ sales_amount ┆ quantity │
│ ---                 ┆ ---         ┆ ---        ┆ ---         ┆ ---          ┆ ---      │
│ datetime[ns]        ┆ i64         ┆ i64        ┆ str         ┆ f64          ┆ i64      │
╞═════════════════════╪═════════════╪════════════╪═════════════╪══════════════╪══════════╡
│ 2023-01-02 00:00:00 ┆ 93          ┆ 41         ┆ Electronics ┆ 453.94       ┆ 5        │
│ 2023-01-04 00:00:00 ┆ 72          ┆ 15         ┆ Electronics ┆ 184.17       ┆ 7        │
│ 2023-01-09 00:00:00 ┆ 75          ┆ 9          ┆ Electronics ┆ 746.73       ┆ 2        │
│ 2023-01-11 00:00:00 ┆ 88          ┆ 1          ┆ Electronics ┆ 314.98       ┆ 9        │
│ 2023-01-12 00:00:00 ┆ 24          ┆ 44         ┆ Electronics ┆ 547.11       ┆ 8        │
└─────────────────────┴─────────────┴────────────┴─────────────┴──────────────┴──────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-09 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">746.73</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-11 00:00:00</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">314.98</td>
<td style="text-align: right;">9</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-12 00:00:00</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">547.11</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>We can also use numerical filtering, as you can see in the next example, where we filter for sales amounts greater than $500.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:4"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><input id="__tabbed_5_4" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Pandas</label><label for="__tabbed_5_2">SQL</label><label for="__tabbed_5_3">PySpark</label><label for="__tabbed_5_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>When it comes to numerical filtering in Pandas, the process is similar to the previous example, where we use boolean indexing to filter rows based on a given condition condition, but here we use a numerical value instead of a string value. In the below example, we filter for sales amounts greater than <code>500</code>.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Filter for high value transactions</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">high_value_sales_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pd</span><span class="p">[</span><span class="n">df_sales_pd</span><span class="p">[</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of high-value Sales: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">high_value_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_value_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_value_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Number of high-value Sales: 43
</code></pre></div>
<div class="highlight"><pre><span></span><code>         date  customer_id  product_id     category  sales_amount  quantity
2  2023-01-03           15          29         Home        994.51         5
8  2023-01-09           75           9  Electronics        746.73         2
9  2023-01-10           75          24        Books        723.73         6
11 2023-01-12           24          44  Electronics        547.11         8
12 2023-01-13            3           8     Clothing        513.73         5
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: left;">2023-01-09 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">746.73</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">9</td>
<td style="text-align: left;">2023-01-10 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">723.73</td>
<td style="text-align: right;">6</td>
</tr>
<tr>
<td style="text-align: right;">11</td>
<td style="text-align: left;">2023-01-12 00:00:00</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">547.11</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">12</td>
<td style="text-align: left;">2023-01-13 00:00:00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">513.73</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>When it comes to numerical filtering in SQL, the process is similar to the previous example, where we use the <code>WHERE</code> clause to filter rows based on a given condition, but here we use a numerical value instead of a string value. In the below example, we filter for sales amounts greater than <code>500</code>.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Filter for high value transactions</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">high_value_sales_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT *</span>
<span class="s2">    FROM sales</span>
<span class="s2">    WHERE sales_amount &gt; 500</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">high_value_sales_sql</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">high_value_sales_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of high-value Sales: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">high_value_sales_sql</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">high_value_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">high_value_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Number of high-value Sales: 43
</code></pre></div>
<div class="highlight"><pre><span></span><code>                  date  customer_id  product_id     category  sales_amount  quantity
0  2023-01-03 00:00:00           15          29         Home        994.51         5
1  2023-01-09 00:00:00           75           9  Electronics        746.73         2
2  2023-01-10 00:00:00           75          24        Books        723.73         6
3  2023-01-12 00:00:00           24          44  Electronics        547.11         8
4  2023-01-13 00:00:00            3           8     Clothing        513.73         5
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-09 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">746.73</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-10 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">723.73</td>
<td style="text-align: right;">6</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-12 00:00:00</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">547.11</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-13 00:00:00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">513.73</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>When it comes to numerical filtering in PySpark, the process is similar to the previous example, where we use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.filter.html"><code>.filter()</code></a> (or <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.where.html"><code>.where()</code></a>) method to filter rows based on a given condition, but here we use a numerical value instead of a string value. In the below example, we filter for sales amounts greater than <code>500</code>.</p>
<p>Also note here that we have parsed a string value to the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.filter.html"><code>.filter()</code></a> method, instead of using the pure-Python syntax as shown above. This is because the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.filter.html"><code>.filter()</code></a> method can accept a SQL-like string expression. This is a common practice in PySpark to parse a SQL-like string to a PySpark method.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Filter for high value transactions</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">high_value_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;sales_amount &gt; 500&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of high-value Sales: </span><span class="si">{</span><span class="n">high_value_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">high_value_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_value_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Number of high-value Sales: 43
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-------------------+-----------+----------+-----------+------------+--------+
|               date|customer_id|product_id|   category|sales_amount|quantity|
+-------------------+-----------+----------+-----------+------------+--------+
|2023-01-03 00:00:00|         15|        29|       Home|      994.51|       5|
|2023-01-09 00:00:00|         75|         9|Electronics|      746.73|       2|
|2023-01-10 00:00:00|         75|        24|      Books|      723.73|       6|
|2023-01-12 00:00:00|         24|        44|Electronics|      547.11|       8|
|2023-01-13 00:00:00|          3|         8|   Clothing|      513.73|       5|
+-------------------+-----------+----------+-----------+------------+--------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-09 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">746.73</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-10 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">723.73</td>
<td style="text-align: right;">6</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-12 00:00:00</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">547.11</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-13 00:00:00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">513.73</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>When it comes to numerical filtering in Polars, the process is similar to the previous example, where we use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.filter.html"><code>.filter()</code></a> method to filter rows based on a given condition, but here we use a numerical value instead of a string value. In the below example, we filter for sales amounts greater than <code>500</code>.</p>
<p>Also note here that we have used the <a href="https://docs.pola.rs/api/python/stable/reference/expressions/col.html"><code>pl.col()</code></a> function to specify the column we want to filter on. This is different from the previous examples, where we used the column name directly. The use of <a href="https://docs.pola.rs/api/python/stable/reference/expressions/col.html"><code>pl.col()</code></a> is a common practice in Polars to specify the column name in a more readable way.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Filter for high value transactions</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">high_value_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of high-value Sales: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">high_value_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_value_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_value_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Number of high-value Sales: 43
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 6)
┌─────────────────────┬─────────────┬────────────┬─────────────┬──────────────┬──────────┐
│ date                ┆ customer_id ┆ product_id ┆ category    ┆ sales_amount ┆ quantity │
│ ---                 ┆ ---         ┆ ---        ┆ ---         ┆ ---          ┆ ---      │
│ datetime[ns]        ┆ i64         ┆ i64        ┆ str         ┆ f64          ┆ i64      │
╞═════════════════════╪═════════════╪════════════╪═════════════╪══════════════╪══════════╡
│ 2023-01-03 00:00:00 ┆ 15          ┆ 29         ┆ Home        ┆ 994.51       ┆ 5        │
│ 2023-01-09 00:00:00 ┆ 75          ┆ 9          ┆ Electronics ┆ 746.73       ┆ 2        │
│ 2023-01-10 00:00:00 ┆ 75          ┆ 24         ┆ Books       ┆ 723.73       ┆ 6        │
│ 2023-01-12 00:00:00 ┆ 24          ┆ 44         ┆ Electronics ┆ 547.11       ┆ 8        │
│ 2023-01-13 00:00:00 ┆ 3           ┆ 8          ┆ Clothing    ┆ 513.73       ┆ 5        │
└─────────────────────┴─────────────┴────────────┴─────────────┴──────────────┴──────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-09 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">746.73</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-10 00:00:00</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">723.73</td>
<td style="text-align: right;">6</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-12 00:00:00</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">547.11</td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-13 00:00:00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">513.73</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>In addition to subsetting a table by rows (aka <em>filtering</em>), we can also subset a table by columns (aka <em>selecting</em>). This allows us to create a new DataFrame with only the relevant columns we want to work with. This is useful when we want to focus on specific attributes of the data, such as dates, categories, or sales amounts.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:4"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><input id="__tabbed_6_3" name="__tabbed_6" type="radio" /><input id="__tabbed_6_4" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Pandas</label><label for="__tabbed_6_2">SQL</label><label for="__tabbed_6_3">PySpark</label><label for="__tabbed_6_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>To select specific columns in Pandas, we can use the double square brackets syntax to specify the columns we want to keep in the DataFrame. This allows us to create a new DataFrame with only the relevant columns.</p>
<p>For more information about selecting specific columns, see the <a href="https://pandas.pydata.org/docs/getting_started/intro_tutorials/03_subset_data.html">Pandas documentation on selecting columns</a>.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Select specific columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_summary_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pd</span><span class="p">[[</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;sales_amount&quot;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales Summary DataFrame: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sales_summary_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_summary_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_summary_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales Summary DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>        date     category  sales_amount
0 2023-01-01         Food        490.76
1 2023-01-02  Electronics        453.94
2 2023-01-03         Home        994.51
3 2023-01-04  Electronics        184.17
4 2023-01-05         Food         27.89
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>To select specific columns in SQL, we can use the <code>SELECT</code> statement to specify the columns we want to retrieve from the table. This allows us to create a new DataFrame with only the relevant columns. We can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_sql.html"><code>pd.read_sql()</code></a> function to execute SQL queries and retrieve the data from the database.</p>
<p>For more information about selecting specific columns in SQL, see the <a href="https://sqlite.org/lang_select.html">SQL SELECT statement documentation</a>.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Select specific columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_summary_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT date, category, sales_amount</span>
<span class="s2">    FROM sales</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">sales_summary_sql</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_summary_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected columns in Sales: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sales_summary_sql</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_summary_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_summary_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Selected columns in Sales: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>                  date     category  sales_amount
0  2023-01-01 00:00:00         Food        490.76
1  2023-01-02 00:00:00  Electronics        453.94
2  2023-01-03 00:00:00         Home        994.51
3  2023-01-04 00:00:00  Electronics        184.17
4  2023-01-05 00:00:00         Food         27.89
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>To select specific columns in PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.select.html"><code>.select()</code></a> method to specify the columns we want to keep in the DataFrame. This allows us to create a new DataFrame with only the relevant columns. The syntax is similar to SQL, where we can specify the column names as strings.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Select specific columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_summary_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales Summary DataFrame: </span><span class="si">{</span><span class="n">sales_summary_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sales_summary_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_summary_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales Summary DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-------------------+-----------+------------+
|               date|   category|sales_amount|
+-------------------+-----------+------------+
|2023-01-01 00:00:00|       Food|      490.76|
|2023-01-02 00:00:00|Electronics|      453.94|
|2023-01-03 00:00:00|       Home|      994.51|
|2023-01-04 00:00:00|Electronics|      184.17|
|2023-01-05 00:00:00|       Food|       27.89|
+-------------------+-----------+------------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>To select specific columns in Polars, we can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.select.html"><code>.select()</code></a> method to specify the columns we want to keep in the DataFrame. This allows us to create a new DataFrame with only the relevant columns.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Select specific columns</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_summary_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;sales_amount&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales Summary DataFrame: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sales_summary_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_summary_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_summary_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales Summary DataFrame: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 3)
┌─────────────────────┬─────────────┬──────────────┐
│ date                ┆ category    ┆ sales_amount │
│ ---                 ┆ ---         ┆ ---          │
│ datetime[ns]        ┆ str         ┆ f64          │
╞═════════════════════╪═════════════╪══════════════╡
│ 2023-01-01 00:00:00 ┆ Food        ┆ 490.76       │
│ 2023-01-02 00:00:00 ┆ Electronics ┆ 453.94       │
│ 2023-01-03 00:00:00 ┆ Home        ┆ 994.51       │
│ 2023-01-04 00:00:00 ┆ Electronics ┆ 184.17       │
│ 2023-01-05 00:00:00 ┆ Food        ┆ 27.89        │
└─────────────────────┴─────────────┴──────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<h2 id="2-grouping-and-aggregation">2. Grouping and Aggregation<a class="headerlink" href="#2-grouping-and-aggregation" title="Permanent link">🔗</a></h2>
<p>The second section will cover grouping and aggregation techniques. These operations are essential for summarizing data and extracting insights from large datasets.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:4"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><input id="__tabbed_7_3" name="__tabbed_7" type="radio" /><input id="__tabbed_7_4" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Pandas</label><label for="__tabbed_7_2">SQL</label><label for="__tabbed_7_3">PySpark</label><label for="__tabbed_7_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.agg.html"><code>.agg()</code></a> method to perform aggregation operations on DataFrames. This method allows us to apply multiple aggregation functions to different columns in a single operation.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Basic aggregation</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_stats_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pd</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;sales_amount&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">],</span>
        <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales Statistics: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sales_stats_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_stats_pd</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_stats_pd</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales Statistics: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>       sales_amount  quantity
sum      48227.0500    464.00
mean       482.2705      4.64
min         15.1300      1.00
max        994.6100      9.00
count      100.0000       NaN
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">sum</td>
<td style="text-align: right;">48227.1</td>
<td style="text-align: right;">464</td>
</tr>
<tr>
<td style="text-align: left;">mean</td>
<td style="text-align: right;">482.271</td>
<td style="text-align: right;">4.64</td>
</tr>
<tr>
<td style="text-align: left;">min</td>
<td style="text-align: right;">15.13</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: left;">max</td>
<td style="text-align: right;">994.61</td>
<td style="text-align: right;">9</td>
</tr>
<tr>
<td style="text-align: left;">count</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">nan</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the aggregate functions like <code>SUM()</code>, <code>AVG()</code>, <code>MIN()</code>, <code>MAX()</code>, and <code>COUNT()</code> to perform aggregation operations on tables.</p>
<p>Note here that we are <em>not</em> using the <code>GROUP BY</code> clause, which is typically used to group rows that have the same values in specified columns into summary rows. Instead, we are performing a basic aggregation on the entire table.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Basic aggregation</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_stats_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        SUM(sales_amount) AS sales_sum,</span>
<span class="s2">        AVG(sales_amount) AS sales_mean,</span>
<span class="s2">        MIN(sales_amount) AS sales_min,</span>
<span class="s2">        MAX(sales_amount) AS sales_max,</span>
<span class="s2">        COUNT(*) AS sales_count,</span>
<span class="s2">        SUM(quantity) AS quantity_sum,</span>
<span class="s2">        AVG(quantity) AS quantity_mean,</span>
<span class="s2">        MIN(quantity) AS quantity_min,</span>
<span class="s2">        MAX(quantity) AS quantity_max</span>
<span class="s2">    FROM sales</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales Statistics: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_stats_txt</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_stats_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_stats_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales Statistics: 1
</code></pre></div>
<div class="highlight"><pre><span></span><code>   sales_sum  sales_mean  sales_min  sales_max  sales_count  quantity_sum  quantity_mean  quantity_min  quantity_max
0   48227.05    482.2705      15.13     994.61          100           464           4.64             1             9
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">sales_sum</th>
<th style="text-align: right;">sales_mean</th>
<th style="text-align: right;">sales_min</th>
<th style="text-align: right;">sales_max</th>
<th style="text-align: right;">sales_count</th>
<th style="text-align: right;">quantity_sum</th>
<th style="text-align: right;">quantity_mean</th>
<th style="text-align: right;">quantity_min</th>
<th style="text-align: right;">quantity_max</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48227.1</td>
<td style="text-align: right;">482.271</td>
<td style="text-align: right;">15.13</td>
<td style="text-align: right;">994.61</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">464</td>
<td style="text-align: right;">4.64</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.agg.html"><code>.agg()</code></a> method to perform aggregation operations on DataFrames. This method allows us to apply multiple aggregation functions to different columns in a single operation.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Basic aggregation</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_stats_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_sum&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_mean&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;MIN(sales_amount) AS sales_min&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;MAX(sales_amount) AS sales_max&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_count&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;SUM(quantity) AS quantity_sum&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;AVG(quantity) AS quantity_mean&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;quantity_min&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;quantity_max&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales Statistics: </span><span class="si">{</span><span class="n">sales_stats_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sales_stats_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_stats_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales Statistics: 1
</code></pre></div>
<div class="highlight"><pre><span></span><code>+---------+----------+---------+---------+-----------+------------+-------------+------------+------------+
|sales_sum|sales_mean|sales_min|sales_max|sales_count|quantity_sum|quantity_mean|quantity_min|quantity_max|
+---------+----------+---------+---------+-----------+------------+-------------+------------+------------+
| 48227.05|  482.2705|    15.13|   994.61|        100|         464|         4.64|           1|           9|
+---------+----------+---------+---------+-----------+------------+-------------+------------+------------+
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">sales_sum</th>
<th style="text-align: right;">sales_mean</th>
<th style="text-align: right;">sales_min</th>
<th style="text-align: right;">sales_max</th>
<th style="text-align: right;">sales_count</th>
<th style="text-align: right;">quantity_sum</th>
<th style="text-align: right;">quantity_mean</th>
<th style="text-align: right;">quantity_min</th>
<th style="text-align: right;">quantity_max</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48227.1</td>
<td style="text-align: right;">482.271</td>
<td style="text-align: right;">15.13</td>
<td style="text-align: right;">994.61</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">464</td>
<td style="text-align: right;">4.64</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.select.html"><code>.select()</code></a> method to perform aggregation operations on DataFrames. This method allows us to apply multiple aggregation functions to different columns in a single operation.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Basic aggregation</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_stats_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_sum&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_mean&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_min&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;sales_max&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;quantity_sum&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;quantity_mean&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;quantity_min&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;quantity_max&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales Statistics: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sales_stats_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_stats_pl</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_stats_pl</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales Statistics: 1
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (1, 8)
┌───────────┬────────────┬───────────┬───────────┬──────────────┬───────────────┬──────────────┬──────────────┐
│ sales_sum ┆ sales_mean ┆ sales_min ┆ sales_max ┆ quantity_sum ┆ quantity_mean ┆ quantity_min ┆ quantity_max │
│ ---       ┆ ---        ┆ ---       ┆ ---       ┆ ---          ┆ ---           ┆ ---          ┆ ---          │
│ f64       ┆ f64        ┆ f64       ┆ f64       ┆ i64          ┆ f64           ┆ i64          ┆ i64          │
╞═══════════╪════════════╪═══════════╪═══════════╪══════════════╪═══════════════╪══════════════╪══════════════╡
│ 48227.05  ┆ 482.2705   ┆ 15.13     ┆ 994.61    ┆ 464          ┆ 4.64          ┆ 1            ┆ 9            │
└───────────┴────────────┴───────────┴───────────┴──────────────┴───────────────┴──────────────┴──────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">sales_sum</th>
<th style="text-align: right;">sales_mean</th>
<th style="text-align: right;">sales_min</th>
<th style="text-align: right;">sales_max</th>
<th style="text-align: right;">quantity_sum</th>
<th style="text-align: right;">quantity_mean</th>
<th style="text-align: right;">quantity_min</th>
<th style="text-align: right;">quantity_max</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48227</td>
<td style="text-align: right;">482.27</td>
<td style="text-align: right;">15.13</td>
<td style="text-align: right;">994.61</td>
<td style="text-align: right;">464</td>
<td style="text-align: right;">4.64</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>It is also possible to group the data by a specific column and then apply aggregation functions to summarize the data by group.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:4"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><input id="__tabbed_8_3" name="__tabbed_8" type="radio" /><input id="__tabbed_8_4" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Pandas</label><label for="__tabbed_8_2">SQL</label><label for="__tabbed_8_3">PySpark</label><label for="__tabbed_8_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>This is done using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html"><code>.groupby()</code></a> method to group data by one or more columns and then apply aggregation functions to summarize the data, followed by the <a href="https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.DataFrameGroupBy.agg.html"><code>.agg()</code></a> method.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Group by category and aggregate</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">category_sales_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;sales_amount&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">],</span>
        <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Category Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">category_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_pd</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_pd</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Category Sales Summary: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>            sales_amount                   quantity
                     sum        mean count      sum
category
Books           10154.83  441.514348    23      100
Clothing         7325.31  457.831875    16       62
Electronics     11407.45  407.408929    28      147
Food            12995.57  541.482083    24      115
Home             6343.89  704.876667     9       40
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;">category</th>
<th style="text-align: right;">('sales_amount', 'sum')</th>
<th style="text-align: right;">('sales_amount', 'mean')</th>
<th style="text-align: right;">('sales_amount', 'count')</th>
<th style="text-align: right;">('quantity', 'sum')</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">10154.8</td>
<td style="text-align: right;">441.514</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">100</td>
</tr>
<tr>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7325.31</td>
<td style="text-align: right;">457.832</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">62</td>
</tr>
<tr>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">11407.5</td>
<td style="text-align: right;">407.409</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">147</td>
</tr>
<tr>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">12995.6</td>
<td style="text-align: right;">541.482</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">6343.89</td>
<td style="text-align: right;">704.877</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">40</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the <code>GROUP BY</code> clause to group rows that have the same values in specified columns into summary rows. We can then apply aggregate functions like <code>SUM()</code>, <code>AVG()</code>, and <code>COUNT()</code> in the <code>SELECT</code> clause to summarize the data by group.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Group by category and aggregate</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">category_sales_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        category,</span>
<span class="s2">        SUM(sales_amount) AS total_sales,</span>
<span class="s2">        AVG(sales_amount) AS average_sales,</span>
<span class="s2">        COUNT(*) AS transaction_count,</span>
<span class="s2">        SUM(quantity) AS total_quantity</span>
<span class="s2">    FROM sales</span>
<span class="s2">    GROUP BY category</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Category Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">category_sales_txt</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">category_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">category_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Category Sales Summary: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>      category  total_sales  average_sales  transaction_count  total_quantity
0        Books     10154.83     441.514348                 23             100
1     Clothing      7325.31     457.831875                 16              62
2  Electronics     11407.45     407.408929                 28             147
3         Food     12995.57     541.482083                 24             115
4         Home      6343.89     704.876667                  9              40
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">average_sales</th>
<th style="text-align: right;">transaction_count</th>
<th style="text-align: right;">total_quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">10154.8</td>
<td style="text-align: right;">441.514</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">100</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7325.31</td>
<td style="text-align: right;">457.832</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">62</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">11407.5</td>
<td style="text-align: right;">407.409</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">147</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">12995.6</td>
<td style="text-align: right;">541.482</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">6343.89</td>
<td style="text-align: right;">704.877</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">40</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.groupBy.html"><code>.groupBy()</code></a> method to group data by one or more columns and then apply aggregation functions using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.GroupedData.agg.html"><code>.agg()</code></a> method.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Group by category and aggregate</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">category_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;average_sales&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;transaction_count&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_quantity&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Category Sales Summary: </span><span class="si">{</span><span class="n">category_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">category_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Category Sales Summary: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-----------+------------------+------------------+-----------------+--------------+
|   category|       total_sales|     average_sales|transaction_count|total_quantity|
+-----------+------------------+------------------+-----------------+--------------+
|       Home| 6343.889999999999| 704.8766666666666|                9|            40|
|       Food|          12995.57| 541.4820833333333|               24|           115|
|Electronics|11407.449999999999|407.40892857142853|               28|           147|
|   Clothing|7325.3099999999995|457.83187499999997|               16|            62|
|      Books|          10154.83|  441.514347826087|               23|           100|
+-----------+------------------+------------------+-----------------+--------------+
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">average_sales</th>
<th style="text-align: right;">transaction_count</th>
<th style="text-align: right;">total_quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">6343.89</td>
<td style="text-align: right;">704.877</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">40</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">12995.6</td>
<td style="text-align: right;">541.482</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">11407.4</td>
<td style="text-align: right;">407.409</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">147</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7325.31</td>
<td style="text-align: right;">457.832</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">62</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">10154.8</td>
<td style="text-align: right;">441.514</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.group_by.html"><code>.group_by()</code></a> method to group data by one or more columns and then apply aggregation functions using the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.dataframe.group_by.GroupBy.agg.html"><code>.agg()</code></a> method.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Group by category and aggregate</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">category_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;average_sales&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;transaction_count&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_quantity&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Category Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">category_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Category Sales Summary: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 5)
┌─────────────┬─────────────┬───────────────┬───────────────────┬────────────────┐
│ category    ┆ total_sales ┆ average_sales ┆ transaction_count ┆ total_quantity │
│ ---         ┆ ---         ┆ ---           ┆ ---               ┆ ---            │
│ str         ┆ f64         ┆ f64           ┆ u32               ┆ i64            │
╞═════════════╪═════════════╪═══════════════╪═══════════════════╪════════════════╡
│ Food        ┆ 12995.57    ┆ 541.482083    ┆ 24                ┆ 115            │
│ Electronics ┆ 11407.45    ┆ 407.408929    ┆ 28                ┆ 147            │
│ Books       ┆ 10154.83    ┆ 441.514348    ┆ 23                ┆ 100            │
│ Home        ┆ 6343.89     ┆ 704.876667    ┆ 9                 ┆ 40             │
│ Clothing    ┆ 7325.31     ┆ 457.831875    ┆ 16                ┆ 62             │
└─────────────┴─────────────┴───────────────┴───────────────────┴────────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">average_sales</th>
<th style="text-align: right;">transaction_count</th>
<th style="text-align: right;">total_quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">12995.6</td>
<td style="text-align: right;">541.482</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">11407.5</td>
<td style="text-align: right;">407.409</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">147</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">10154.8</td>
<td style="text-align: right;">441.514</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">100</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">6343.89</td>
<td style="text-align: right;">704.877</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">40</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7325.31</td>
<td style="text-align: right;">457.832</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">62</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>We can rename the columns for clarity by simply assigning new names.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:4"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><input id="__tabbed_9_3" name="__tabbed_9" type="radio" /><input id="__tabbed_9_4" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Pandas</label><label for="__tabbed_9_2">SQL</label><label for="__tabbed_9_3">PySpark</label><label for="__tabbed_9_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.columns.html"><code>.columns</code></a> attribute of the DataFrame. This makes it easier to understand the results of the aggregation.</p>
<p>It's also possible to rename columns using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rename.html"><code>.rename()</code></a> method, which allows for more flexibility in renaming specific columns from within 'dot-method' chains.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rename columns for clarity</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">category_sales_renamed_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">category_sales_pd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">category_sales_renamed_pd</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Total Sales&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Average Sales&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Transaction Count&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Total Quantity&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Renamed Category Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">category_sales_renamed_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_renamed_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_renamed_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Renamed Category Sales Summary: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>             Total Sales  Average Sales  Transaction Count  Total Quantity
category
Books           10154.83     441.514348                 23             100
Clothing         7325.31     457.831875                 16              62
Electronics     11407.45     407.408929                 28             147
Food            12995.57     541.482083                 24             115
Home             6343.89     704.876667                  9              40
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;">category</th>
<th style="text-align: right;">Total Sales</th>
<th style="text-align: right;">Average Sales</th>
<th style="text-align: right;">Transaction Count</th>
<th style="text-align: right;">Total Quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">10154.8</td>
<td style="text-align: right;">441.514</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">100</td>
</tr>
<tr>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7325.31</td>
<td style="text-align: right;">457.832</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">62</td>
</tr>
<tr>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">11407.5</td>
<td style="text-align: right;">407.409</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">147</td>
</tr>
<tr>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">12995.6</td>
<td style="text-align: right;">541.482</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">6343.89</td>
<td style="text-align: right;">704.877</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">40</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the <code>AS</code> keyword to rename columns in the <code>SELECT</code> clause. This allows us to provide more descriptive names for the aggregated columns.</p>
<p>In this example, we provide the same aggregation as before, but from within a subquery. Then, in the parent query, we rename the columns for clarity.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rename columns for clarity</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">category_sales_renamed_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        category,</span>
<span class="s2">        total_sales AS `Total Sales`,</span>
<span class="s2">        average_sales AS `Average Sales`,</span>
<span class="s2">        transaction_count AS `Transaction Count`,</span>
<span class="s2">        total_quantity AS `Total Quantity`</span>
<span class="s2">    FROM (</span>
<span class="s2">        SELECT</span>
<span class="s2">            category,</span>
<span class="s2">            SUM(sales_amount) AS total_sales,</span>
<span class="s2">            AVG(sales_amount) AS average_sales,</span>
<span class="s2">            COUNT(*) AS transaction_count,</span>
<span class="s2">            SUM(quantity) AS total_quantity</span>
<span class="s2">        FROM sales</span>
<span class="s2">        GROUP BY category</span>
<span class="s2">    ) AS sales_summary</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Renamed Category Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">category_sales_renamed_txt</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">category_sales_renamed_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">category_sales_renamed_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Renamed Category Sales Summary: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>             Total Sales  Average Sales  Transaction Count  Total Quantity
category
Books           10154.83     441.514348                 23             100
Clothing         7325.31     457.831875                 16              62
Electronics     11407.45     407.408929                 28             147
Food            12995.57     541.482083                 24             115
Home             6343.89     704.876667                  9              40
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;">category</th>
<th style="text-align: right;">Total Sales</th>
<th style="text-align: right;">Average Sales</th>
<th style="text-align: right;">Transaction Count</th>
<th style="text-align: right;">Total Quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">10154.8</td>
<td style="text-align: right;">441.514</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">100</td>
</tr>
<tr>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7325.31</td>
<td style="text-align: right;">457.832</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">62</td>
</tr>
<tr>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">11407.5</td>
<td style="text-align: right;">407.409</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">147</td>
</tr>
<tr>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">12995.6</td>
<td style="text-align: right;">541.482</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">6343.89</td>
<td style="text-align: right;">704.877</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">40</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumnsRenamed.html"><code>.withColumnsRenamed()</code></a> method to rename columns in a DataFrame. This allows us to provide more descriptive names for the aggregated columns.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rename columns for clarity</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">category_sales_renamed_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">category_sales_ps</span><span class="o">.</span><span class="n">withColumnsRenamed</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;total_sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Sales&quot;</span><span class="p">,</span>
        <span class="s2">&quot;average_sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Average Sales&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transaction_count&quot;</span><span class="p">:</span> <span class="s2">&quot;Transaction Count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_quantity&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Quantity&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Renamed Category Sales Summary: </span><span class="si">{</span><span class="n">category_sales_renamed_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">category_sales_renamed_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_renamed_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Renamed Category Sales Summary: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-----------+------------------+------------------+-----------------+--------------+
|   category|       Total Sales|     Average Sales|Transaction Count|Total Quantity|
+-----------+------------------+------------------+-----------------+--------------+
|       Home| 6343.889999999999| 704.8766666666666|                9|            40|
|       Food|          12995.57| 541.4820833333333|               24|           115|
|Electronics|11407.449999999999|407.40892857142853|               28|           147|
|   Clothing|7325.3099999999995|457.83187499999997|               16|            62|
|      Books|          10154.83|  441.514347826087|               23|           100|
+-----------+------------------+------------------+-----------------+--------------+
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">Total Sales</th>
<th style="text-align: right;">Average Sales</th>
<th style="text-align: right;">Transaction Count</th>
<th style="text-align: right;">Total Quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">6343.89</td>
<td style="text-align: right;">704.877</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">40</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">12995.6</td>
<td style="text-align: right;">541.482</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">11407.4</td>
<td style="text-align: right;">407.409</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">147</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7325.31</td>
<td style="text-align: right;">457.832</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">62</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">10154.8</td>
<td style="text-align: right;">441.514</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.rename.html"><code>.rename()</code></a> method to rename columns in a DataFrame. This allows us to provide more descriptive names for the aggregated columns.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rename columns for clarity</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">category_sales_renamed_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">category_sales_pl</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;total_sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Sales&quot;</span><span class="p">,</span>
        <span class="s2">&quot;average_sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Average Sales&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transaction_count&quot;</span><span class="p">:</span> <span class="s2">&quot;Transaction Count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_quantity&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Quantity&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Renamed Category Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">category_sales_renamed_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_renamed_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_sales_renamed_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Renamed Category Sales Summary: 5
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 5)
┌─────────────┬─────────────┬───────────────┬───────────────────┬────────────────┐
│ category    ┆ Total Sales ┆ Average Sales ┆ Transaction Count ┆ Total Quantity │
│ ---         ┆ ---         ┆ ---           ┆ ---               ┆ ---            │
│ str         ┆ f64         ┆ f64           ┆ u32               ┆ i64            │
╞═════════════╪═════════════╪═══════════════╪═══════════════════╪════════════════╡
│ Food        ┆ 12995.57    ┆ 541.482083    ┆ 24                ┆ 115            │
│ Electronics ┆ 11407.45    ┆ 407.408929    ┆ 28                ┆ 147            │
│ Books       ┆ 10154.83    ┆ 441.514348    ┆ 23                ┆ 100            │
│ Home        ┆ 6343.89     ┆ 704.876667    ┆ 9                 ┆ 40             │
│ Clothing    ┆ 7325.31     ┆ 457.831875    ┆ 16                ┆ 62             │
└─────────────┴─────────────┴───────────────┴───────────────────┴────────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">Total Sales</th>
<th style="text-align: right;">Average Sales</th>
<th style="text-align: right;">Transaction Count</th>
<th style="text-align: right;">Total Quantity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">12995.6</td>
<td style="text-align: right;">541.482</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">11407.5</td>
<td style="text-align: right;">407.409</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">147</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">10154.8</td>
<td style="text-align: right;">441.514</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">100</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">6343.89</td>
<td style="text-align: right;">704.877</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">40</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7325.31</td>
<td style="text-align: right;">457.832</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">62</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Having aggregated the data, we can now visualize the results using <a href="https://plotly.com/python/">Plotly</a>. This allows us to create interactive visualizations that can help us better understand the data. The simplest way to do this is to use the <a href="https://plotly.com/python/plotly-express/">Plotly Express</a> module, which provides a high-level interface for creating visualizations. Here, we have utilised the <a href="https://plotly.com/python/bar-charts/"><code>px.bar()</code></a> function to create a bar chart of the total sales by category.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:4"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><input id="__tabbed_10_3" name="__tabbed_10" type="radio" /><input id="__tabbed_10_4" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Pandas</label><label for="__tabbed_10_2">SQL</label><label for="__tabbed_10_3">PySpark</label><label for="__tabbed_10_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The Plotly <a href="https://plotly.com/python/bar-charts/"><code>px.bar()</code></a> function is able to receive a Pandas DataFrame directly, making it easy to create visualizations from the aggregated data. However, what we first need to do is to convert the index labels in to a column, so that we can use it as the x-axis in the bar chart. We do this with the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.reset_index.html"><code>.reset_index()</code></a> method.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Plot the results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">data_frame</span><span class="o">=</span><span class="n">category_sales_renamed_pd</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total Sales by Category&quot;</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Transaction Count&quot;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Sales ($)&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Product Category&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;images/pt2_total_sales_by_category_pd.html&quot;</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<p><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="e49480ed-8db5-4b14-9e78-3789c37f9b31" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("e49480ed-8db5-4b14-9e78-3789c37f9b31")) {                    Plotly.newPlot(                        "e49480ed-8db5-4b14-9e78-3789c37f9b31",                        [{"hovertemplate":"Product Category=%{x}\u003cbr\u003eTotal Sales (<span class="arithmatex">\()=%{y}\u003cbr\u003eTransaction Count=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#1F77B4","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"text":{"dtype":"f8","bdata":"AAAAAAAAN0AAAAAAAAAwQAAAAAAAADxAAAAAAAAAOEAAAAAAAAAiQA=="},"textposition":"auto","x":["Books","Clothing","Electronics","Food","Home"],"xaxis":"x","y":{"dtype":"f8","bdata":"16NwPWrVw0DD9ShcT528QJqZmZm5R8ZAXI\u002fC9chhyUBwPQrX48e4QA=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Product Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Total Sales (\)</span>)"}},"legend":{"tracegroupgap":0},"title":{"text":"Total Sales by Category"},"barmode":"relative"},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html></p>
</div>
</div>
<div class="tabbed-block">
<p>The Plotly <a href="https://plotly.com/python/bar-charts/"><code>px.bar()</code></a> function can also receive a Pandas DataFrame, so we can use the results of the SQL query directly. Since the method we are using already returns the group labels in an individual column, we can use that directly in Plotly as the labels for the x-axis.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Plot the results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">data_frame</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">category_sales_renamed_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">),</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total Sales by Category&quot;</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Transaction Count&quot;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Sales ($)&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Product Category&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;images/pt2_total_sales_by_category_sql.html&quot;</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<p><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="734c3450-1f56-49fa-9f4a-f3f971e0cae6" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("734c3450-1f56-49fa-9f4a-f3f971e0cae6")) {                    Plotly.newPlot(                        "734c3450-1f56-49fa-9f4a-f3f971e0cae6",                        [{"hovertemplate":"Product Category=%{x}\u003cbr\u003eTotal Sales (<span class="arithmatex">\()=%{y}\u003cbr\u003eTransaction Count=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#1F77B4","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"text":{"dtype":"f8","bdata":"AAAAAAAAN0AAAAAAAAAwQAAAAAAAADxAAAAAAAAAOEAAAAAAAAAiQA=="},"textposition":"auto","x":["Books","Clothing","Electronics","Food","Home"],"xaxis":"x","y":{"dtype":"f8","bdata":"16NwPWrVw0DD9ShcT528QJqZmZm5R8ZAXI\u002fC9chhyUBwPQrX48e4QA=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Product Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Total Sales (\)</span>)"}},"legend":{"tracegroupgap":0},"title":{"text":"Total Sales by Category"},"barmode":"relative"},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html></p>
</div>
</div>
<div class="tabbed-block">
<p>Plotly is unfortunately not able to directly receive a PySpark DataFrame, so we need to convert it to a Pandas DataFrame first. This is done using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.toPandas.html"><code>.toPandas()</code></a> method, which converts the PySpark DataFrame to a Pandas DataFrame.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Plot the results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">data_frame</span><span class="o">=</span><span class="n">category_sales_renamed_ps</span><span class="o">.</span><span class="n">toPandas</span><span class="p">(),</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total Sales by Category&quot;</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Transaction Count&quot;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Sales ($)&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Product Category&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;images/pt2_total_sales_by_category_ps.html&quot;</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<p><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="6c653df9-f8b9-49cb-99bc-930847e5df4f" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("6c653df9-f8b9-49cb-99bc-930847e5df4f")) {                    Plotly.newPlot(                        "6c653df9-f8b9-49cb-99bc-930847e5df4f",                        [{"hovertemplate":"Product Category=%{x}\u003cbr\u003eTotal Sales (<span class="arithmatex">\()=%{y}\u003cbr\u003eTransaction Count=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#1F77B4","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"text":{"dtype":"f8","bdata":"AAAAAAAAIkAAAAAAAAA4QAAAAAAAADxAAAAAAAAAMEAAAAAAAAA3QA=="},"textposition":"auto","x":["Home","Food","Electronics","Clothing","Books"],"xaxis":"x","y":{"dtype":"f8","bdata":"cD0K1+PHuEBcj8L1yGHJQJmZmZm5R8ZAwvUoXE+dvEDXo3A9atXDQA=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Product Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Total Sales (\)</span>)"}},"legend":{"tracegroupgap":0},"title":{"text":"Total Sales by Category"},"barmode":"relative"},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html></p>
</div>
</div>
<div class="tabbed-block">
<p>Plotly is also able to receive a Polars DataFrame, so we can use the results of the aggregation directly.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Plot the results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">data_frame</span><span class="o">=</span><span class="n">category_sales_renamed_pl</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total Sales by Category&quot;</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Transaction Count&quot;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Total Sales&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Sales ($)&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;Product Category&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;images/pt2_total_sales_by_category_pl.html&quot;</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<p><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="2db98768-9c01-407c-9c4d-62ad5e896faa" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("2db98768-9c01-407c-9c4d-62ad5e896faa")) {                    Plotly.newPlot(                        "2db98768-9c01-407c-9c4d-62ad5e896faa",                        [{"hovertemplate":"Product Category=%{x}\u003cbr\u003eTotal Sales (<span class="arithmatex">\()=%{y}\u003cbr\u003eTransaction Count=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#1F77B4","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"text":{"dtype":"f8","bdata":"AAAAAAAAN0AAAAAAAAA8QAAAAAAAADBAAAAAAAAAIkAAAAAAAAA4QA=="},"textposition":"auto","x":["Books","Electronics","Clothing","Home","Food"],"xaxis":"x","y":{"dtype":"f8","bdata":"2KNwPWrVw0CbmZmZuUfGQML1KFxPnbxAcD0K1+PHuEBdj8L1yGHJQA=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Product Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Total Sales (\)</span>)"}},"legend":{"tracegroupgap":0},"title":{"text":"Total Sales by Category"},"barmode":"relative"},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html></p>
</div>
</div>
</div>
</div>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="e49480ed-8db5-4b14-9e78-3789c37f9b31" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("e49480ed-8db5-4b14-9e78-3789c37f9b31")) {                    Plotly.newPlot(                        "e49480ed-8db5-4b14-9e78-3789c37f9b31",                        [{"hovertemplate":"Product Category=%{x}\u003cbr\u003eTotal Sales ($)=%{y}\u003cbr\u003eTransaction Count=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#1F77B4","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"text":{"dtype":"f8","bdata":"AAAAAAAAN0AAAAAAAAAwQAAAAAAAADxAAAAAAAAAOEAAAAAAAAAiQA=="},"textposition":"auto","x":["Books","Clothing","Electronics","Food","Home"],"xaxis":"x","y":{"dtype":"f8","bdata":"16NwPWrVw0DD9ShcT528QJqZmZm5R8ZAXI\u002fC9chhyUBwPQrX48e4QA=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Product Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Total Sales ($)"}},"legend":{"tracegroupgap":0},"title":{"text":"Total Sales by Category"},"barmode":"relative"},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html>

<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="734c3450-1f56-49fa-9f4a-f3f971e0cae6" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("734c3450-1f56-49fa-9f4a-f3f971e0cae6")) {                    Plotly.newPlot(                        "734c3450-1f56-49fa-9f4a-f3f971e0cae6",                        [{"hovertemplate":"Product Category=%{x}\u003cbr\u003eTotal Sales ($)=%{y}\u003cbr\u003eTransaction Count=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#1F77B4","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"text":{"dtype":"f8","bdata":"AAAAAAAAN0AAAAAAAAAwQAAAAAAAADxAAAAAAAAAOEAAAAAAAAAiQA=="},"textposition":"auto","x":["Books","Clothing","Electronics","Food","Home"],"xaxis":"x","y":{"dtype":"f8","bdata":"16NwPWrVw0DD9ShcT528QJqZmZm5R8ZAXI\u002fC9chhyUBwPQrX48e4QA=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Product Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Total Sales ($)"}},"legend":{"tracegroupgap":0},"title":{"text":"Total Sales by Category"},"barmode":"relative"},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html>

<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="6c653df9-f8b9-49cb-99bc-930847e5df4f" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("6c653df9-f8b9-49cb-99bc-930847e5df4f")) {                    Plotly.newPlot(                        "6c653df9-f8b9-49cb-99bc-930847e5df4f",                        [{"hovertemplate":"Product Category=%{x}\u003cbr\u003eTotal Sales ($)=%{y}\u003cbr\u003eTransaction Count=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#1F77B4","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"text":{"dtype":"f8","bdata":"AAAAAAAAIkAAAAAAAAA4QAAAAAAAADxAAAAAAAAAMEAAAAAAAAA3QA=="},"textposition":"auto","x":["Home","Food","Electronics","Clothing","Books"],"xaxis":"x","y":{"dtype":"f8","bdata":"cD0K1+PHuEBcj8L1yGHJQJmZmZm5R8ZAwvUoXE+dvEDXo3A9atXDQA=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Product Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Total Sales ($)"}},"legend":{"tracegroupgap":0},"title":{"text":"Total Sales by Category"},"barmode":"relative"},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html>

<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="2db98768-9c01-407c-9c4d-62ad5e896faa" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("2db98768-9c01-407c-9c4d-62ad5e896faa")) {                    Plotly.newPlot(                        "2db98768-9c01-407c-9c4d-62ad5e896faa",                        [{"hovertemplate":"Product Category=%{x}\u003cbr\u003eTotal Sales ($)=%{y}\u003cbr\u003eTransaction Count=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#1F77B4","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"text":{"dtype":"f8","bdata":"AAAAAAAAN0AAAAAAAAA8QAAAAAAAADBAAAAAAAAAIkAAAAAAAAA4QA=="},"textposition":"auto","x":["Books","Electronics","Clothing","Home","Food"],"xaxis":"x","y":{"dtype":"f8","bdata":"2KNwPWrVw0CbmZmZuUfGQML1KFxPnbxAcD0K1+PHuEBdj8L1yGHJQA=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Product Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Total Sales ($)"}},"legend":{"tracegroupgap":0},"title":{"text":"Total Sales by Category"},"barmode":"relative"},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html>

<h2 id="3-joining">3. Joining<a class="headerlink" href="#3-joining" title="Permanent link">🔗</a></h2>
<p>The third section will demonstrate how to join DataFrames to combine data from different sources. This is a common operation in data analysis, allowing us to enrich our data with additional information.</p>
<p>Here, we will join the <code>sales</code> DataFrame with the <code>product</code> DataFrame to get additional information about the products sold.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:4"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><input id="__tabbed_11_3" name="__tabbed_11" type="radio" /><input id="__tabbed_11_4" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">Pandas</label><label for="__tabbed_11_2">SQL</label><label for="__tabbed_11_3">PySpark</label><label for="__tabbed_11_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.merge.html"><code>pd.merge()</code></a> method to combine rows from two or more tables based on a related column between them. In this case, we will join the <code>sales</code> table with the <code>product</code> table on the <code>product_id</code> column.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Join sales with product data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_with_product_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">left</span><span class="o">=</span><span class="n">df_sales_pd</span><span class="p">,</span>
    <span class="n">right</span><span class="o">=</span><span class="n">df_product_pd</span><span class="p">[[</span><span class="s2">&quot;product_id&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;product_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales with Product Information: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sales_with_product_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_with_product_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_with_product_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales with Product Information: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>        date  customer_id  product_id     category  sales_amount  quantity  product_name   price
0 2023-01-01           52          45         Food        490.76         7    Product 45  493.14
1 2023-01-02           93          41  Electronics        453.94         5    Product 41  193.39
2 2023-01-03           15          29         Home        994.51         5    Product 29   80.07
3 2023-01-04           72          15  Electronics        184.17         7    Product 15  153.67
4 2023-01-05           61          45         Food         27.89         9    Product 45  493.14
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 41</td>
<td style="text-align: right;">193.39</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 29</td>
<td style="text-align: right;">80.07</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 15</td>
<td style="text-align: right;">153.67</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the <a href="https://www.sqlitetutorial.net/sqlite-join/"><code>JOIN</code></a> clause to combine rows from two or more tables based on a related column between them. In this case, we will join the <code>sales</code> table with the <code>product</code> table on the <code>product_id</code> column.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Join sales with product data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_with_product_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT s.*, p.product_name, p.price</span>
<span class="s2">    FROM sales s</span>
<span class="s2">    LEFT JOIN product p ON s.product_id = p.product_id</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales with Product Information: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_with_product_txt</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_with_product_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sales_with_product_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales with Product Information: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>                  date  customer_id  product_id     category  sales_amount  quantity  product_name   price
0  2023-01-01 00:00:00           52          45         Food        490.76         7    Product 45  493.14
1  2023-01-02 00:00:00           93          41  Electronics        453.94         5    Product 41  193.39
2  2023-01-03 00:00:00           15          29         Home        994.51         5    Product 29   80.07
3  2023-01-04 00:00:00           72          15  Electronics        184.17         7    Product 15  153.67
4  2023-01-05 00:00:00           61          45         Food         27.89         9    Product 45  493.14
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 41</td>
<td style="text-align: right;">193.39</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 29</td>
<td style="text-align: right;">80.07</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 15</td>
<td style="text-align: right;">153.67</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.join.html"><code>.join()</code></a> method to combine rows from two or more DataFrames based on a related column between them. In this case, we will join the <code>sales</code> DataFrame with the <code>product</code> DataFrame on the <code>product_id</code> column.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Join sales with product data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_with_product_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">other</span><span class="o">=</span><span class="n">df_product_ps</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;product_id&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">),</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;product_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales with Product Information: </span><span class="si">{</span><span class="n">sales_with_product_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sales_with_product_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_with_product_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales with Product Information: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+----------+-------------------+-----------+-----------+------------+--------+------------+------+
|product_id|               date|customer_id|   category|sales_amount|quantity|product_name| price|
+----------+-------------------+-----------+-----------+------------+--------+------------+------+
|         1|2023-01-06 00:00:00|         21|   Clothing|      498.95|       5|   Product 1|257.57|
|         1|2023-01-11 00:00:00|         88|Electronics|      314.98|       9|   Product 1|257.57|
|         1|2023-02-11 00:00:00|         55|       Food|       199.0|       5|   Product 1|257.57|
|         1|2023-04-04 00:00:00|         85|       Food|      146.97|       7|   Product 1|257.57|
|         5|2023-01-21 00:00:00|         64|Electronics|      356.58|       5|   Product 5|200.71|
+----------+-------------------+-----------+-----------+------------+--------+------------+------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-11 00:00:00</td>
<td style="text-align: right;">88</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">314.98</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Product 1</td>
<td style="text-align: right;">257.57</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-02-11 00:00:00</td>
<td style="text-align: right;">55</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">199</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 1</td>
<td style="text-align: right;">257.57</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">2023-01-21 00:00:00</td>
<td style="text-align: right;">64</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">356.58</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 5</td>
<td style="text-align: right;">200.71</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">2023-02-18 00:00:00</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">79.71</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Product 5</td>
<td style="text-align: right;">200.71</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">2023-03-23 00:00:00</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">48.45</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Product 6</td>
<td style="text-align: right;">15.31</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.join.html"><code>.join()</code></a> method to combine rows from two or more DataFrames based on a related column between them. In this case, we will join the <code>sales</code> DataFrame with the <code>product</code> DataFrame on the <code>product_id</code> column.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Join sales with product data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sales_with_product_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">df_product_pl</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;product_id&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">]),</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;product_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales with Product Information: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sales_with_product_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_with_product_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_with_product_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Sales with Product Information: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 8)
┌─────────────────────┬─────────────┬────────────┬─────────────┬──────────────┬──────────┬──────────────┬────────┐
│ date                ┆ customer_id ┆ product_id ┆ category    ┆ sales_amount ┆ quantity ┆ product_name ┆ price  │
│ ---                 ┆ ---         ┆ ---        ┆ ---         ┆ ---          ┆ ---      ┆ ---          ┆ ---    │
│ datetime[ns]        ┆ i64         ┆ i64        ┆ str         ┆ f64          ┆ i64      ┆ str          ┆ f64    │
╞═════════════════════╪═════════════╪════════════╪═════════════╪══════════════╪══════════╪══════════════╪════════╡
│ 2023-01-01 00:00:00 ┆ 52          ┆ 45         ┆ Food        ┆ 490.76       ┆ 7        ┆ Product 45   ┆ 493.14 │
│ 2023-01-02 00:00:00 ┆ 93          ┆ 41         ┆ Electronics ┆ 453.94       ┆ 5        ┆ Product 41   ┆ 193.39 │
│ 2023-01-03 00:00:00 ┆ 15          ┆ 29         ┆ Home        ┆ 994.51       ┆ 5        ┆ Product 29   ┆ 80.07  │
│ 2023-01-04 00:00:00 ┆ 72          ┆ 15         ┆ Electronics ┆ 184.17       ┆ 7        ┆ Product 15   ┆ 153.67 │
│ 2023-01-05 00:00:00 ┆ 61          ┆ 45         ┆ Food        ┆ 27.89        ┆ 9        ┆ Product 45   ┆ 493.14 │
└─────────────────────┴─────────────┴────────────┴─────────────┴──────────────┴──────────┴──────────────┴────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 41</td>
<td style="text-align: right;">193.39</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 29</td>
<td style="text-align: right;">80.07</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 15</td>
<td style="text-align: right;">153.67</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>In the next step, we will join the resulting DataFrame with the <code>customer</code> DataFrame to get customer information for each sale. This allows us to create a complete view of the sales data, including product and customer details.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:4"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><input id="__tabbed_12_3" name="__tabbed_12" type="radio" /><input id="__tabbed_12_4" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">Pandas</label><label for="__tabbed_12_2">SQL</label><label for="__tabbed_12_3">PySpark</label><label for="__tabbed_12_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>This process is similar to the previous step, but now we will extend the <code>sales_with_product</code> DataFrame to join it with the <code>customer</code> DataFrame on the <code>customer_id</code> column. This will give us a complete view of the sales data, including product and customer details.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Join with customer information to get a complete view</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">complete_sales_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">sales_with_product_pd</span><span class="p">,</span>
    <span class="n">df_customer_pd</span><span class="p">[[</span><span class="s2">&quot;customer_id&quot;</span><span class="p">,</span> <span class="s2">&quot;customer_name&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;customer_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete Sales Data with Customer Information: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">complete_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Complete Sales Data with Customer Information: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>        date  customer_id  product_id     category  sales_amount  quantity  product_name   price  customer_name      city  state
0 2023-01-01           52          45         Food        490.76         7    Product 45  493.14    Customer 52   Phoenix     TX
1 2023-01-02           93          41  Electronics        453.94         5    Product 41  193.39    Customer 93  New York     TX
2 2023-01-03           15          29         Home        994.51         5    Product 29   80.07    Customer 15  New York     CA
3 2023-01-04           72          15  Electronics        184.17         7    Product 15  153.67    Customer 72   Houston     IL
4 2023-01-05           61          45         Food         27.89         9    Product 45  493.14    Customer 61   Phoenix     IL
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">customer_name</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: left;">Customer 52</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">TX</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 41</td>
<td style="text-align: right;">193.39</td>
<td style="text-align: left;">Customer 93</td>
<td style="text-align: left;">New York</td>
<td style="text-align: left;">TX</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 29</td>
<td style="text-align: right;">80.07</td>
<td style="text-align: left;">Customer 15</td>
<td style="text-align: left;">New York</td>
<td style="text-align: left;">CA</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 15</td>
<td style="text-align: right;">153.67</td>
<td style="text-align: left;">Customer 72</td>
<td style="text-align: left;">Houston</td>
<td style="text-align: left;">IL</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: left;">Customer 61</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">IL</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>This process is similar to the previous step, but now we will extend the <code>sales_with_product</code> DataFrame to join it with the <code>customer</code> DataFrame on the <code>customer_id</code> column. This will give us a complete view of the sales data, including product and customer details.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Join with customer information to get a complete view</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">complete_sales_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        s.*,</span>
<span class="s2">        p.product_name,</span>
<span class="s2">        p.price,</span>
<span class="s2">        c.customer_name,</span>
<span class="s2">        c.city,</span>
<span class="s2">        c.state</span>
<span class="s2">    FROM sales s</span>
<span class="s2">    LEFT JOIN product p ON s.product_id = p.product_id</span>
<span class="s2">    LEFT JOIN customer c ON s.customer_id = c.customer_id</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete Sales Data with Customer Information: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">complete_sales_txt</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">complete_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">complete_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Complete Sales Data with Customer Information: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>                  date  customer_id  product_id     category  sales_amount  quantity  product_name   price  customer_name      city  state
0  2023-01-01 00:00:00           52          45         Food        490.76         7    Product 45  493.14    Customer 52   Phoenix     TX
1  2023-01-02 00:00:00           93          41  Electronics        453.94         5    Product 41  193.39    Customer 93  New York     TX
2  2023-01-03 00:00:00           15          29         Home        994.51         5    Product 29   80.07    Customer 15  New York     CA
3  2023-01-04 00:00:00           72          15  Electronics        184.17         7    Product 15  153.67    Customer 72   Houston     IL
4  2023-01-05 00:00:00           61          45         Food         27.89         9    Product 45  493.14    Customer 61   Phoenix     IL
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">customer_name</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: left;">Customer 52</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">TX</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 41</td>
<td style="text-align: right;">193.39</td>
<td style="text-align: left;">Customer 93</td>
<td style="text-align: left;">New York</td>
<td style="text-align: left;">TX</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 29</td>
<td style="text-align: right;">80.07</td>
<td style="text-align: left;">Customer 15</td>
<td style="text-align: left;">New York</td>
<td style="text-align: left;">CA</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 15</td>
<td style="text-align: right;">153.67</td>
<td style="text-align: left;">Customer 72</td>
<td style="text-align: left;">Houston</td>
<td style="text-align: left;">IL</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: left;">Customer 61</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">IL</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>This process is similar to the previous step, but now we will extend the <code>sales_with_product</code> DataFrame to join it with the <code>customer</code> DataFrame on the <code>customer_id</code> column. This will give us a complete view of the sales data, including product and customer details.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Join with customer information to get a complete view</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">complete_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">sales_with_product_ps</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">other</span><span class="o">=</span><span class="n">df_customer_ps</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;customer_id&quot;</span><span class="p">,</span> <span class="s2">&quot;customer_name&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">),</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;customer_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete Sales Data with Customer Information: </span><span class="si">{</span><span class="n">complete_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">complete_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Complete Sales Data with Customer Information: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-----------+----------+-------------------+-----------+------------+--------+------------+------+-------------+-----------+-----+
|customer_id|product_id|               date|   category|sales_amount|quantity|product_name| price|customer_name|       city|state|
+-----------+----------+-------------------+-----------+------------+--------+------------+------+-------------+-----------+-----+
|         39|         5|2023-02-18 00:00:00|      Books|       79.71|       8|   Product 5|200.71|  Customer 39|Los Angeles|   NY|
|         88|         1|2023-01-11 00:00:00|Electronics|      314.98|       9|   Product 1|257.57|  Customer 88|Los Angeles|   TX|
|         85|         1|2023-04-04 00:00:00|       Food|      146.97|       7|   Product 1|257.57|  Customer 85|    Phoenix|   CA|
|         55|         1|2023-02-11 00:00:00|       Food|       199.0|       5|   Product 1|257.57|  Customer 55|Los Angeles|   NY|
|         21|         1|2023-01-06 00:00:00|   Clothing|      498.95|       5|   Product 1|257.57|  Customer 21|Los Angeles|   IL|
+-----------+----------+-------------------+-----------+------------+--------+------------+------+-------------+-----------+-----+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">customer_name</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-11 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">314.98</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Product 1</td>
<td style="text-align: right;">257.57</td>
<td style="text-align: left;">Customer 88</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">TX</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-02-11 00:00:00</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">199</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 1</td>
<td style="text-align: right;">257.57</td>
<td style="text-align: left;">Customer 55</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">NY</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">2023-01-21 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">356.58</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 5</td>
<td style="text-align: right;">200.71</td>
<td style="text-align: left;">Customer 64</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">NY</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">2023-02-18 00:00:00</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">79.71</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Product 5</td>
<td style="text-align: right;">200.71</td>
<td style="text-align: left;">Customer 39</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">NY</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">2023-03-23 00:00:00</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">48.45</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Product 6</td>
<td style="text-align: right;">15.31</td>
<td style="text-align: left;">Customer 34</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">NY</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>This process is similar to the previous step, but now we will extend the <code>sales_with_product</code> DataFrame to join it with the <code>customer</code> DataFrame on the <code>customer_id</code> column. This will give us a complete view of the sales data, including product and customer details.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Join with customer information to get a complete view</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">complete_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">sales_with_product_pl</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">df_customer_pl</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;customer_id&quot;</span><span class="p">,</span> <span class="s2">&quot;customer_name&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">]),</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;customer_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete Sales Data with Customer Information: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">complete_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Complete Sales Data with Customer Information: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 11)
┌─────────────────────┬─────────────┬────────────┬─────────────┬──────────────┬──────────┬──────────────┬────────┬───────────────┬──────────┬───────┐
│ date                ┆ customer_id ┆ product_id ┆ category    ┆ sales_amount ┆ quantity ┆ product_name ┆ price  ┆ customer_name ┆ city     ┆ state │
│ ---                 ┆ ---         ┆ ---        ┆ ---         ┆ ---          ┆ ---      ┆ ---          ┆ ---    ┆ ---           ┆ ---      ┆ ---   │
│ datetime[ns]        ┆ i64         ┆ i64        ┆ str         ┆ f64          ┆ i64      ┆ str          ┆ f64    ┆ str           ┆ str      ┆ str   │
╞═════════════════════╪═════════════╪════════════╪═════════════╪══════════════╪══════════╪══════════════╪════════╪═══════════════╪══════════╪═══════╡
│ 2023-01-01 00:00:00 ┆ 52          ┆ 45         ┆ Food        ┆ 490.76       ┆ 7        ┆ Product 45   ┆ 493.14 ┆ Customer 52   ┆ Phoenis  ┆ TX    │
│ 2023-01-02 00:00:00 ┆ 93          ┆ 41         ┆ Electronics ┆ 453.94       ┆ 5        ┆ Product 41   ┆ 193.39 ┆ Customer 93   ┆ New York ┆ TX    │
│ 2023-01-03 00:00:00 ┆ 15          ┆ 29         ┆ Home        ┆ 994.51       ┆ 5        ┆ Product 29   ┆ 80.07  ┆ Customer 15   ┆ New York ┆ CA    │
│ 2023-01-04 00:00:00 ┆ 72          ┆ 15         ┆ Electronics ┆ 184.17       ┆ 7        ┆ Product 15   ┆ 153.67 ┆ Customer 72   ┆ Houston  ┆ IL    │
│ 2023-01-05 00:00:00 ┆ 61          ┆ 45         ┆ Food        ┆ 27.89        ┆ 9        ┆ Product 45   ┆ 493.14 ┆ Customer 61   ┆ Phoenix  ┆ IL    │
└─────────────────────┴─────────────┴────────────┴─────────────┴──────────────┴──────────┴──────────────┴────────┴───────────────┴──────────┴───────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: left;">product_name</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">customer_name</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: left;">Customer 52</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">TX</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 41</td>
<td style="text-align: right;">193.39</td>
<td style="text-align: left;">Customer 93</td>
<td style="text-align: left;">New York</td>
<td style="text-align: left;">TX</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Product 29</td>
<td style="text-align: right;">80.07</td>
<td style="text-align: left;">Customer 15</td>
<td style="text-align: left;">New York</td>
<td style="text-align: left;">CA</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Product 15</td>
<td style="text-align: right;">153.67</td>
<td style="text-align: left;">Customer 72</td>
<td style="text-align: left;">Houston</td>
<td style="text-align: left;">IL</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Product 45</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: left;">Customer 61</td>
<td style="text-align: left;">Phoenix</td>
<td style="text-align: left;">IL</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Once we have the complete sales data, we can calculate the revenue for each sale by multiplying the price and quantity (columns from different tables). We can also compare this calculated revenue with the sales amount to identify any discrepancies.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:4"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><input id="__tabbed_13_3" name="__tabbed_13" type="radio" /><input id="__tabbed_13_4" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">Pandas</label><label for="__tabbed_13_2">SQL</label><label for="__tabbed_13_3">PySpark</label><label for="__tabbed_13_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can calculate the revenue for each sale by multiplying the <code>price</code> and <code>quantity</code> columns. We can then compare this calculated revenue with the <code>sales_amount</code> column to identify any discrepancies.</p>
<p>Notice here that the syntax for Pandas uses the <code>DataFrame</code> object directly, and we can access the columns using the 'slice' (<code>[]</code>) operator.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate revenue and compare with sales amount</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">complete_sales_pd</span><span class="p">[</span><span class="s2">&quot;calculated_revenue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">complete_sales_pd</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">complete_sales_pd</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span>
<span class="n">complete_sales_pd</span><span class="p">[</span><span class="s2">&quot;price_difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">complete_sales_pd</span><span class="p">[</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">complete_sales_pd</span><span class="p">[</span><span class="s2">&quot;calculated_revenue&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete Sales Data with Calculated Revenue and Price Difference: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">complete_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_sales_pd</span><span class="p">[[</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;calculated_revenue&quot;</span><span class="p">,</span> <span class="s2">&quot;price_difference&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">complete_sales_pd</span><span class="p">[[</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;calculated_revenue&quot;</span><span class="p">,</span> <span class="s2">&quot;price_difference&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_markdown</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Complete Sales Data with Calculated Revenue and Price Difference: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>   sales_amount   price  quantity  calculated_revenue  price_difference
0        490.76  493.14         7             3451.98          -2961.22
1        453.94  193.39         5              966.95           -513.01
2        994.51   80.07         5              400.35            594.16
3        184.17  153.67         7             1075.69           -891.52
4         27.89  493.14         9             4438.26          -4410.37
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">price</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: right;">calculated_revenue</th>
<th style="text-align: right;">price_difference</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3451.98</td>
<td style="text-align: right;">-2961.22</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">193.39</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">966.95</td>
<td style="text-align: right;">-513.01</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">80.07</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">400.35</td>
<td style="text-align: right;">594.16</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">153.67</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1075.69</td>
<td style="text-align: right;">-891.52</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">4438.26</td>
<td style="text-align: right;">-4410.37</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can calculate the revenue for each sale by multiplying the <code>price</code> and <code>quantity</code> columns. We can then compare this calculated revenue with the <code>sales_amount</code> column to identify any discrepancies.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate revenue and compare with sales amount</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">revenue_comparison_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        s.sales_amount,</span>
<span class="s2">        p.price,</span>
<span class="s2">        s.quantity,</span>
<span class="s2">        (p.price * s.quantity) AS calculated_revenue,</span>
<span class="s2">        (s.sales_amount - (p.price * s.quantity)) AS price_difference</span>
<span class="s2">    FROM sales s</span>
<span class="s2">    LEFT JOIN product p ON s.product_id = p.product_id</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Complete Sales Data with Calculated Revenue and Price Difference: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">revenue_comparison_txt</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">revenue_comparison_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">revenue_comparison_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Complete Sales Data with Calculated Revenue and Price Difference: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>   sales_amount   price  quantity  calculated_revenue  price_difference
0        490.76  493.14         7             3451.98          -2961.22
1        453.94  193.39         5              966.95           -513.01
2        994.51   80.07         5              400.35            594.16
3        184.17  153.67         7             1075.69           -891.52
4         27.89  493.14         9             4438.26          -4410.37
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">price</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: right;">calculated_revenue</th>
<th style="text-align: right;">price_difference</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3451.98</td>
<td style="text-align: right;">-2961.22</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">193.39</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">966.95</td>
<td style="text-align: right;">-513.01</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">80.07</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">400.35</td>
<td style="text-align: right;">594.16</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">153.67</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1075.69</td>
<td style="text-align: right;">-891.52</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">4438.26</td>
<td style="text-align: right;">-4410.37</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can calculate the revenue for each sale by multiplying the <code>price</code> and <code>quantity</code> columns. We can then compare this calculated revenue with the <code>sales_amount</code> column to identify any discrepancies.</p>
<p>Notice here that the syntax for PySpark uses the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.withColumns.html"><code>.withColumns</code></a> method to add new multiple columns to the DataFrame simultaneously. This method takes a dictionary where the keys are the names of the new columns and the values are the expressions to compute those columns. The methematical computation we have shown here uses two different methods:</p>
<ol>
<li>With the PySpark API, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.col.html"><code>F.col()</code></a> function to refer to the columns, and multiply them directly</li>
<li>With the Spark SQL API, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.expr.html"><code>F.expr()</code></a> function to write a SQL-like expression for the calculation.</li>
</ol>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate revenue and compare with sales amount</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">complete_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">complete_sales_ps</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;calculated_revenue&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">),</span>
        <span class="s2">&quot;price_difference&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;sales_amount - (price * quantity)&quot;</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;calculated_revenue&quot;</span><span class="p">,</span> <span class="s2">&quot;price_difference&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete Sales Data with Calculated Revenue and Price Difference: </span><span class="si">{</span><span class="n">complete_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">complete_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Complete Sales Data with Calculated Revenue and Price Difference: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+------------+------+--------+------------------+------------------+
|sales_amount| price|quantity|calculated_revenue|  price_difference|
+------------+------+--------+------------------+------------------+
|       79.71|200.71|       8|           1605.68|          -1525.97|
|      314.98|257.57|       9|           2318.13|          -2003.15|
|      146.97|257.57|       7|           1802.99|          -1656.02|
|       199.0|257.57|       5|           1287.85|          -1088.85|
|      498.95|257.57|       5|           1287.85|-788.8999999999999|
+------------+------+--------+------------------+------------------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">price</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: right;">calculated_revenue</th>
<th style="text-align: right;">price_difference</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48.45</td>
<td style="text-align: right;">15.31</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">122.48</td>
<td style="text-align: right;">-74.03</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">79.71</td>
<td style="text-align: right;">200.71</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1605.68</td>
<td style="text-align: right;">-1525.97</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">314.98</td>
<td style="text-align: right;">257.57</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2318.13</td>
<td style="text-align: right;">-2003.15</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">199</td>
<td style="text-align: right;">257.57</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1287.85</td>
<td style="text-align: right;">-1088.85</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">356.58</td>
<td style="text-align: right;">200.71</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1003.55</td>
<td style="text-align: right;">-646.97</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can calculate the revenue for each sale by multiplying the <code>price</code> and <code>quantity</code> columns. We can then compare this calculated revenue with the <code>sales_amount</code> column to identify any discrepancies.</p>
<p>Notice here that the syntax for Polars uses the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.with_columns.html"><code>.with_columns</code></a> method to add new multiple columns to the DataFrame simultaneously. This method takes a list of expressions, where each expression defines a new column.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate revenue and compare with sales amount</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">complete_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">complete_sales_pl</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;calculated_revenue&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;price_difference&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete Sales Data with Calculated Revenue and Price Difference: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">complete_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_sales_pl</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;calculated_revenue&quot;</span><span class="p">,</span> <span class="s2">&quot;price_difference&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">complete_sales_pl</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;calculated_revenue&quot;</span><span class="p">,</span> <span class="s2">&quot;price_difference&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
    <span class="o">.</span><span class="n">to_markdown</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Complete Sales Data with Calculated Revenue and Price Difference: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>┌──────────────┬────────┬──────────┬────────────────────┬──────────────────┐
│ sales_amount ┆ price  ┆ quantity ┆ calculated_revenue ┆ price_difference │
│ ---          ┆ ---    ┆ ---      ┆ ---                ┆ ---              │
│ f64          ┆ f64    ┆ i64      ┆ f64                ┆ f64              │
╞══════════════╪════════╪══════════╪════════════════════╪══════════════════╡
│ 490.76       ┆ 493.14 ┆ 7        ┆ 3451.98            ┆ -2961.22         │
│ 453.94       ┆ 193.39 ┆ 5        ┆ 966.95             ┆ -513.01          │
│ 994.51       ┆ 80.07  ┆ 5        ┆ 400.35             ┆ 594.16           │
│ 184.17       ┆ 153.67 ┆ 7        ┆ 1075.69            ┆ -891.52          │
│ 27.89        ┆ 493.14 ┆ 9        ┆ 4438.26            ┆ -4410.37         │
└──────────────┴────────┴──────────┴────────────────────┴──────────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">sales_amount</th>
<th style="text-align: right;">price</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: right;">calculated_revenue</th>
<th style="text-align: right;">price_difference</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3451.98</td>
<td style="text-align: right;">-2961.22</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">193.39</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">966.95</td>
<td style="text-align: right;">-513.01</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">80.07</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">400.35</td>
<td style="text-align: right;">594.16</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">153.67</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1075.69</td>
<td style="text-align: right;">-891.52</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">493.14</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">4438.26</td>
<td style="text-align: right;">-4410.37</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<h2 id="4-window-functions">4. Window Functions<a class="headerlink" href="#4-window-functions" title="Permanent link">🔗</a></h2>
<p>Window functions are a powerful feature in Pandas that allow us to perform calculations across a set of rows related to the current row. This is particularly useful for time series data, where we may want to calculate rolling averages, cumulative sums, or other metrics based on previous or subsequent rows.</p>
<p>To understand more about the nuances of the window functions, check out some of these guides:</p>
<ul>
<li><a href="https://docs.snowflake.com/en/user-guide/functions-window-using">Analyzing data with window functions</a></li>
<li><a href="https://medium.com/learning-sql/sql-window-function-visualized-fff1927f00f2">SQL Window Functions Visualized</a></li>
</ul>
<p>In this section, we will demonstrate how to use window functions to analyze sales data over time. We will start by converting the <code>date</code> column to a datetime type, which is necessary for time-based calculations. We will then group the data by date and calculate the total sales for each day.</p>
<p>The first thing that we will do is to group the sales data by date and calculate the total sales for each day. This will give us a daily summary of sales, which we can then use to analyze trends over time.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:4"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><input id="__tabbed_14_3" name="__tabbed_14" type="radio" /><input id="__tabbed_14_4" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">Pandas</label><label for="__tabbed_14_2">SQL</label><label for="__tabbed_14_3">PySpark</label><label for="__tabbed_14_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html"><code>.groupby()</code></a> method to group the data by the <code>date</code> column, followed by the <a href="https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.DataFrameGroupBy.agg.html"><code>.agg()</code></a> method to calculate the total sales for each day. This will then set us up for further time-based calculations in the following steps</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Time-based window function</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df_sales_pd</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_sales_pd</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span>  <span class="c1"># Ensure correct date type</span>
<span class="n">daily_sales_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_sales_pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_sales_pd</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">total_sales</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales Summary: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>         date  total_sales
0  2023-01-01        490.76
1  2023-01-02        453.94
2  2023-01-03        994.51
3  2023-01-04        184.17
4  2023-01-05         27.89
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05</td>
<td style="text-align: right;">27.89</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the <code>GROUP BY</code> clause to group the data by the <code>date</code> column and then use the <code>SUM()</code> function to calculate the total sales for each day. This will give us a daily summary of sales, which we can then use to analyze trends over time.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Time-based window function</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        date,</span>
<span class="s2">        SUM(sales_amount) AS total_sales</span>
<span class="s2">    FROM sales</span>
<span class="s2">    GROUP BY date</span>
<span class="s2">    ORDER BY date</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">daily_sales_txt</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">daily_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">daily_sales_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales Summary: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>                  date  total_sales
0  2023-01-01 00:00:00       490.76
1  2023-01-02 00:00:00       453.94
2  2023-01-03 00:00:00       994.51
3  2023-01-04 00:00:00       184.17
4  2023-01-05 00:00:00        27.89
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">27.89</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.groupBy.html"><code>.groupBy()</code></a> method to group the data by the <code>date</code> column, followed by the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.GroupedData.agg.html"><code>.agg()</code></a> method to calculate the total sales for each day. This will then set us up for further time-based calculations in the following steps.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Time-based window function</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">to_date</span><span class="p">(</span><span class="n">df_sales_ps</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]))</span>
<span class="n">daily_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales Summary: </span><span class="si">{</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales Summary: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+----------+-----------+
|      date|total_sales|
+----------+-----------+
|2023-01-01|     490.76|
|2023-01-02|     453.94|
|2023-01-03|     994.51|
|2023-01-04|     184.17|
|2023-01-05|      27.89|
+----------+-----------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05</td>
<td style="text-align: right;">27.89</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.group_by.html"><code>.group_by()</code></a> method to group the data by the <code>date</code> column, followed by the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.dataframe.group_by.GroupBy.agg.html"><code>.agg()</code></a> method to calculate the total sales for each day. This will then set us up for further time-based calculations in the following steps.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Time-based window function</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">df_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Date</span><span class="p">))</span>
<span class="n">daily_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales Summary: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 2)
┌────────────┬─────────────┐
│ date       ┆ total_sales │
│ ---        ┆ ---         │
│ date       ┆ f64         │
╞════════════╪═════════════╡
│ 2023-01-01 ┆ 490.76      │
│ 2023-01-02 ┆ 453.94      │
│ 2023-01-03 ┆ 994.51      │
│ 2023-01-04 ┆ 184.17      │
│ 2023-01-05 ┆ 27.89       │
└────────────┴─────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">27.89</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Next, we will calculate the lag and lead values for the sales amount. This allows us to compare the current day's sales with the previous and next days' sales.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:4"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><input id="__tabbed_15_3" name="__tabbed_15" type="radio" /><input id="__tabbed_15_4" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">Pandas</label><label for="__tabbed_15_2">SQL</label><label for="__tabbed_15_3">PySpark</label><label for="__tabbed_15_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can calculate the lag and lead values for the sales amount by using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.shift.html"><code>.shift()</code></a> method. This method shifts the values in a column by a specified number of periods, allowing us to create lag and lead columns.</p>
<p>Note that the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.shift.html"><code>.shift()</code></a> method simply shifts the values in the column by a number of rows up or down, so we can use it to create lag and lead columns. This function itself does not need to be ordered because it assumes that the DataFrame is already ordered. However, if you want it to be ordered, you can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html"><code>.sort_values()</code></a> method before applying <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.shift.html"><code>.shift()</code></a>.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate lag and lead</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;previous_day_sales&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;next_day_sales&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with Lag and Lead: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with Lag and Lead: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>         date  total_sales  previous_day_sales  next_day_sales
0  2023-01-01       490.76                 NaN          453.94
1  2023-01-02       453.94              490.76          994.51
2  2023-01-03       994.51              453.94          184.17
3  2023-01-04       184.17              994.51           27.89
4  2023-01-05        27.89              184.17          498.95
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the <code>LAG()</code> and <code>LEAD()</code> window functions to calculate the lag and lead values for the sales amount. These functions allow us to access data from previous and next rows in the result set without needing to join the table to itself.</p>
<p>The part that is important to note here is that the <code>LAG()</code> and <code>LEAD()</code> functions are used in conjunction with the <code>OVER</code> clause, which defines the window over which the function operates. In this case, we are ordering by the <code>date</code> column to ensure that the lag and lead values are calculated based on the chronological order of the sales data.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate lag and lead</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">lag_lead_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        date AS sale_date,</span>
<span class="s2">        SUM(sales_amount) AS total_sales,</span>
<span class="s2">        LAG(SUM(sales_amount)) OVER (ORDER BY date) AS previous_day_sales,</span>
<span class="s2">        LEAD(SUM(sales_amount)) OVER (ORDER BY date) AS next_day_sales</span>
<span class="s2">    FROM sales</span>
<span class="s2">    GROUP BY date</span>
<span class="s2">    ORDER BY date</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">lag_lead_df_sql</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">lag_lead_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with Lag and Lead: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lag_lead_df_sql</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">lag_lead_txt</span> <span class="o">+</span> <span class="s2">&quot; LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">lag_lead_txt</span> <span class="o">+</span> <span class="s2">&quot; LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with Lag and Lead: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>             sale_date  total_sales  previous_day_sales  next_day_sales
0  2023-01-01 00:00:00        490.76                 NaN          453.94
1  2023-01-02 00:00:00        453.94              490.76          994.51
2  2023-01-03 00:00:00        994.51              453.94          184.17
3  2023-01-04 00:00:00        184.17              994.51           27.89
4  2023-01-05 00:00:00         27.89              184.17          498.95
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">sale_date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.lag.html"><code>.lag()</code></a> and <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.lead.html"><code>.lead()</code></a> functions to calculate the lag and lead values for the sales amount. These functions are used in conjunction with a window specification that defines the order of the rows.</p>
<p>Note that in PySpark, we can define a Window function in one of two ways: using the PySpark API or using the Spark SQL API.</p>
<ol>
<li><strong>The PySpark API</strong>: The PySpark API allows us to define a window specification using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.html"><code>Window()</code></a> class, which provides methods to specify the ordering of the rows. We can then use the <code>F.lag()</code> and <code>F.lead()</code> functions to calculate the lag and lead values <em>over</em> a given window on the table.</li>
<li><strong>The Spark SQL API</strong>: The Spark SQL API is used through the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.expr.html"><code>F.expr()</code></a> function, which allows us to write SQL-like expressions for the calculations. This is similar to how we would write SQL queries, but it is executed within the PySpark context.</li>
</ol>
<p>Here in the below example, we show how the previous day sales can be calculated using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.lag.html"><code>.lag()</code></a> function in the PySpark API, and the next day sales can be calculated using the <a href="https://spark.apache.org/docs/latest/api/sql/index.html#lead"><code>LEAD()</code></a> function in the Spark SQL API. Functionally, both of these two methods achieve the same result, but aesthetically they use slightly different syntax. It is primarily a matter of preference which one you choose to use.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate lag and lead</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">window_spec_ps</span><span class="p">:</span> <span class="n">Window</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="n">daily_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;previous_day_sales&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">lag</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec_ps</span><span class="p">),</span>
        <span class="s2">&quot;next_day_sales&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;LEAD(total_sales) OVER (ORDER BY date)&quot;</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with Lag and Lead: </span><span class="si">{</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with Lag and Lead: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+----------+-----------+------------------+--------------+
|      date|total_sales|previous_day_sales|next_day_sales|
+----------+-----------+------------------+--------------+
|2023-01-01|     490.76|              NULL|        453.94|
|2023-01-02|     453.94|            490.76|        994.51|
|2023-01-03|     994.51|            453.94|        184.17|
|2023-01-04|     184.17|            994.51|         27.89|
|2023-01-05|      27.89|            184.17|        498.95|
+----------+-----------+------------------+--------------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.shift.html"><code>.shift()</code></a> method to calculate the lag and lead values for the sales amount. This method shifts the values in a column by a specified number of periods, allowing us to create lag and lead columns.</p>
<p>Note that the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.shift.html"><code>.shift()</code></a> method simply shifts the values in the column by a number of rows up or down, so we can use it to create lag and lead columns. This function itself does not need to be ordered because it assumes that the DataFrame is already ordered. However, if you want it to be ordered, you can use the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.sort.html"><code>.sort()</code></a> method before applying <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.DataFrame.shift.html"><code>.shift()</code></a>.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate lag and lead</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;previous_day_sales&quot;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;next_day_sales&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with Lag and Lead: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with Lag and Lead: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 4)
┌────────────┬─────────────┬────────────────────┬────────────────┐
│ date       ┆ total_sales ┆ previous_day_sales ┆ next_day_sales │
│ ---        ┆ ---         ┆ ---                ┆ ---            │
│ date       ┆ f64         ┆ f64                ┆ f64            │
╞════════════╪═════════════╪════════════════════╪════════════════╡
│ 2023-01-01 ┆ 490.76      ┆ null               ┆ 453.94         │
│ 2023-01-02 ┆ 453.94      ┆ 490.76             ┆ 994.51         │
│ 2023-01-03 ┆ 994.51      ┆ 453.94             ┆ 184.17         │
│ 2023-01-04 ┆ 184.17      ┆ 994.51             ┆ 27.89          │
│ 2023-01-05 ┆ 27.89       ┆ 184.17             ┆ 498.95         │
└────────────┴─────────────┴────────────────────┴────────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Now, we can calculate the day-over-day change in sales. This is done by subtracting the previous day's sales from the current day's sales. Then secondly, we can calculate the percentage change in sales using the formula:</p>
<div class="highlight"><pre><span></span><code>((current_day_sales - previous_day_sales) / previous_day_sales) * 100
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="16:4"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><input id="__tabbed_16_3" name="__tabbed_16" type="radio" /><input id="__tabbed_16_4" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">Pandas</label><label for="__tabbed_16_2">SQL</label><label for="__tabbed_16_3">PySpark</label><label for="__tabbed_16_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can calculate the day-over-day change in sales by subtracting the <code>previous_day_sales</code> column from the <code>total_sales</code> column. This is a fairly straight-forward calculation.</p>
<p>We can also calculate the percentage change in sales using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pct_change.html"><code>.pct_change()</code></a> method, which calculates the percentage change between the current and previous values. Under the hood, this method calculates the fractional change using the formula:</p>
<div class="highlight"><pre><span></span><code>((value_current_row - value_previous_row) / value_previous_row)
</code></pre></div>
<p>So therefore we need to multiple the result by <code>100</code>.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate day-over-day change</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;day_over_day_change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;previous_day_sales&quot;</span><span class="p">]</span>
<span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;pct_change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with Day-over-Day Change: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with Day-over-Day Change: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>         date  total_sales  previous_day_sales  next_day_sales  day_over_day_change  day_over_day_change  7d_moving_avg
0  2023-01-01       490.76                 NaN          453.94                  NaN                  NaN     490.760000
1  2023-01-02       453.94              490.76          994.51               -36.82               -36.82     472.350000
2  2023-01-03       994.51              453.94          184.17               540.57               540.57     646.403333
3  2023-01-04       184.17              994.51           27.89              -810.34              -810.34     530.845000
4  2023-01-05        27.89              184.17          498.95              -156.28              -156.28     430.254000
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
<th style="text-align: right;">pct_change</th>
<th style="text-align: right;">day_over_day_change</th>
<th style="text-align: right;">7d_moving_avg</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">-7.50265</td>
<td style="text-align: right;">-36.82</td>
<td style="text-align: right;">472.35</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">119.084</td>
<td style="text-align: right;">540.57</td>
<td style="text-align: right;">646.403</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">-81.4813</td>
<td style="text-align: right;">-810.34</td>
<td style="text-align: right;">530.845</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
<td style="text-align: right;">-84.8564</td>
<td style="text-align: right;">-156.28</td>
<td style="text-align: right;">430.254</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can calculate the day-over-day change in sales by subtracting the <code>previous_day_sales</code> column from the <code>total_sales</code> column. We can also calculate the percentage change in sales using the formula:</p>
<div class="highlight"><pre><span></span><code>((current_day_sales - previous_day_sales) / previous_day_sales) * 100
</code></pre></div>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Day-over-day change already calculated</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">dod_change_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        sale_date,</span>
<span class="s2">        total_sales,</span>
<span class="s2">        previous_day_sales,</span>
<span class="s2">        next_day_sales,</span>
<span class="s2">        total_sales - previous_day_sales AS day_over_day_change,</span>
<span class="s2">        ((total_sales - previous_day_sales) / previous_day_sales) * 100 AS pct_change</span>
<span class="s2">    FROM (</span>
<span class="s2">        SELECT</span>
<span class="s2">            date AS sale_date,</span>
<span class="s2">            SUM(sales_amount) AS total_sales,</span>
<span class="s2">            LAG(SUM(sales_amount)) OVER (ORDER BY date) AS previous_day_sales,</span>
<span class="s2">            LEAD(SUM(sales_amount)) OVER (ORDER BY date) AS next_day_sales</span>
<span class="s2">        FROM sales</span>
<span class="s2">        GROUP BY date</span>
<span class="s2">    )</span>
<span class="s2">    ORDER BY sale_date</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">dod_change_df_sql</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">dod_change_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with Day-over-Day Change: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dod_change_df_sql</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dod_change_df_sql</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dod_change_df_sql</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with Day-over-Day Change: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>             sale_date  total_sales  previous_day_sales  next_day_sales  day_over_day_change  pct_change
0  2023-01-01 00:00:00       490.76                 NaN          453.94                  NaN         NaN
1  2023-01-02 00:00:00       453.94              490.76          994.51               -36.82   -7.502649
2  2023-01-03 00:00:00       994.51              453.94          184.17               540.57  119.084020
3  2023-01-04 00:00:00       184.17              994.51           27.89              -810.34  -81.481333
4  2023-01-05 00:00:00        27.89              184.17          498.95              -156.28  -84.856383
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">sale_date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
<th style="text-align: right;">day_over_day_change</th>
<th style="text-align: right;">pct_change</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">-36.82</td>
<td style="text-align: right;">-7.50265</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">540.57</td>
<td style="text-align: right;">119.084</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">-810.34</td>
<td style="text-align: right;">-81.4813</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
<td style="text-align: right;">-156.28</td>
<td style="text-align: right;">-84.8564</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can calculate the day-over-day change in sales by subtracting the <code>previous_day_sales</code> column from the <code>total_sales</code> column. We can also calculate the percentage change in sales using the formula:</p>
<div class="highlight"><pre><span></span><code>((current_day_sales - previous_day_sales) / previous_day_sales) * 100
</code></pre></div>
<p>Here, we have again shown these calculations using two different methods: using the PySpark API and using the Spark SQL API. Realistically, the results for  both of them can be achieved using either method.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate day-over-day change</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;day_over_day_change&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;previous_day_sales&quot;</span><span class="p">),</span>
        <span class="s2">&quot;pct_change&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;((total_sales - previous_day_sales) / previous_day_sales) * 100&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;pct_change&quot;</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with Day-over-Day Change: </span><span class="si">{</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with Day-over-Day Change: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+----------+-----------+------------------+--------------+-------------------+------------------+
|      date|total_sales|previous_day_sales|next_day_sales|day_over_day_change|        pct_change|
+----------+-----------+------------------+--------------+-------------------+------------------+
|2023-01-01|     490.76|              NULL|        453.94|               NULL|              NULL|
|2023-01-02|     453.94|            490.76|        994.51| -36.81999999999999|-7.502648952644875|
|2023-01-03|     994.51|            453.94|        184.17|  540.5699999999999|119.08401991452612|
|2023-01-04|     184.17|            994.51|         27.89|            -810.34|-81.48133251551015|
|2023-01-05|      27.89|            184.17|        498.95|-156.27999999999997|-84.85638268990606|
+----------+-----------+------------------+--------------+-------------------+------------------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
<th style="text-align: right;">day_over_day_change</th>
<th style="text-align: right;">pct_change</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">-36.82</td>
<td style="text-align: right;">-7.50265</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">540.57</td>
<td style="text-align: right;">119.084</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">-810.34</td>
<td style="text-align: right;">-81.4813</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
<td style="text-align: right;">-156.28</td>
<td style="text-align: right;">-84.8564</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can calculate the day-over-day change in sales by subtracting the <code>previous_day_sales</code> column from the <code>total_sales</code> column. We can also calculate the percentage change in sales using the formula:</p>
<div class="highlight"><pre><span></span><code>((current_day_sales - previous_day_sales) / previous_day_sales) * 100
</code></pre></div>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate day-over-day change</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;previous_day_sales&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;day_over_day_change&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;previous_day_sales&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;pct_change&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with Day-over-Day Change: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with Day-over-Day Change: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 6)
┌────────────┬─────────────┬────────────────────┬────────────────┬─────────────────────┬────────────┐
│ date       ┆ total_sales ┆ previous_day_sales ┆ next_day_sales ┆ day_over_day_change ┆ pct_change │
│ ---        ┆ ---         ┆ ---                ┆ ---            ┆ ---                 ┆ ---        │
│ date       ┆ f64         ┆ f64                ┆ f64            ┆ f64                 ┆ f64        │
╞════════════╪═════════════╪════════════════════╪════════════════╪═════════════════════╪════════════╡
│ 2023-01-01 ┆ 490.76      ┆ null               ┆ 453.94         ┆ null                ┆ null       │
│ 2023-01-02 ┆ 453.94      ┆ 490.76             ┆ 994.51         ┆ -36.82              ┆ -7.502649  │
│ 2023-01-03 ┆ 994.51      ┆ 453.94             ┆ 184.17         ┆ 540.57              ┆ 119.08402  │
│ 2023-01-04 ┆ 184.17      ┆ 994.51             ┆ 27.89          ┆ -810.34             ┆ -81.481333 │
│ 2023-01-05 ┆ 27.89       ┆ 184.17             ┆ 498.95         ┆ -156.28             ┆ -84.856383 │
└────────────┴─────────────┴────────────────────┴────────────────┴─────────────────────┴────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
<th style="text-align: right;">day_over_day_change</th>
<th style="text-align: right;">pct_change</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">-36.82</td>
<td style="text-align: right;">-7.50265</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">540.57</td>
<td style="text-align: right;">119.084</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">-810.34</td>
<td style="text-align: right;">-81.4813</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
<td style="text-align: right;">-156.28</td>
<td style="text-align: right;">-84.8564</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Next, we will calculate the rolling average of sales over a 7-day window. Rolling averages (aka moving averages) are useful for smoothing out short-term fluctuations and highlighting longer-term trends in the data. This is particularly useful in time series analysis, where we want to understand the underlying trend in the data without being overly influenced by short-term variations. It is also a very common technique used in financial analysis to analyze stock prices, sales data, and other time series data.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:4"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><input id="__tabbed_17_3" name="__tabbed_17" type="radio" /><input id="__tabbed_17_4" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">Pandas</label><label for="__tabbed_17_2">SQL</label><label for="__tabbed_17_3">PySpark</label><label for="__tabbed_17_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can calculate the 7-day moving average of sales using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rolling.html"><code>.rolling()</code></a> method. This method allows us to specify a window size (in this case, <code>window=7</code> which is 7 days) and calculate the mean over that window. The <code>min_periods</code> parameter ensures that we get a value even if there are fewer than 7 days of data available at the start of the series. Finally, the <a href="https://pandas.pydata.org/docs/reference/api/pandas.core.window.rolling.Rolling.mean.html"><code>.mean()</code></a> method calculates the average over the specified window.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate 7-day moving average</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;7d_moving_avg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with 7-Day Moving Average: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with 7-Day Moving Average: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>         date  total_sales  previous_day_sales  next_day_sales  day_over_day_change  pct_change  7d_moving_avg
0  2023-01-01       490.76                 NaN          453.94                  NaN         NaN     490.760000
1  2023-01-02       453.94              490.76          994.51               -36.82   -7.502649     472.350000
2  2023-01-03       994.51              453.94          184.17               540.57  119.084020     646.403333
3  2023-01-04       184.17              994.51           27.89              -810.34  -81.481333     530.845000
4  2023-01-05        27.89              184.17          498.95              -156.28  -84.856383     430.254000
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
<th style="text-align: right;">day_over_day_change</th>
<th style="text-align: right;">pct_change</th>
<th style="text-align: right;">7d_moving_avg</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">-36.82</td>
<td style="text-align: right;">-7.50265</td>
<td style="text-align: right;">472.35</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">540.57</td>
<td style="text-align: right;">119.084</td>
<td style="text-align: right;">646.403</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">-810.34</td>
<td style="text-align: right;">-81.4813</td>
<td style="text-align: right;">530.845</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
<td style="text-align: right;">-156.28</td>
<td style="text-align: right;">-84.8564</td>
<td style="text-align: right;">430.254</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can calculate the 7-day moving average of sales using the <code>AVG()</code> window function with the <code>OVER</code> clause. It is important to include this <code>OVER</code> clause, because it is what the SQL engine uses to determine that it should be a Window function, rather than a regular aggregate function (which is specified using the <code>GROUP BY</code> clause).</p>
<p>Here in our example, there are three different parts to the Window function:</p>
<ol>
<li><strong>The <code>ORDER BY</code> clause</strong>: This specifies the order of the rows in the window. In this case, we are ordering by the <code>sale_date</code> column.</li>
<li><strong>The <code>ROWS BETWEEN</code> clause</strong>: This specifies the range of rows to include in the window. In this case, we are including the number of rows from 6 preceding rows to the current row. This means that for each row, the window will include the current row and the 6 rows before it, giving us a total of 7 rows in the window. It is important that you specify the <code>ORDER BY</code> clause before the <code>ROWS BETWEEN</code> clause to ensure that the correct rows are included in the window.</li>
<li><strong>The <code>AVG()</code> function</strong>: This calculates the average of the <code>total_sales</code> column over the specified window.</li>
</ol>
<p>Another peculiarity to note here is around the use of the sub-query. The sub-query is used to first calculate the daily sales, including the previous and next day sales, and the day-over-day change. This is because we need to calculate the moving average over the daily sales, rather than the individual sales transactions. The sub-query allows us to aggregate the sales data by date before calculating the moving average. The only change that we are including in the outer-query is the addition of the moving average calculation.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate 7-day moving average</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">rolling_avg_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        sale_date,</span>
<span class="s2">        total_sales,</span>
<span class="s2">        previous_day_sales,</span>
<span class="s2">        next_day_sales,</span>
<span class="s2">        day_over_day_change,</span>
<span class="s2">        pct_change,</span>
<span class="s2">        AVG(total_sales) OVER (ORDER BY sale_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS &quot;7d_moving_avg&quot;</span>
<span class="s2">    FROM (</span>
<span class="s2">        SELECT</span>
<span class="s2">            date AS sale_date,</span>
<span class="s2">            SUM(sales_amount) AS total_sales,</span>
<span class="s2">            LAG(SUM(sales_amount)) OVER (ORDER BY date) AS previous_day_sales,</span>
<span class="s2">            LEAD(SUM(sales_amount)) OVER (ORDER BY date) AS next_day_sales,</span>
<span class="s2">            SUM(sales_amount) - LAG(SUM(sales_amount)) OVER (ORDER BY date) AS day_over_day_change,</span>
<span class="s2">            (SUM(sales_amount) / NULLIF(LAG(SUM(sales_amount)) OVER (ORDER BY date), 0) - 1) * 100 AS pct_change</span>
<span class="s2">        FROM sales</span>
<span class="s2">        GROUP BY date</span>
<span class="s2">    ) AS daily_sales</span>
<span class="s2">    ORDER BY sale_date</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">window_df_sql</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">rolling_avg_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with 7-Day Moving Average: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">window_df_sql</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">rolling_avg_txt</span> <span class="o">+</span> <span class="s2">&quot; LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">rolling_avg_txt</span> <span class="o">+</span> <span class="s2">&quot; LIMIT 5&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with 7-Day Moving Average: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>             sale_date  total_sales  previous_day_sales  next_day_sales  day_over_day_change  pct_change  7d_moving_avg
0  2023-01-01 00:00:00       490.76                 NaN          453.94                  NaN         NaN     490.760000
1  2023-01-02 00:00:00       453.94              490.76          994.51               -36.82   -7.502649     472.350000
2  2023-01-03 00:00:00       994.51              453.94          184.17               540.57  119.084020     646.403333
3  2023-01-04 00:00:00       184.17              994.51           27.89              -810.34  -81.481333     530.845000
4  2023-01-05 00:00:00        27.89              184.17          498.95              -156.28  -84.856383     430.254000
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">sale_date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
<th style="text-align: right;">day_over_day_change</th>
<th style="text-align: right;">pct_change</th>
<th style="text-align: right;">7d_moving_avg</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">-36.82</td>
<td style="text-align: right;">-7.50265</td>
<td style="text-align: right;">472.35</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">540.57</td>
<td style="text-align: right;">119.084</td>
<td style="text-align: right;">646.403</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">-810.34</td>
<td style="text-align: right;">-81.4813</td>
<td style="text-align: right;">530.845</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
<td style="text-align: right;">-156.28</td>
<td style="text-align: right;">-84.8564</td>
<td style="text-align: right;">430.254</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can calculate the 7-day moving average of sales using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.avg.html"><code>F.avg()</code></a> function in combination with the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.html"><code>Window()</code></a> class. The <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.html"><code>Window()</code></a> class allows us to define a window specification for the calculation. We can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.orderBy.html"><code>.orderBy()</code></a> method to specify the order of the rows in the window, and the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.rowsBetween.html"><code>.rowsBetween()</code></a> method to specify the range of rows to include in the window. The <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.avg.html"><code>F.avg()</code></a> function is then able to calculate the average of the <code>total_sales</code> column over the specified window.</p>
<p>As with many aspects of PySpark, there are multiple ways to achieve the same result. In this case, we can use either the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.avg.html"><code>F.avg()</code></a> function with the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.html"><code>Window()</code></a> class, or we can use the SQL expression syntax with the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.expr.html"><code>F.expr()</code></a> function. Both methods will yield the same result.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate 7-day moving average</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;7d_moving_avg&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">Window</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rowsBetween</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
        <span class="s2">&quot;7d_rolling_avg&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;AVG(total_sales) OVER (ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW)&quot;</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with 7-Day Moving Average: </span><span class="si">{</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with 7-Day Moving Average: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>+----------+-----------+------------------+--------------+-------------------+------------------+-----------------+-----------------+
|      date|total_sales|previous_day_sales|next_day_sales|day_over_day_change|        pct_change|    7d_moving_avg|   7d_rolling_avg|
+----------+-----------+------------------+--------------+-------------------+------------------+-----------------+-----------------+
|2023-01-01|     490.76|              NULL|        453.94|               NULL|              NULL|           490.76|           490.76|
|2023-01-02|     453.94|            490.76|        994.51| -36.81999999999999|-7.502648952644875|           472.35|           472.35|
|2023-01-03|     994.51|            453.94|        184.17|  540.5699999999999|119.08401991452612|646.4033333333333|646.4033333333333|
|2023-01-04|     184.17|            994.51|         27.89|            -810.34|-81.48133251551015|          530.845|          530.845|
|2023-01-05|      27.89|            184.17|        498.95|-156.27999999999997|-84.85638268990606|          430.254|          430.254|
+----------+-----------+------------------+--------------+-------------------+------------------+-----------------+-----------------+
only showing top 5 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
<th style="text-align: right;">day_over_day_change</th>
<th style="text-align: right;">pct_change</th>
<th style="text-align: right;">7d_moving_avg</th>
<th style="text-align: right;">7d_rolling_avg</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">-36.82</td>
<td style="text-align: right;">-7.50265</td>
<td style="text-align: right;">472.35</td>
<td style="text-align: right;">472.35</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">540.57</td>
<td style="text-align: right;">119.084</td>
<td style="text-align: right;">646.403</td>
<td style="text-align: right;">646.403</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">-810.34</td>
<td style="text-align: right;">-81.4813</td>
<td style="text-align: right;">530.845</td>
<td style="text-align: right;">530.845</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
<td style="text-align: right;">-156.28</td>
<td style="text-align: right;">-84.8564</td>
<td style="text-align: right;">430.254</td>
<td style="text-align: right;">430.254</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can calculate the 7-day moving average of sales using the <a href="https://docs.pola.rs/api/python/dev/reference/expressions/api/polars.Expr.rolling_mean.html"><code>.rolling_mean()</code></a> method. This method allows us to specify a window size (in this case, <code>window_size=7</code> which is 7 days) and calculate the mean over that window. The <code>min_samples=1</code> parameter ensures that we get a value even if there are fewer than 7 days of data available at the start of the series.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Calculate 7-day moving average</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">daily_sales_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;total_sales&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling_mean</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;7d_moving_avg&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily Sales with 7-Day Moving Average: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">daily_sales_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Daily Sales with 7-Day Moving Average: 100
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 7)
┌────────────┬─────────────┬────────────────────┬────────────────┬─────────────────────┬────────────┬───────────────┐
│ date       ┆ total_sales ┆ previous_day_sales ┆ next_day_sales ┆ day_over_day_change ┆ pct_change ┆ 7d_moving_avg │
│ ---        ┆ ---         ┆ ---                ┆ ---            ┆ ---                 ┆ ---        ┆ ---           │
│ date       ┆ f64         ┆ f64                ┆ f64            ┆ f64                 ┆ f64        ┆ f64           │
╞════════════╪═════════════╪════════════════════╪════════════════╪═════════════════════╪════════════╪═══════════════╡
│ 2023-01-01 ┆ 490.76      ┆ null               ┆ 453.94         ┆ null                ┆ null       ┆ 490.76        │
│ 2023-01-02 ┆ 453.94      ┆ 490.76             ┆ 994.51         ┆ -36.82              ┆ -7.502649  ┆ 472.35        │
│ 2023-01-03 ┆ 994.51      ┆ 453.94             ┆ 184.17         ┆ 540.57              ┆ 119.08402  ┆ 646.403333    │
│ 2023-01-04 ┆ 184.17      ┆ 994.51             ┆ 27.89          ┆ -810.34             ┆ -81.481333 ┆ 530.845       │
│ 2023-01-05 ┆ 27.89       ┆ 184.17             ┆ 498.95         ┆ -156.28             ┆ -84.856383 ┆ 430.254       │
└────────────┴─────────────┴────────────────────┴────────────────┴─────────────────────┴────────────┴───────────────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">date</th>
<th style="text-align: right;">total_sales</th>
<th style="text-align: right;">previous_day_sales</th>
<th style="text-align: right;">next_day_sales</th>
<th style="text-align: right;">day_over_day_change</th>
<th style="text-align: right;">pct_change</th>
<th style="text-align: right;">7d_moving_avg</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">2023-01-01 00:00:00</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">490.76</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2023-01-02 00:00:00</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">490.76</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">-36.82</td>
<td style="text-align: right;">-7.50265</td>
<td style="text-align: right;">472.35</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2023-01-03 00:00:00</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">453.94</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">540.57</td>
<td style="text-align: right;">119.084</td>
<td style="text-align: right;">646.403</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2023-01-04 00:00:00</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">994.51</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">-810.34</td>
<td style="text-align: right;">-81.4813</td>
<td style="text-align: right;">530.845</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2023-01-05 00:00:00</td>
<td style="text-align: right;">27.89</td>
<td style="text-align: right;">184.17</td>
<td style="text-align: right;">498.95</td>
<td style="text-align: right;">-156.28</td>
<td style="text-align: right;">-84.8564</td>
<td style="text-align: right;">430.254</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Finally, we can visualize the daily sales data along with the 7-day moving average using Plotly. This allows us to see the trends in sales over time and how the moving average smooths out the fluctuations in daily sales.</p>
<p>For this, we will again utilise <a href="https://plotly.com/python/">Plotly</a> to create an interactive line chart that displays both the daily sales and the 7-day moving average. The chart will have the date on the x-axis and the sales amount on the y-axis, with two lines representing the daily sales and the moving average.</p>
<p>The graph will be <a href="https://docs.python.org/3/tutorial/classes.html#:~:text=example%20class%22.-,Class%20instantiation,-uses%20function%20notation">instantiated</a> using the <a href="https://plotly.com/python/creating-and-updating-figures/#figures-as-graph-objects"><code>go.Figure()</code></a> class, and using the <a href="https://plotly.com/python/creating-and-updating-figures/#adding-traces"><code>.add_trace()</code></a> method we will add two traces to the figure: one for the daily sales and one for the 7-day moving average. The <a href="https://plotly.com/python/line-and-scatter/"><code>go.Scatter()</code></a> class is used to create the line traces, by defining <code>mode="lines"</code> to display the data as a line chart.</p>
<p>Finally, we will use the <a href="https://plotly.com/python/reference/layout/"><code>.update_layout()</code></a> method to set the titles for the chart, and the position of the legend.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:4"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><input id="__tabbed_18_3" name="__tabbed_18" type="radio" /><input id="__tabbed_18_4" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">Pandas</label><label for="__tabbed_18_2">SQL</label><label for="__tabbed_18_3">PySpark</label><label for="__tabbed_18_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Plotly is easily able to handle Pandas DataFrames, so we can directly parse the columns from the DataFrame to create the traces for the daily sales and the 7-day moving average.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Plot results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Daily Sales&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">daily_sales_pd</span><span class="p">[</span><span class="s2">&quot;7d_moving_avg&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;7-Day Moving Average&quot;</span><span class="p">,</span>
            <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Daily Sales with 7-Day Moving Average&quot;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Sales Amount ($)&quot;</span><span class="p">,</span>
        <span class="n">legend_orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
        <span class="n">legend_yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="n">legend_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;images/pt4_daily_sales_with_7d_avg_pd.html&quot;</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<p><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="e5171fd2-30a4-48d5-b7e5-1bf4e77e58df" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("e5171fd2-30a4-48d5-b7e5-1bf4e77e58df")) {                    Plotly.newPlot(                        "e5171fd2-30a4-48d5-b7e5-1bf4e77e58df",                        [{"mode":"lines","name":"Daily Sales","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkDXo3A9Cl98QK5H4XoUFI9APQrXo3AFZ0CkcD0K1+M7QDMzMzMzL39AKVyPwvVgZ0DNzMzMzEx3QKRwPQrXVYdApHA9CtedhkBI4XoUrq9zQHsUrkfhGIFApHA9CtcNgED2KFyPwv+DQI\u002fC9ShcH3BA9ihcj8KPgkDNzMzMzJiOQFK4HoXrvX5AuB6F61FYjEDNzMzMzIB7QOF6FK5HSXZAMzMzMzNFhECkcD0K1wGFQArXo3A9DItAXI\u002fC9Si8bUAzMzMzM4N\u002fQArXo3A9AoJAKVyPwvUWiED2KFyPwpVKQHsUrkfhFI9AAAAAAAC0fUBcj8L1KOxxQOF6FK5HpYtAUrgehetxh0C4HoXrUcyNQNejcD0KF3VAUrgehetpgUDD9ShcjwSCQArXo3A9pI5A9ihcj8IlVUAK16NwPYpzQAAAAAAA4GhAcT0K16M8cUB7FK5H4aZ+QI\u002fC9Shcr3dApHA9CtcLeUBcj8L1KG6KQPYoXI\u002fCFY1APQrXo3DtU0DD9ShcjxprQD0K16NwE4VAKVyPwvXQdkBSuB6F61lwQD0K16Nw5XJA4XoUrkeVdEA9CtejcJGKQLgehetRKGJAw\u002fUoXI8+hkC4HoXrUWqBQM3MzMzM+HJA4XoUrkeZekAK16NwPXpwQDMzMzMzO4NAUrgeheuxVkDD9Shcj0IuQClcj8L1vINAw\u002fUoXI9KaUAfhetRuA5UQIXrUbgeLXlA4XoUrkchTkAAAAAAAL6LQOxRuB6Fq0JAcT0K16M4gkA9CtejcMF7QBSuR+F6GoVAUrgehevtdEBI4XoUrm9kQFyPwvUosI5AuB6F61FEikBmZmZmZu6KQAAAAAAAHHBAmpmZmZk5SEBI4XoUrmNzQEjhehSu7YBArkfhehTWdEAfhetRuOyJQOF6FK5HbXFAzczMzMwsjkDXo3A9Cut8QM3MzMzMXIpArkfhehROaUCkcD0K1xN6QFyPwvUo9IVA16NwPQpfYkA9CtejcK1hQB+F61G4To5AmpmZmZlrhkAUrkfhelRJQOF6FK5HTXlA16NwPQpze0A="},"type":"scatter"},{"line":{"width":3},"mode":"lines","name":"7-Day Moving Average","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkCamZmZmYV9QG2g0wY6M4RA9ihcj8KWgEDy0k1iEOR6QKgNdNpAm3tAkiRJkiRVeUDrUbgehUd4QLNa3hjB5HpAHtRBHdR5eEDaBcSm0qR5QCA2lYacR35AJZjo72RpfkDGV3zFVzqBQHiyWt4Yt4BAqIM6qIMIgEDTkHOfXSyBQC8gNpWG9oFAOEYw0d+Rg0DBRH8nqz2DQIr+TlbL+YFAq+WNEUy4g0Do72S1vBGEQF\u002fxFV\u002fxj4NAwUR\u002fJ6ttgkDhehSuR6GAQK\u002f4iq\u002f4PIFAgNhUGnIWg0BFfyer5W2AQD+7gNhU3oFAq+WNEUwggEBcj8L1KFiAQK\u002f4iq\u002f4CoJAAmJTacjRgkA7WS1vjKKDQLdt27Zt54RAjWCiv5PzgkAWX\u002fEVX2eDQJFzn11AgIZAvuIrvuLtgkB9xVd8xfmAQHsUrkfhNntAbSoNOfepekDVQR3UQRF6QI1gor+TTXhAxld8xVcgc0BpyLnPLux5QBsjmOjvcH9AnqyWN0ZgfkBmtbwxgtl9QK5H4XoUfn9AMYKJ\u002fk5ef0C4HoXrUSB+QPBktbwxRnlAE\u002f2drJbnc0B+dgGxqch6QGt5YwQTJXpAtbwxgol6ekBRuB6F6zF8QPYoXI\u002fCkXxAxabSkHOrfUDuswuITRV9QH52AbGp\u002fHpAT1bLGyOAekBVGnLus0d0QJmZmZmZ8XRACtejcD0KdED0d7Ja3vRwQL0xgon+MnJAdwGxqTR8akBvjGCiv1t0QKiDOqiDjnRABsSm0pAfdEBdj8L1KEh2QMZXfMVXmHtAUAd1UAf9ekA3lYac++h7QAh1UAd1wHxA4yu+4iv2gUCY6O9ktTSDQG+MYKK\u002fX4JABRP9nawmf0BN9HeyWu5+QLdt27ZtJ4FAkHOfXUCEfEBAbCoNOWt8QB+F61G4NndAfnYBsamIfUBvjGCiv52AQHVQB3VQ\u002f4JAjGCiv5N7gUAx0d\u002fJatuBQPBktbwxSoFA3hjBRH+zgEAZwUR\u002fJwt6QE30d7Jakn5Ah5z77AJyfUDyFV\u002fxFRd8QB+F61G4+ntA2gXEptKgeUA="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"legend":{"orientation":"h","yanchor":"bottom","y":1},"title":{"text":"Daily Sales with 7-Day Moving Average"},"xaxis":{"title":{"text":"Date"}},"yaxis":{"title":{"text":"Sales Amount ($)"}}},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html></p>
</div>
</div>
<div class="tabbed-block">
<p>Plotly is easily able to handle Pandas DataFrames, so we can directly parse the columns from the DataFrame to create the traces for the daily sales and the 7-day moving average.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Plot results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">window_df_sql</span><span class="p">[</span><span class="s2">&quot;sale_date&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">window_df_sql</span><span class="p">[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Daily Sales&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">window_df_sql</span><span class="p">[</span><span class="s2">&quot;sale_date&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">window_df_sql</span><span class="p">[</span><span class="s2">&quot;7d_moving_avg&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;7-Day Moving Average&quot;</span><span class="p">,</span>
            <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Daily Sales with 7-Day Moving Average&quot;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Sales Amount ($)&quot;</span><span class="p">,</span>
        <span class="n">legend_orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
        <span class="n">legend_yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="n">legend_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;images/pt4_daily_sales_with_7d_avg_sql.html&quot;</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<p><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="1d396b66-686c-46b3-bcba-53f3a85a3f44" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("1d396b66-686c-46b3-bcba-53f3a85a3f44")) {                    Plotly.newPlot(                        "1d396b66-686c-46b3-bcba-53f3a85a3f44",                        [{"mode":"lines","name":"Daily Sales","x":["2023-01-01 00:00:00","2023-01-02 00:00:00","2023-01-03 00:00:00","2023-01-04 00:00:00","2023-01-05 00:00:00","2023-01-06 00:00:00","2023-01-07 00:00:00","2023-01-08 00:00:00","2023-01-09 00:00:00","2023-01-10 00:00:00","2023-01-11 00:00:00","2023-01-12 00:00:00","2023-01-13 00:00:00","2023-01-14 00:00:00","2023-01-15 00:00:00","2023-01-16 00:00:00","2023-01-17 00:00:00","2023-01-18 00:00:00","2023-01-19 00:00:00","2023-01-20 00:00:00","2023-01-21 00:00:00","2023-01-22 00:00:00","2023-01-23 00:00:00","2023-01-24 00:00:00","2023-01-25 00:00:00","2023-01-26 00:00:00","2023-01-27 00:00:00","2023-01-28 00:00:00","2023-01-29 00:00:00","2023-01-30 00:00:00","2023-01-31 00:00:00","2023-02-01 00:00:00","2023-02-02 00:00:00","2023-02-03 00:00:00","2023-02-04 00:00:00","2023-02-05 00:00:00","2023-02-06 00:00:00","2023-02-07 00:00:00","2023-02-08 00:00:00","2023-02-09 00:00:00","2023-02-10 00:00:00","2023-02-11 00:00:00","2023-02-12 00:00:00","2023-02-13 00:00:00","2023-02-14 00:00:00","2023-02-15 00:00:00","2023-02-16 00:00:00","2023-02-17 00:00:00","2023-02-18 00:00:00","2023-02-19 00:00:00","2023-02-20 00:00:00","2023-02-21 00:00:00","2023-02-22 00:00:00","2023-02-23 00:00:00","2023-02-24 00:00:00","2023-02-25 00:00:00","2023-02-26 00:00:00","2023-02-27 00:00:00","2023-02-28 00:00:00","2023-03-01 00:00:00","2023-03-02 00:00:00","2023-03-03 00:00:00","2023-03-04 00:00:00","2023-03-05 00:00:00","2023-03-06 00:00:00","2023-03-07 00:00:00","2023-03-08 00:00:00","2023-03-09 00:00:00","2023-03-10 00:00:00","2023-03-11 00:00:00","2023-03-12 00:00:00","2023-03-13 00:00:00","2023-03-14 00:00:00","2023-03-15 00:00:00","2023-03-16 00:00:00","2023-03-17 00:00:00","2023-03-18 00:00:00","2023-03-19 00:00:00","2023-03-20 00:00:00","2023-03-21 00:00:00","2023-03-22 00:00:00","2023-03-23 00:00:00","2023-03-24 00:00:00","2023-03-25 00:00:00","2023-03-26 00:00:00","2023-03-27 00:00:00","2023-03-28 00:00:00","2023-03-29 00:00:00","2023-03-30 00:00:00","2023-03-31 00:00:00","2023-04-01 00:00:00","2023-04-02 00:00:00","2023-04-03 00:00:00","2023-04-04 00:00:00","2023-04-05 00:00:00","2023-04-06 00:00:00","2023-04-07 00:00:00","2023-04-08 00:00:00","2023-04-09 00:00:00","2023-04-10 00:00:00"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkDXo3A9Cl98QK5H4XoUFI9APQrXo3AFZ0CkcD0K1+M7QDMzMzMzL39AKVyPwvVgZ0DNzMzMzEx3QKRwPQrXVYdApHA9CtedhkBI4XoUrq9zQHsUrkfhGIFApHA9CtcNgED2KFyPwv+DQI\u002fC9ShcH3BA9ihcj8KPgkDNzMzMzJiOQFK4HoXrvX5AuB6F61FYjEDNzMzMzIB7QOF6FK5HSXZAMzMzMzNFhECkcD0K1wGFQArXo3A9DItAXI\u002fC9Si8bUAzMzMzM4N\u002fQArXo3A9AoJAKVyPwvUWiED2KFyPwpVKQHsUrkfhFI9AAAAAAAC0fUBcj8L1KOxxQOF6FK5HpYtAUrgehetxh0C4HoXrUcyNQNejcD0KF3VAUrgehetpgUDD9ShcjwSCQArXo3A9pI5A9ihcj8IlVUAK16NwPYpzQAAAAAAA4GhAcT0K16M8cUB7FK5H4aZ+QI\u002fC9Shcr3dApHA9CtcLeUBcj8L1KG6KQPYoXI\u002fCFY1APQrXo3DtU0DD9ShcjxprQD0K16NwE4VAKVyPwvXQdkBSuB6F61lwQD0K16Nw5XJA4XoUrkeVdEA9CtejcJGKQLgehetRKGJAw\u002fUoXI8+hkC4HoXrUWqBQM3MzMzM+HJA4XoUrkeZekAK16NwPXpwQDMzMzMzO4NAUrgeheuxVkDD9Shcj0IuQClcj8L1vINAw\u002fUoXI9KaUAfhetRuA5UQIXrUbgeLXlA4XoUrkchTkAAAAAAAL6LQOxRuB6Fq0JAcT0K16M4gkA9CtejcMF7QBSuR+F6GoVAUrgehevtdEBI4XoUrm9kQFyPwvUosI5AuB6F61FEikBmZmZmZu6KQAAAAAAAHHBAmpmZmZk5SEBI4XoUrmNzQEjhehSu7YBArkfhehTWdEAfhetRuOyJQOF6FK5HbXFAzczMzMwsjkDXo3A9Cut8QM3MzMzMXIpArkfhehROaUCkcD0K1xN6QFyPwvUo9IVA16NwPQpfYkA9CtejcK1hQB+F61G4To5AmpmZmZlrhkAUrkfhelRJQOF6FK5HTXlA16NwPQpze0A="},"type":"scatter"},{"line":{"width":3},"mode":"lines","name":"7-Day Moving Average","x":["2023-01-01 00:00:00","2023-01-02 00:00:00","2023-01-03 00:00:00","2023-01-04 00:00:00","2023-01-05 00:00:00","2023-01-06 00:00:00","2023-01-07 00:00:00","2023-01-08 00:00:00","2023-01-09 00:00:00","2023-01-10 00:00:00","2023-01-11 00:00:00","2023-01-12 00:00:00","2023-01-13 00:00:00","2023-01-14 00:00:00","2023-01-15 00:00:00","2023-01-16 00:00:00","2023-01-17 00:00:00","2023-01-18 00:00:00","2023-01-19 00:00:00","2023-01-20 00:00:00","2023-01-21 00:00:00","2023-01-22 00:00:00","2023-01-23 00:00:00","2023-01-24 00:00:00","2023-01-25 00:00:00","2023-01-26 00:00:00","2023-01-27 00:00:00","2023-01-28 00:00:00","2023-01-29 00:00:00","2023-01-30 00:00:00","2023-01-31 00:00:00","2023-02-01 00:00:00","2023-02-02 00:00:00","2023-02-03 00:00:00","2023-02-04 00:00:00","2023-02-05 00:00:00","2023-02-06 00:00:00","2023-02-07 00:00:00","2023-02-08 00:00:00","2023-02-09 00:00:00","2023-02-10 00:00:00","2023-02-11 00:00:00","2023-02-12 00:00:00","2023-02-13 00:00:00","2023-02-14 00:00:00","2023-02-15 00:00:00","2023-02-16 00:00:00","2023-02-17 00:00:00","2023-02-18 00:00:00","2023-02-19 00:00:00","2023-02-20 00:00:00","2023-02-21 00:00:00","2023-02-22 00:00:00","2023-02-23 00:00:00","2023-02-24 00:00:00","2023-02-25 00:00:00","2023-02-26 00:00:00","2023-02-27 00:00:00","2023-02-28 00:00:00","2023-03-01 00:00:00","2023-03-02 00:00:00","2023-03-03 00:00:00","2023-03-04 00:00:00","2023-03-05 00:00:00","2023-03-06 00:00:00","2023-03-07 00:00:00","2023-03-08 00:00:00","2023-03-09 00:00:00","2023-03-10 00:00:00","2023-03-11 00:00:00","2023-03-12 00:00:00","2023-03-13 00:00:00","2023-03-14 00:00:00","2023-03-15 00:00:00","2023-03-16 00:00:00","2023-03-17 00:00:00","2023-03-18 00:00:00","2023-03-19 00:00:00","2023-03-20 00:00:00","2023-03-21 00:00:00","2023-03-22 00:00:00","2023-03-23 00:00:00","2023-03-24 00:00:00","2023-03-25 00:00:00","2023-03-26 00:00:00","2023-03-27 00:00:00","2023-03-28 00:00:00","2023-03-29 00:00:00","2023-03-30 00:00:00","2023-03-31 00:00:00","2023-04-01 00:00:00","2023-04-02 00:00:00","2023-04-03 00:00:00","2023-04-04 00:00:00","2023-04-05 00:00:00","2023-04-06 00:00:00","2023-04-07 00:00:00","2023-04-08 00:00:00","2023-04-09 00:00:00","2023-04-10 00:00:00"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkCamZmZmYV9QG2g0wY6M4RA9ihcj8KWgEDy0k1iEOR6QKcNdNpAm3tAkiRJkiRVeUDrUbgehUd4QLJa3hjB5HpAHtRBHdR5eEDaBcSm0qR5QCA2lYacR35AI5jo72RpfkDGV3zFVzqBQHiyWt4Yt4BAqYM6qIMIgEDTkHOfXSyBQC8gNpWG9oFAOEYw0d+Rg0DBRH8nqz2DQIr+TlbL+YFAq+WNEUy4g0Dp72S1vBGEQF\u002fxFV\u002fxj4NAwUR\u002fJ6ttgkDhehSuR6GAQK\u002f4iq\u002f4PIFAgdhUGnIWg0BFfyer5W2AQD+7gNhU3oFAq+WNEUwggEBcj8L1KFiAQK\u002f4iq\u002f4CoJAA2JTacjRgkA7WS1vjKKDQLdt27Zt54RAjWCiv5PzgkAWX\u002fEVX2eDQJFzn11AgIZAvuIrvuLtgkB9xVd8xfmAQHsUrkfhNntAbSoNOfepekDVQR3UQRF6QI1gor+TTXhAxld8xVcgc0BpyLnPLux5QBsjmOjvcH9AnqyWN0ZgfkBltbwxgtl9QK5H4XoUfn9AMYKJ\u002fk5ef0C4HoXrUSB+QPBktbwxRnlAEv2drJbnc0B+dgGxqch6QGp5YwQTJXpAtrwxgol6ekBSuB6F6zF8QPYoXI\u002fCkXxAw6bSkHOrfUDuswuITRV9QH52AbGp\u002fHpAT1bLGyOAekBVGnLus0d0QJmZmZmZ8XRACtejcD0KdED0d7Ja3vRwQL0xgon+MnJAdwGxqTR8akBvjGCiv1t0QKiDOqiDjnRABsSm0pAfdEBdj8L1KEh2QMZXfMVXmHtAUAd1UAf9ekA2lYac++h7QAd1UAd1wHxA4yu+4iv2gUCY6O9ktTSDQG+MYKK\u002fX4JABRP9nawmf0BL9HeyWu5+QLdt27ZtJ4FAkXOfXUCEfEBAbCoNOWt8QB+F61G4NndAfnYBsamIfUBvjGCiv52AQHVQB3VQ\u002f4JAjWCiv5N7gUAx0d\u002fJatuBQPBktbwxSoFA3hjBRH+zgEAZwUR\u002fJwt6QE30d7Jakn5Ah5z77AJyfUDxFV\u002fxFRd8QB+F61G4+ntA2gXEptKgeUA="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"legend":{"orientation":"h","yanchor":"bottom","y":1},"title":{"text":"Daily Sales with 7-Day Moving Average"},"xaxis":{"title":{"text":"Date"}},"yaxis":{"title":{"text":"Sales Amount ($)"}}},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html></p>
</div>
</div>
<div class="tabbed-block">
<p>Plotly is not able to interpret PySpark DataFrames directly, so we need to convert the PySpark DataFrame to a Pandas DataFrame before plotting. This can be done using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.toPandas.html"><code>.toPandas()</code></a> method. We can then parse the columns from the Pandas DataFrame to create the traces for the daily sales and the 7-day moving average.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Plot results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Daily Sales&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">daily_sales_ps</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()[</span><span class="s2">&quot;7d_moving_avg&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;7-Day Moving Average&quot;</span><span class="p">,</span>
            <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Daily Sales with 7-Day Moving Average&quot;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Sales Amount ($)&quot;</span><span class="p">,</span>
        <span class="n">legend_orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
        <span class="n">legend_yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="n">legend_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;images/pt4_daily_sales_with_7d_avg_ps.html&quot;</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<p><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="900a3187-77f3-4ecc-99c2-8ad57eb077fa" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("900a3187-77f3-4ecc-99c2-8ad57eb077fa")) {                    Plotly.newPlot(                        "900a3187-77f3-4ecc-99c2-8ad57eb077fa",                        [{"mode":"lines","name":"Daily Sales","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkDXo3A9Cl98QK5H4XoUFI9APQrXo3AFZ0CkcD0K1+M7QDMzMzMzL39AKVyPwvVgZ0DNzMzMzEx3QKRwPQrXVYdApHA9CtedhkBI4XoUrq9zQHsUrkfhGIFApHA9CtcNgED2KFyPwv+DQI\u002fC9ShcH3BA9ihcj8KPgkDNzMzMzJiOQFK4HoXrvX5AuB6F61FYjEDNzMzMzIB7QOF6FK5HSXZAMzMzMzNFhECkcD0K1wGFQArXo3A9DItAXI\u002fC9Si8bUAzMzMzM4N\u002fQArXo3A9AoJAKVyPwvUWiED2KFyPwpVKQHsUrkfhFI9AAAAAAAC0fUBcj8L1KOxxQOF6FK5HpYtAUrgehetxh0C4HoXrUcyNQNejcD0KF3VAUrgehetpgUDD9ShcjwSCQArXo3A9pI5A9ihcj8IlVUAK16NwPYpzQAAAAAAA4GhAcT0K16M8cUB7FK5H4aZ+QI\u002fC9Shcr3dApHA9CtcLeUBcj8L1KG6KQPYoXI\u002fCFY1APQrXo3DtU0DD9ShcjxprQD0K16NwE4VAKVyPwvXQdkBSuB6F61lwQD0K16Nw5XJA4XoUrkeVdEA9CtejcJGKQLgehetRKGJAw\u002fUoXI8+hkC4HoXrUWqBQM3MzMzM+HJA4XoUrkeZekAK16NwPXpwQDMzMzMzO4NAUrgeheuxVkDD9Shcj0IuQClcj8L1vINAw\u002fUoXI9KaUAfhetRuA5UQIXrUbgeLXlA4XoUrkchTkAAAAAAAL6LQOxRuB6Fq0JAcT0K16M4gkA9CtejcMF7QBSuR+F6GoVAUrgehevtdEBI4XoUrm9kQFyPwvUosI5AuB6F61FEikBmZmZmZu6KQAAAAAAAHHBAmpmZmZk5SEBI4XoUrmNzQEjhehSu7YBArkfhehTWdEAfhetRuOyJQOF6FK5HbXFAzczMzMwsjkDXo3A9Cut8QM3MzMzMXIpArkfhehROaUCkcD0K1xN6QFyPwvUo9IVA16NwPQpfYkA9CtejcK1hQB+F61G4To5AmpmZmZlrhkAUrkfhelRJQOF6FK5HTXlA16NwPQpze0A="},"type":"scatter"},{"line":{"width":3},"mode":"lines","name":"7-Day Moving Average","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkCamZmZmYV9QG2g0wY6M4RA9ihcj8KWgEDy0k1iEOR6QKcNdNpAm3tAkiRJkiRVeUDtUbgehUd4QLNa3hjB5HpAHtRBHdR5eEDaBcSm0qR5QCA2lYacR35AI5jo72RpfkDGV3zFVzqBQHiyWt4Yt4BAqYM6qIMIgEDTkHOfXSyBQC8gNpWG9oFAN0Yw0d+Rg0DBRH8nqz2DQIr+TlbL+YFAq+WNEUy4g0Dp72S1vBGEQF\u002fxFV\u002fxj4NAwUR\u002fJ6ttgkDhehSuR6GAQK\u002f4iq\u002f4PIFAgNhUGnIWg0BFfyer5W2AQD+7gNhU3oFAq+WNEUwggEBdj8L1KFiAQLD4iq\u002f4CoJAAmJTacjRgkA7WS1vjKKDQLdt27Zt54RAjWCiv5PzgkAWX\u002fEVX2eDQJFzn11AgIZAv+IrvuLtgkB8xVd8xfmAQHoUrkfhNntAbSoNOfepekDTQR3UQRF6QItgor+TTXhAxld8xVcgc0BqyLnPLux5QBsjmOjvcH9AnqyWN0ZgfkBltbwxgtl9QK5H4XoUfn9AMYKJ\u002fk5ef0C4HoXrUSB+QPBktbwxRnlAE\u002f2drJbnc0B+dgGxqch6QGt5YwQTJXpAtrwxgol6ekBRuB6F6zF8QPYoXI\u002fCkXxAxabSkHOrfUDvswuITRV9QH52AbGp\u002fHpAUFbLGyOAekBWGnLus0d0QJqZmZmZ8XRACtejcD0KdED0d7Ja3vRwQLwxgon+MnJAdwGxqTR8akBwjGCiv1t0QKmDOqiDjnRABsSm0pAfdEBdj8L1KEh2QMZXfMVXmHtAUAd1UAf9ekA1lYac++h7QAh1UAd1wHxA4yu+4iv2gUCY6O9ktTSDQG+MYKK\u002fX4JABRP9nawmf0BL9HeyWu5+QLZt27ZtJ4FAkXOfXUCEfEBBbCoNOWt8QB+F61G4NndAfnYBsamIfUBvjGCiv52AQHZQB3VQ\u002f4JAjWCiv5N7gUAw0d\u002fJatuBQPFktbwxSoFA3hjBRH+zgEAYwUR\u002fJwt6QE30d7Jakn5Ah5z77AJyfUDyFV\u002fxFRd8QB6F61G4+ntA2gXEptKgeUA="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"legend":{"orientation":"h","yanchor":"bottom","y":1},"title":{"text":"Daily Sales with 7-Day Moving Average"},"xaxis":{"title":{"text":"Date"}},"yaxis":{"title":{"text":"Sales Amount ($)"}}},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html></p>
</div>
</div>
<div class="tabbed-block">
<p>Plotly is easily able to handle Polars DataFrames, so we can directly parse the columns from the DataFrame to create the traces for the daily sales and the 7-day moving average.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Plot results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">fig</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">daily_sales_pl</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">daily_sales_pl</span><span class="p">[</span><span class="s2">&quot;total_sales&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Daily Sales&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">daily_sales_pl</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">daily_sales_pl</span><span class="p">[</span><span class="s2">&quot;7d_moving_avg&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;7-Day Moving Average&quot;</span><span class="p">,</span>
            <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Daily Sales with 7-Day Moving Average&quot;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Sales Amount ($)&quot;</span><span class="p">,</span>
        <span class="n">legend_orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
        <span class="n">legend_yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="n">legend_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;images/pt4_daily_sales_with_7d_avg_pl.html&quot;</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<p><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="4b368d72-6cc8-4a34-bd57-a09ebf5d34a2" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("4b368d72-6cc8-4a34-bd57-a09ebf5d34a2")) {                    Plotly.newPlot(                        "4b368d72-6cc8-4a34-bd57-a09ebf5d34a2",                        [{"mode":"lines","name":"Daily Sales","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkDXo3A9Cl98QK5H4XoUFI9APQrXo3AFZ0CkcD0K1+M7QDMzMzMzL39AKVyPwvVgZ0DNzMzMzEx3QKRwPQrXVYdApHA9CtedhkBI4XoUrq9zQHsUrkfhGIFApHA9CtcNgED2KFyPwv+DQI\u002fC9ShcH3BA9ihcj8KPgkDNzMzMzJiOQFK4HoXrvX5AuB6F61FYjEDNzMzMzIB7QOF6FK5HSXZAMzMzMzNFhECkcD0K1wGFQArXo3A9DItAXI\u002fC9Si8bUAzMzMzM4N\u002fQArXo3A9AoJAKVyPwvUWiED2KFyPwpVKQHsUrkfhFI9AAAAAAAC0fUBcj8L1KOxxQOF6FK5HpYtAUrgehetxh0C4HoXrUcyNQNejcD0KF3VAUrgehetpgUDD9ShcjwSCQArXo3A9pI5A9ihcj8IlVUAK16NwPYpzQAAAAAAA4GhAcT0K16M8cUB7FK5H4aZ+QI\u002fC9Shcr3dApHA9CtcLeUBcj8L1KG6KQPYoXI\u002fCFY1APQrXo3DtU0DD9ShcjxprQD0K16NwE4VAKVyPwvXQdkBSuB6F61lwQD0K16Nw5XJA4XoUrkeVdEA9CtejcJGKQLgehetRKGJAw\u002fUoXI8+hkC4HoXrUWqBQM3MzMzM+HJA4XoUrkeZekAK16NwPXpwQDMzMzMzO4NAUrgeheuxVkDD9Shcj0IuQClcj8L1vINAw\u002fUoXI9KaUAfhetRuA5UQIXrUbgeLXlA4XoUrkchTkAAAAAAAL6LQOxRuB6Fq0JAcT0K16M4gkA9CtejcMF7QBSuR+F6GoVAUrgehevtdEBI4XoUrm9kQFyPwvUosI5AuB6F61FEikBmZmZmZu6KQAAAAAAAHHBAmpmZmZk5SEBI4XoUrmNzQEjhehSu7YBArkfhehTWdEAfhetRuOyJQOF6FK5HbXFAzczMzMwsjkDXo3A9Cut8QM3MzMzMXIpArkfhehROaUCkcD0K1xN6QFyPwvUo9IVA16NwPQpfYkA9CtejcK1hQB+F61G4To5AmpmZmZlrhkAUrkfhelRJQOF6FK5HTXlA16NwPQpze0A="},"type":"scatter"},{"line":{"width":3},"mode":"lines","name":"7-Day Moving Average","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkCamZmZmYV9QG2g0wY6M4RA9ihcj8KWgEDy0k1iEOR6QKgNdNpAm3tAkiRJkiRVeUDrUbgehUd4QLJa3hjB5HpAHtRBHdR5eEDaBcSm0qR5QCA2lYacR35AI5jo72RpfkDGV3zFVzqBQHiyWt4Yt4BAqYM6qIMIgEDTkHOfXSyBQC8gNpWG9oFAOEYw0d+Rg0DBRH8nqz2DQIr+TlbL+YFAq+WNEUy4g0Dp72S1vBGEQF\u002fxFV\u002fxj4NAwUR\u002fJ6ttgkDhehSuR6GAQK\u002f4iq\u002f4PIFAgNhUGnIWg0BFfyer5W2AQD+7gNhU3oFAq+WNEUwggEBcj8L1KFiAQK\u002f4iq\u002f4CoJAAmJTacjRgkA7WS1vjKKDQLdt27Zt54RAjWCiv5PzgkAWX\u002fEVX2eDQJFzn11AgIZAvuIrvuLtgkB9xVd8xfmAQHsUrkfhNntAbSoNOfepekDVQR3UQRF6QI1gor+TTXhAxld8xVcgc0BpyLnPLux5QBsjmOjvcH9AnqyWN0ZgfkBltbwxgtl9QK5H4XoUfn9AMoKJ\u002fk5ef0C4HoXrUSB+QPBktbwxRnlAE\u002f2drJbnc0B+dgGxqch6QGp5YwQTJXpAtrwxgol6ekBSuB6F6zF8QPYoXI\u002fCkXxAw6bSkHOrfUDuswuITRV9QH52AbGp\u002fHpAT1bLGyOAekBVGnLus0d0QJmZmZmZ8XRACtejcD0KdED0d7Ja3vRwQL0xgon+MnJAdwGxqTR8akBwjGCiv1t0QKiDOqiDjnRAB8Sm0pAfdEBdj8L1KEh2QMZXfMVXmHtAUQd1UAf9ekA3lYac++h7QAd1UAd1wHxA4yu+4iv2gUCY6O9ktTSDQG+MYKK\u002fX4JABRP9nawmf0BN9HeyWu5+QLdt27ZtJ4FAkXOfXUCEfEBAbCoNOWt8QB+F61G4NndAfnYBsamIfUBvjGCiv52AQHZQB3VQ\u002f4JAjWCiv5N7gUAx0d\u002fJatuBQPBktbwxSoFA3hjBRH+zgEAZwUR\u002fJwt6QE30d7Jakn5Ah5z77AJyfUDxFV\u002fxFRd8QB+F61G4+ntA2gXEptKgeUA="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"legend":{"orientation":"h","yanchor":"bottom","y":1},"title":{"text":"Daily Sales with 7-Day Moving Average"},"xaxis":{"title":{"text":"Date"}},"yaxis":{"title":{"text":"Sales Amount ($)"}}},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html></p>
</div>
</div>
</div>
</div>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="e5171fd2-30a4-48d5-b7e5-1bf4e77e58df" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("e5171fd2-30a4-48d5-b7e5-1bf4e77e58df")) {                    Plotly.newPlot(                        "e5171fd2-30a4-48d5-b7e5-1bf4e77e58df",                        [{"mode":"lines","name":"Daily Sales","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkDXo3A9Cl98QK5H4XoUFI9APQrXo3AFZ0CkcD0K1+M7QDMzMzMzL39AKVyPwvVgZ0DNzMzMzEx3QKRwPQrXVYdApHA9CtedhkBI4XoUrq9zQHsUrkfhGIFApHA9CtcNgED2KFyPwv+DQI\u002fC9ShcH3BA9ihcj8KPgkDNzMzMzJiOQFK4HoXrvX5AuB6F61FYjEDNzMzMzIB7QOF6FK5HSXZAMzMzMzNFhECkcD0K1wGFQArXo3A9DItAXI\u002fC9Si8bUAzMzMzM4N\u002fQArXo3A9AoJAKVyPwvUWiED2KFyPwpVKQHsUrkfhFI9AAAAAAAC0fUBcj8L1KOxxQOF6FK5HpYtAUrgehetxh0C4HoXrUcyNQNejcD0KF3VAUrgehetpgUDD9ShcjwSCQArXo3A9pI5A9ihcj8IlVUAK16NwPYpzQAAAAAAA4GhAcT0K16M8cUB7FK5H4aZ+QI\u002fC9Shcr3dApHA9CtcLeUBcj8L1KG6KQPYoXI\u002fCFY1APQrXo3DtU0DD9ShcjxprQD0K16NwE4VAKVyPwvXQdkBSuB6F61lwQD0K16Nw5XJA4XoUrkeVdEA9CtejcJGKQLgehetRKGJAw\u002fUoXI8+hkC4HoXrUWqBQM3MzMzM+HJA4XoUrkeZekAK16NwPXpwQDMzMzMzO4NAUrgeheuxVkDD9Shcj0IuQClcj8L1vINAw\u002fUoXI9KaUAfhetRuA5UQIXrUbgeLXlA4XoUrkchTkAAAAAAAL6LQOxRuB6Fq0JAcT0K16M4gkA9CtejcMF7QBSuR+F6GoVAUrgehevtdEBI4XoUrm9kQFyPwvUosI5AuB6F61FEikBmZmZmZu6KQAAAAAAAHHBAmpmZmZk5SEBI4XoUrmNzQEjhehSu7YBArkfhehTWdEAfhetRuOyJQOF6FK5HbXFAzczMzMwsjkDXo3A9Cut8QM3MzMzMXIpArkfhehROaUCkcD0K1xN6QFyPwvUo9IVA16NwPQpfYkA9CtejcK1hQB+F61G4To5AmpmZmZlrhkAUrkfhelRJQOF6FK5HTXlA16NwPQpze0A="},"type":"scatter"},{"line":{"width":3},"mode":"lines","name":"7-Day Moving Average","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkCamZmZmYV9QG2g0wY6M4RA9ihcj8KWgEDy0k1iEOR6QKgNdNpAm3tAkiRJkiRVeUDrUbgehUd4QLNa3hjB5HpAHtRBHdR5eEDaBcSm0qR5QCA2lYacR35AJZjo72RpfkDGV3zFVzqBQHiyWt4Yt4BAqIM6qIMIgEDTkHOfXSyBQC8gNpWG9oFAOEYw0d+Rg0DBRH8nqz2DQIr+TlbL+YFAq+WNEUy4g0Do72S1vBGEQF\u002fxFV\u002fxj4NAwUR\u002fJ6ttgkDhehSuR6GAQK\u002f4iq\u002f4PIFAgNhUGnIWg0BFfyer5W2AQD+7gNhU3oFAq+WNEUwggEBcj8L1KFiAQK\u002f4iq\u002f4CoJAAmJTacjRgkA7WS1vjKKDQLdt27Zt54RAjWCiv5PzgkAWX\u002fEVX2eDQJFzn11AgIZAvuIrvuLtgkB9xVd8xfmAQHsUrkfhNntAbSoNOfepekDVQR3UQRF6QI1gor+TTXhAxld8xVcgc0BpyLnPLux5QBsjmOjvcH9AnqyWN0ZgfkBmtbwxgtl9QK5H4XoUfn9AMYKJ\u002fk5ef0C4HoXrUSB+QPBktbwxRnlAE\u002f2drJbnc0B+dgGxqch6QGt5YwQTJXpAtbwxgol6ekBRuB6F6zF8QPYoXI\u002fCkXxAxabSkHOrfUDuswuITRV9QH52AbGp\u002fHpAT1bLGyOAekBVGnLus0d0QJmZmZmZ8XRACtejcD0KdED0d7Ja3vRwQL0xgon+MnJAdwGxqTR8akBvjGCiv1t0QKiDOqiDjnRABsSm0pAfdEBdj8L1KEh2QMZXfMVXmHtAUAd1UAf9ekA3lYac++h7QAh1UAd1wHxA4yu+4iv2gUCY6O9ktTSDQG+MYKK\u002fX4JABRP9nawmf0BN9HeyWu5+QLdt27ZtJ4FAkHOfXUCEfEBAbCoNOWt8QB+F61G4NndAfnYBsamIfUBvjGCiv52AQHVQB3VQ\u002f4JAjGCiv5N7gUAx0d\u002fJatuBQPBktbwxSoFA3hjBRH+zgEAZwUR\u002fJwt6QE30d7Jakn5Ah5z77AJyfUDyFV\u002fxFRd8QB+F61G4+ntA2gXEptKgeUA="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"legend":{"orientation":"h","yanchor":"bottom","y":1},"title":{"text":"Daily Sales with 7-Day Moving Average"},"xaxis":{"title":{"text":"Date"}},"yaxis":{"title":{"text":"Sales Amount ($)"}}},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html>

<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="1d396b66-686c-46b3-bcba-53f3a85a3f44" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("1d396b66-686c-46b3-bcba-53f3a85a3f44")) {                    Plotly.newPlot(                        "1d396b66-686c-46b3-bcba-53f3a85a3f44",                        [{"mode":"lines","name":"Daily Sales","x":["2023-01-01 00:00:00","2023-01-02 00:00:00","2023-01-03 00:00:00","2023-01-04 00:00:00","2023-01-05 00:00:00","2023-01-06 00:00:00","2023-01-07 00:00:00","2023-01-08 00:00:00","2023-01-09 00:00:00","2023-01-10 00:00:00","2023-01-11 00:00:00","2023-01-12 00:00:00","2023-01-13 00:00:00","2023-01-14 00:00:00","2023-01-15 00:00:00","2023-01-16 00:00:00","2023-01-17 00:00:00","2023-01-18 00:00:00","2023-01-19 00:00:00","2023-01-20 00:00:00","2023-01-21 00:00:00","2023-01-22 00:00:00","2023-01-23 00:00:00","2023-01-24 00:00:00","2023-01-25 00:00:00","2023-01-26 00:00:00","2023-01-27 00:00:00","2023-01-28 00:00:00","2023-01-29 00:00:00","2023-01-30 00:00:00","2023-01-31 00:00:00","2023-02-01 00:00:00","2023-02-02 00:00:00","2023-02-03 00:00:00","2023-02-04 00:00:00","2023-02-05 00:00:00","2023-02-06 00:00:00","2023-02-07 00:00:00","2023-02-08 00:00:00","2023-02-09 00:00:00","2023-02-10 00:00:00","2023-02-11 00:00:00","2023-02-12 00:00:00","2023-02-13 00:00:00","2023-02-14 00:00:00","2023-02-15 00:00:00","2023-02-16 00:00:00","2023-02-17 00:00:00","2023-02-18 00:00:00","2023-02-19 00:00:00","2023-02-20 00:00:00","2023-02-21 00:00:00","2023-02-22 00:00:00","2023-02-23 00:00:00","2023-02-24 00:00:00","2023-02-25 00:00:00","2023-02-26 00:00:00","2023-02-27 00:00:00","2023-02-28 00:00:00","2023-03-01 00:00:00","2023-03-02 00:00:00","2023-03-03 00:00:00","2023-03-04 00:00:00","2023-03-05 00:00:00","2023-03-06 00:00:00","2023-03-07 00:00:00","2023-03-08 00:00:00","2023-03-09 00:00:00","2023-03-10 00:00:00","2023-03-11 00:00:00","2023-03-12 00:00:00","2023-03-13 00:00:00","2023-03-14 00:00:00","2023-03-15 00:00:00","2023-03-16 00:00:00","2023-03-17 00:00:00","2023-03-18 00:00:00","2023-03-19 00:00:00","2023-03-20 00:00:00","2023-03-21 00:00:00","2023-03-22 00:00:00","2023-03-23 00:00:00","2023-03-24 00:00:00","2023-03-25 00:00:00","2023-03-26 00:00:00","2023-03-27 00:00:00","2023-03-28 00:00:00","2023-03-29 00:00:00","2023-03-30 00:00:00","2023-03-31 00:00:00","2023-04-01 00:00:00","2023-04-02 00:00:00","2023-04-03 00:00:00","2023-04-04 00:00:00","2023-04-05 00:00:00","2023-04-06 00:00:00","2023-04-07 00:00:00","2023-04-08 00:00:00","2023-04-09 00:00:00","2023-04-10 00:00:00"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkDXo3A9Cl98QK5H4XoUFI9APQrXo3AFZ0CkcD0K1+M7QDMzMzMzL39AKVyPwvVgZ0DNzMzMzEx3QKRwPQrXVYdApHA9CtedhkBI4XoUrq9zQHsUrkfhGIFApHA9CtcNgED2KFyPwv+DQI\u002fC9ShcH3BA9ihcj8KPgkDNzMzMzJiOQFK4HoXrvX5AuB6F61FYjEDNzMzMzIB7QOF6FK5HSXZAMzMzMzNFhECkcD0K1wGFQArXo3A9DItAXI\u002fC9Si8bUAzMzMzM4N\u002fQArXo3A9AoJAKVyPwvUWiED2KFyPwpVKQHsUrkfhFI9AAAAAAAC0fUBcj8L1KOxxQOF6FK5HpYtAUrgehetxh0C4HoXrUcyNQNejcD0KF3VAUrgehetpgUDD9ShcjwSCQArXo3A9pI5A9ihcj8IlVUAK16NwPYpzQAAAAAAA4GhAcT0K16M8cUB7FK5H4aZ+QI\u002fC9Shcr3dApHA9CtcLeUBcj8L1KG6KQPYoXI\u002fCFY1APQrXo3DtU0DD9ShcjxprQD0K16NwE4VAKVyPwvXQdkBSuB6F61lwQD0K16Nw5XJA4XoUrkeVdEA9CtejcJGKQLgehetRKGJAw\u002fUoXI8+hkC4HoXrUWqBQM3MzMzM+HJA4XoUrkeZekAK16NwPXpwQDMzMzMzO4NAUrgeheuxVkDD9Shcj0IuQClcj8L1vINAw\u002fUoXI9KaUAfhetRuA5UQIXrUbgeLXlA4XoUrkchTkAAAAAAAL6LQOxRuB6Fq0JAcT0K16M4gkA9CtejcMF7QBSuR+F6GoVAUrgehevtdEBI4XoUrm9kQFyPwvUosI5AuB6F61FEikBmZmZmZu6KQAAAAAAAHHBAmpmZmZk5SEBI4XoUrmNzQEjhehSu7YBArkfhehTWdEAfhetRuOyJQOF6FK5HbXFAzczMzMwsjkDXo3A9Cut8QM3MzMzMXIpArkfhehROaUCkcD0K1xN6QFyPwvUo9IVA16NwPQpfYkA9CtejcK1hQB+F61G4To5AmpmZmZlrhkAUrkfhelRJQOF6FK5HTXlA16NwPQpze0A="},"type":"scatter"},{"line":{"width":3},"mode":"lines","name":"7-Day Moving Average","x":["2023-01-01 00:00:00","2023-01-02 00:00:00","2023-01-03 00:00:00","2023-01-04 00:00:00","2023-01-05 00:00:00","2023-01-06 00:00:00","2023-01-07 00:00:00","2023-01-08 00:00:00","2023-01-09 00:00:00","2023-01-10 00:00:00","2023-01-11 00:00:00","2023-01-12 00:00:00","2023-01-13 00:00:00","2023-01-14 00:00:00","2023-01-15 00:00:00","2023-01-16 00:00:00","2023-01-17 00:00:00","2023-01-18 00:00:00","2023-01-19 00:00:00","2023-01-20 00:00:00","2023-01-21 00:00:00","2023-01-22 00:00:00","2023-01-23 00:00:00","2023-01-24 00:00:00","2023-01-25 00:00:00","2023-01-26 00:00:00","2023-01-27 00:00:00","2023-01-28 00:00:00","2023-01-29 00:00:00","2023-01-30 00:00:00","2023-01-31 00:00:00","2023-02-01 00:00:00","2023-02-02 00:00:00","2023-02-03 00:00:00","2023-02-04 00:00:00","2023-02-05 00:00:00","2023-02-06 00:00:00","2023-02-07 00:00:00","2023-02-08 00:00:00","2023-02-09 00:00:00","2023-02-10 00:00:00","2023-02-11 00:00:00","2023-02-12 00:00:00","2023-02-13 00:00:00","2023-02-14 00:00:00","2023-02-15 00:00:00","2023-02-16 00:00:00","2023-02-17 00:00:00","2023-02-18 00:00:00","2023-02-19 00:00:00","2023-02-20 00:00:00","2023-02-21 00:00:00","2023-02-22 00:00:00","2023-02-23 00:00:00","2023-02-24 00:00:00","2023-02-25 00:00:00","2023-02-26 00:00:00","2023-02-27 00:00:00","2023-02-28 00:00:00","2023-03-01 00:00:00","2023-03-02 00:00:00","2023-03-03 00:00:00","2023-03-04 00:00:00","2023-03-05 00:00:00","2023-03-06 00:00:00","2023-03-07 00:00:00","2023-03-08 00:00:00","2023-03-09 00:00:00","2023-03-10 00:00:00","2023-03-11 00:00:00","2023-03-12 00:00:00","2023-03-13 00:00:00","2023-03-14 00:00:00","2023-03-15 00:00:00","2023-03-16 00:00:00","2023-03-17 00:00:00","2023-03-18 00:00:00","2023-03-19 00:00:00","2023-03-20 00:00:00","2023-03-21 00:00:00","2023-03-22 00:00:00","2023-03-23 00:00:00","2023-03-24 00:00:00","2023-03-25 00:00:00","2023-03-26 00:00:00","2023-03-27 00:00:00","2023-03-28 00:00:00","2023-03-29 00:00:00","2023-03-30 00:00:00","2023-03-31 00:00:00","2023-04-01 00:00:00","2023-04-02 00:00:00","2023-04-03 00:00:00","2023-04-04 00:00:00","2023-04-05 00:00:00","2023-04-06 00:00:00","2023-04-07 00:00:00","2023-04-08 00:00:00","2023-04-09 00:00:00","2023-04-10 00:00:00"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkCamZmZmYV9QG2g0wY6M4RA9ihcj8KWgEDy0k1iEOR6QKcNdNpAm3tAkiRJkiRVeUDrUbgehUd4QLJa3hjB5HpAHtRBHdR5eEDaBcSm0qR5QCA2lYacR35AI5jo72RpfkDGV3zFVzqBQHiyWt4Yt4BAqYM6qIMIgEDTkHOfXSyBQC8gNpWG9oFAOEYw0d+Rg0DBRH8nqz2DQIr+TlbL+YFAq+WNEUy4g0Dp72S1vBGEQF\u002fxFV\u002fxj4NAwUR\u002fJ6ttgkDhehSuR6GAQK\u002f4iq\u002f4PIFAgdhUGnIWg0BFfyer5W2AQD+7gNhU3oFAq+WNEUwggEBcj8L1KFiAQK\u002f4iq\u002f4CoJAA2JTacjRgkA7WS1vjKKDQLdt27Zt54RAjWCiv5PzgkAWX\u002fEVX2eDQJFzn11AgIZAvuIrvuLtgkB9xVd8xfmAQHsUrkfhNntAbSoNOfepekDVQR3UQRF6QI1gor+TTXhAxld8xVcgc0BpyLnPLux5QBsjmOjvcH9AnqyWN0ZgfkBltbwxgtl9QK5H4XoUfn9AMYKJ\u002fk5ef0C4HoXrUSB+QPBktbwxRnlAEv2drJbnc0B+dgGxqch6QGp5YwQTJXpAtrwxgol6ekBSuB6F6zF8QPYoXI\u002fCkXxAw6bSkHOrfUDuswuITRV9QH52AbGp\u002fHpAT1bLGyOAekBVGnLus0d0QJmZmZmZ8XRACtejcD0KdED0d7Ja3vRwQL0xgon+MnJAdwGxqTR8akBvjGCiv1t0QKiDOqiDjnRABsSm0pAfdEBdj8L1KEh2QMZXfMVXmHtAUAd1UAf9ekA2lYac++h7QAd1UAd1wHxA4yu+4iv2gUCY6O9ktTSDQG+MYKK\u002fX4JABRP9nawmf0BL9HeyWu5+QLdt27ZtJ4FAkXOfXUCEfEBAbCoNOWt8QB+F61G4NndAfnYBsamIfUBvjGCiv52AQHVQB3VQ\u002f4JAjWCiv5N7gUAx0d\u002fJatuBQPBktbwxSoFA3hjBRH+zgEAZwUR\u002fJwt6QE30d7Jakn5Ah5z77AJyfUDxFV\u002fxFRd8QB+F61G4+ntA2gXEptKgeUA="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"legend":{"orientation":"h","yanchor":"bottom","y":1},"title":{"text":"Daily Sales with 7-Day Moving Average"},"xaxis":{"title":{"text":"Date"}},"yaxis":{"title":{"text":"Sales Amount ($)"}}},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html>

<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="900a3187-77f3-4ecc-99c2-8ad57eb077fa" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("900a3187-77f3-4ecc-99c2-8ad57eb077fa")) {                    Plotly.newPlot(                        "900a3187-77f3-4ecc-99c2-8ad57eb077fa",                        [{"mode":"lines","name":"Daily Sales","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkDXo3A9Cl98QK5H4XoUFI9APQrXo3AFZ0CkcD0K1+M7QDMzMzMzL39AKVyPwvVgZ0DNzMzMzEx3QKRwPQrXVYdApHA9CtedhkBI4XoUrq9zQHsUrkfhGIFApHA9CtcNgED2KFyPwv+DQI\u002fC9ShcH3BA9ihcj8KPgkDNzMzMzJiOQFK4HoXrvX5AuB6F61FYjEDNzMzMzIB7QOF6FK5HSXZAMzMzMzNFhECkcD0K1wGFQArXo3A9DItAXI\u002fC9Si8bUAzMzMzM4N\u002fQArXo3A9AoJAKVyPwvUWiED2KFyPwpVKQHsUrkfhFI9AAAAAAAC0fUBcj8L1KOxxQOF6FK5HpYtAUrgehetxh0C4HoXrUcyNQNejcD0KF3VAUrgehetpgUDD9ShcjwSCQArXo3A9pI5A9ihcj8IlVUAK16NwPYpzQAAAAAAA4GhAcT0K16M8cUB7FK5H4aZ+QI\u002fC9Shcr3dApHA9CtcLeUBcj8L1KG6KQPYoXI\u002fCFY1APQrXo3DtU0DD9ShcjxprQD0K16NwE4VAKVyPwvXQdkBSuB6F61lwQD0K16Nw5XJA4XoUrkeVdEA9CtejcJGKQLgehetRKGJAw\u002fUoXI8+hkC4HoXrUWqBQM3MzMzM+HJA4XoUrkeZekAK16NwPXpwQDMzMzMzO4NAUrgeheuxVkDD9Shcj0IuQClcj8L1vINAw\u002fUoXI9KaUAfhetRuA5UQIXrUbgeLXlA4XoUrkchTkAAAAAAAL6LQOxRuB6Fq0JAcT0K16M4gkA9CtejcMF7QBSuR+F6GoVAUrgehevtdEBI4XoUrm9kQFyPwvUosI5AuB6F61FEikBmZmZmZu6KQAAAAAAAHHBAmpmZmZk5SEBI4XoUrmNzQEjhehSu7YBArkfhehTWdEAfhetRuOyJQOF6FK5HbXFAzczMzMwsjkDXo3A9Cut8QM3MzMzMXIpArkfhehROaUCkcD0K1xN6QFyPwvUo9IVA16NwPQpfYkA9CtejcK1hQB+F61G4To5AmpmZmZlrhkAUrkfhelRJQOF6FK5HTXlA16NwPQpze0A="},"type":"scatter"},{"line":{"width":3},"mode":"lines","name":"7-Day Moving Average","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkCamZmZmYV9QG2g0wY6M4RA9ihcj8KWgEDy0k1iEOR6QKcNdNpAm3tAkiRJkiRVeUDtUbgehUd4QLNa3hjB5HpAHtRBHdR5eEDaBcSm0qR5QCA2lYacR35AI5jo72RpfkDGV3zFVzqBQHiyWt4Yt4BAqYM6qIMIgEDTkHOfXSyBQC8gNpWG9oFAN0Yw0d+Rg0DBRH8nqz2DQIr+TlbL+YFAq+WNEUy4g0Dp72S1vBGEQF\u002fxFV\u002fxj4NAwUR\u002fJ6ttgkDhehSuR6GAQK\u002f4iq\u002f4PIFAgNhUGnIWg0BFfyer5W2AQD+7gNhU3oFAq+WNEUwggEBdj8L1KFiAQLD4iq\u002f4CoJAAmJTacjRgkA7WS1vjKKDQLdt27Zt54RAjWCiv5PzgkAWX\u002fEVX2eDQJFzn11AgIZAv+IrvuLtgkB8xVd8xfmAQHoUrkfhNntAbSoNOfepekDTQR3UQRF6QItgor+TTXhAxld8xVcgc0BqyLnPLux5QBsjmOjvcH9AnqyWN0ZgfkBltbwxgtl9QK5H4XoUfn9AMYKJ\u002fk5ef0C4HoXrUSB+QPBktbwxRnlAE\u002f2drJbnc0B+dgGxqch6QGt5YwQTJXpAtrwxgol6ekBRuB6F6zF8QPYoXI\u002fCkXxAxabSkHOrfUDvswuITRV9QH52AbGp\u002fHpAUFbLGyOAekBWGnLus0d0QJqZmZmZ8XRACtejcD0KdED0d7Ja3vRwQLwxgon+MnJAdwGxqTR8akBwjGCiv1t0QKmDOqiDjnRABsSm0pAfdEBdj8L1KEh2QMZXfMVXmHtAUAd1UAf9ekA1lYac++h7QAh1UAd1wHxA4yu+4iv2gUCY6O9ktTSDQG+MYKK\u002fX4JABRP9nawmf0BL9HeyWu5+QLZt27ZtJ4FAkXOfXUCEfEBBbCoNOWt8QB+F61G4NndAfnYBsamIfUBvjGCiv52AQHZQB3VQ\u002f4JAjWCiv5N7gUAw0d\u002fJatuBQPFktbwxSoFA3hjBRH+zgEAYwUR\u002fJwt6QE30d7Jakn5Ah5z77AJyfUDyFV\u002fxFRd8QB6F61G4+ntA2gXEptKgeUA="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"legend":{"orientation":"h","yanchor":"bottom","y":1},"title":{"text":"Daily Sales with 7-Day Moving Average"},"xaxis":{"title":{"text":"Date"}},"yaxis":{"title":{"text":"Sales Amount ($)"}}},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html>

<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>                <div id="4b368d72-6cc8-4a34-bd57-a09ebf5d34a2" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("4b368d72-6cc8-4a34-bd57-a09ebf5d34a2")) {                    Plotly.newPlot(                        "4b368d72-6cc8-4a34-bd57-a09ebf5d34a2",                        [{"mode":"lines","name":"Daily Sales","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkDXo3A9Cl98QK5H4XoUFI9APQrXo3AFZ0CkcD0K1+M7QDMzMzMzL39AKVyPwvVgZ0DNzMzMzEx3QKRwPQrXVYdApHA9CtedhkBI4XoUrq9zQHsUrkfhGIFApHA9CtcNgED2KFyPwv+DQI\u002fC9ShcH3BA9ihcj8KPgkDNzMzMzJiOQFK4HoXrvX5AuB6F61FYjEDNzMzMzIB7QOF6FK5HSXZAMzMzMzNFhECkcD0K1wGFQArXo3A9DItAXI\u002fC9Si8bUAzMzMzM4N\u002fQArXo3A9AoJAKVyPwvUWiED2KFyPwpVKQHsUrkfhFI9AAAAAAAC0fUBcj8L1KOxxQOF6FK5HpYtAUrgehetxh0C4HoXrUcyNQNejcD0KF3VAUrgehetpgUDD9ShcjwSCQArXo3A9pI5A9ihcj8IlVUAK16NwPYpzQAAAAAAA4GhAcT0K16M8cUB7FK5H4aZ+QI\u002fC9Shcr3dApHA9CtcLeUBcj8L1KG6KQPYoXI\u002fCFY1APQrXo3DtU0DD9ShcjxprQD0K16NwE4VAKVyPwvXQdkBSuB6F61lwQD0K16Nw5XJA4XoUrkeVdEA9CtejcJGKQLgehetRKGJAw\u002fUoXI8+hkC4HoXrUWqBQM3MzMzM+HJA4XoUrkeZekAK16NwPXpwQDMzMzMzO4NAUrgeheuxVkDD9Shcj0IuQClcj8L1vINAw\u002fUoXI9KaUAfhetRuA5UQIXrUbgeLXlA4XoUrkchTkAAAAAAAL6LQOxRuB6Fq0JAcT0K16M4gkA9CtejcMF7QBSuR+F6GoVAUrgehevtdEBI4XoUrm9kQFyPwvUosI5AuB6F61FEikBmZmZmZu6KQAAAAAAAHHBAmpmZmZk5SEBI4XoUrmNzQEjhehSu7YBArkfhehTWdEAfhetRuOyJQOF6FK5HbXFAzczMzMwsjkDXo3A9Cut8QM3MzMzMXIpArkfhehROaUCkcD0K1xN6QFyPwvUo9IVA16NwPQpfYkA9CtejcK1hQB+F61G4To5AmpmZmZlrhkAUrkfhelRJQOF6FK5HTXlA16NwPQpze0A="},"type":"scatter"},{"line":{"width":3},"mode":"lines","name":"7-Day Moving Average","x":["2023-01-01","2023-01-02","2023-01-03","2023-01-04","2023-01-05","2023-01-06","2023-01-07","2023-01-08","2023-01-09","2023-01-10","2023-01-11","2023-01-12","2023-01-13","2023-01-14","2023-01-15","2023-01-16","2023-01-17","2023-01-18","2023-01-19","2023-01-20","2023-01-21","2023-01-22","2023-01-23","2023-01-24","2023-01-25","2023-01-26","2023-01-27","2023-01-28","2023-01-29","2023-01-30","2023-01-31","2023-02-01","2023-02-02","2023-02-03","2023-02-04","2023-02-05","2023-02-06","2023-02-07","2023-02-08","2023-02-09","2023-02-10","2023-02-11","2023-02-12","2023-02-13","2023-02-14","2023-02-15","2023-02-16","2023-02-17","2023-02-18","2023-02-19","2023-02-20","2023-02-21","2023-02-22","2023-02-23","2023-02-24","2023-02-25","2023-02-26","2023-02-27","2023-02-28","2023-03-01","2023-03-02","2023-03-03","2023-03-04","2023-03-05","2023-03-06","2023-03-07","2023-03-08","2023-03-09","2023-03-10","2023-03-11","2023-03-12","2023-03-13","2023-03-14","2023-03-15","2023-03-16","2023-03-17","2023-03-18","2023-03-19","2023-03-20","2023-03-21","2023-03-22","2023-03-23","2023-03-24","2023-03-25","2023-03-26","2023-03-27","2023-03-28","2023-03-29","2023-03-30","2023-03-31","2023-04-01","2023-04-02","2023-04-03","2023-04-04","2023-04-05","2023-04-06","2023-04-07","2023-04-08","2023-04-09","2023-04-10"],"y":{"dtype":"f8","bdata":"XI\u002fC9SisfkCamZmZmYV9QG2g0wY6M4RA9ihcj8KWgEDy0k1iEOR6QKgNdNpAm3tAkiRJkiRVeUDrUbgehUd4QLJa3hjB5HpAHtRBHdR5eEDaBcSm0qR5QCA2lYacR35AI5jo72RpfkDGV3zFVzqBQHiyWt4Yt4BAqYM6qIMIgEDTkHOfXSyBQC8gNpWG9oFAOEYw0d+Rg0DBRH8nqz2DQIr+TlbL+YFAq+WNEUy4g0Dp72S1vBGEQF\u002fxFV\u002fxj4NAwUR\u002fJ6ttgkDhehSuR6GAQK\u002f4iq\u002f4PIFAgNhUGnIWg0BFfyer5W2AQD+7gNhU3oFAq+WNEUwggEBcj8L1KFiAQK\u002f4iq\u002f4CoJAAmJTacjRgkA7WS1vjKKDQLdt27Zt54RAjWCiv5PzgkAWX\u002fEVX2eDQJFzn11AgIZAvuIrvuLtgkB9xVd8xfmAQHsUrkfhNntAbSoNOfepekDVQR3UQRF6QI1gor+TTXhAxld8xVcgc0BpyLnPLux5QBsjmOjvcH9AnqyWN0ZgfkBltbwxgtl9QK5H4XoUfn9AMoKJ\u002fk5ef0C4HoXrUSB+QPBktbwxRnlAE\u002f2drJbnc0B+dgGxqch6QGp5YwQTJXpAtrwxgol6ekBSuB6F6zF8QPYoXI\u002fCkXxAw6bSkHOrfUDuswuITRV9QH52AbGp\u002fHpAT1bLGyOAekBVGnLus0d0QJmZmZmZ8XRACtejcD0KdED0d7Ja3vRwQL0xgon+MnJAdwGxqTR8akBwjGCiv1t0QKiDOqiDjnRAB8Sm0pAfdEBdj8L1KEh2QMZXfMVXmHtAUQd1UAf9ekA3lYac++h7QAd1UAd1wHxA4yu+4iv2gUCY6O9ktTSDQG+MYKK\u002fX4JABRP9nawmf0BN9HeyWu5+QLdt27ZtJ4FAkXOfXUCEfEBAbCoNOWt8QB+F61G4NndAfnYBsamIfUBvjGCiv52AQHZQB3VQ\u002f4JAjWCiv5N7gUAx0d\u002fJatuBQPBktbwxSoFA3hjBRH+zgEAZwUR\u002fJwt6QE30d7Jakn5Ah5z77AJyfUDxFV\u002fxFRd8QB+F61G4+ntA2gXEptKgeUA="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":true,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"legend":{"orientation":"h","yanchor":"bottom","y":1},"title":{"text":"Daily Sales with 7-Day Moving Average"},"xaxis":{"title":{"text":"Date"}},"yaxis":{"title":{"text":"Sales Amount ($)"}}},                        {"responsive": true}                    )                };            </script>        </div>
</body>
</html>

<h2 id="5-ranking-and-partitioning">5. Ranking and Partitioning<a class="headerlink" href="#5-ranking-and-partitioning" title="Permanent link">🔗</a></h2>
<p>The fifth section will demonstrate how to rank and partition data. This is useful for identifying top performers, such as the highest spending customers or the most popular products.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:4"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><input id="__tabbed_19_3" name="__tabbed_19" type="radio" /><input id="__tabbed_19_4" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">Pandas</label><label for="__tabbed_19_2">SQL</label><label for="__tabbed_19_3">PySpark</label><label for="__tabbed_19_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas, we can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rank.html"><code>.rank()</code></a> method to rank values in a DataFrame. This method allows us to specify the ranking method (e.g., dense, average, min, max) and whether to rank in ascending or descending order.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rank customers by total spending</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">customer_spending_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_sales_pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;customer_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">total_spending</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">))</span>
<span class="n">customer_spending_pd</span><span class="p">[</span><span class="s2">&quot;rank&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">customer_spending_pd</span><span class="p">[</span><span class="s2">&quot;total_spending&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">customer_spending_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">customer_spending_pd</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer Spending Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">customer_spending_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_spending_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_spending_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Customer Spending Summary: 61
</code></pre></div>
<div class="highlight"><pre><span></span><code>   customer_id  total_spending  rank
0           15         2297.55   1.0
1            4         2237.49   2.0
2           62         2177.35   3.0
3           60         2086.09   4.0
4           21         2016.95   5.0
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">total_spending</th>
<th style="text-align: right;">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2297.55</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2237.49</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">2177.35</td>
<td style="text-align: right;">3</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">2086.09</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">2016.95</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the <code>DENSE_RANK()</code> window function to rank values in a query. This function assigns a rank to each row within a partition of a given result set, with no gaps in the ranking values. Note that this function can only be used in congunction with the <code>OVER</code> clause, which defines it as a Window function. The <code>ORDER BY</code> clause within the <code>OVER</code> clause specifies the order in which the rows are ranked.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rank customers by total spending</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">customer_spending_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        customer_id,</span>
<span class="s2">        SUM(sales_amount) AS total_spending,</span>
<span class="s2">        DENSE_RANK() OVER (ORDER BY SUM(sales_amount) DESC) AS rank</span>
<span class="s2">    FROM sales</span>
<span class="s2">    GROUP BY customer_id</span>
<span class="s2">    ORDER BY rank</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">customer_spending_sql</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">customer_spending_txt</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer Spending Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">customer_spending_sql</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_spending_sql</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_spending_sql</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Customer Spending Summary: 61
</code></pre></div>
<div class="highlight"><pre><span></span><code>   customer_id  total_spending  rank
0           15         2297.55     1
1            4         2237.49     2
2           62         2177.35     3
3           60         2086.09     4
4           21         2016.95     5
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">total_spending</th>
<th style="text-align: right;">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2297.55</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2237.49</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">2177.35</td>
<td style="text-align: right;">3</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">2086.09</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">2016.95</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.dense_rank.html"><code>F.dense_rank()</code></a> function in combination with the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.html"><code>Window()</code></a> class to rank values in a DataFrame. The <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.html"><code>Window()</code></a> class allows us to define a window specification for the calculation, and the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.dense_rank.html"><code>F.dense_rank()</code></a> function calculates the dense rank of each row within that window.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rank customers by total spending</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">customer_spending_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;customer_id&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_spending&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">dense_rank</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">Window</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s2">&quot;total_spending&quot;</span><span class="p">))))</span>
    <span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer Spending Summary: </span><span class="si">{</span><span class="n">customer_spending_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">customer_spending_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_spending_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Customer Spending Summary: 61
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-----------+------------------+----+
|customer_id|    total_spending|rank|
+-----------+------------------+----+
|         15|           2297.55|   1|
|          4|           2237.49|   2|
|         62|           2177.35|   3|
|         60|2086.0899999999997|   4|
|         21|           2016.95|   5|
+-----------+------------------+----+
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">total_spending</th>
<th style="text-align: right;">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2297.55</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2237.49</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">2177.35</td>
<td style="text-align: right;">3</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">2086.09</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">2016.95</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/dev/reference/expressions/api/polars.Expr.rank.html"><code>.rank()</code></a> method to rank values in a DataFrame. This method allows us to specify the ranking method (e.g., dense, average, min, max) and whether to rank in ascending or descending order.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rank customers by total spending</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">customer_spending_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;customer_id&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sales_amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_spending&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;total_spending&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer Spending Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">customer_spending_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_spending_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_spending_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Customer Spending Summary: 61
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (5, 3)
┌─────────────┬────────────────┬──────┐
│ customer_id ┆ total_spending ┆ rank │
│ ---         ┆ ---            ┆ ---  │
│ i64         ┆ f64            ┆ u32  │
╞═════════════╪════════════════╪══════╡
│ 15          ┆ 2297.55        ┆ 1    │
│ 4           ┆ 2237.49        ┆ 2    │
│ 62          ┆ 2177.35        ┆ 3    │
│ 60          ┆ 2086.09        ┆ 4    │
│ 21          ┆ 2016.95        ┆ 5    │
└─────────────┴────────────────┴──────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">customer_id</th>
<th style="text-align: right;">total_spending</th>
<th style="text-align: right;">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2297.55</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2237.49</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">2177.35</td>
<td style="text-align: right;">3</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">2086.09</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">2016.95</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Next, we will rank products based on the quantity sold, partitioned by the product category. This will help us identify the most popular products within each category.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:4"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><input id="__tabbed_20_2" name="__tabbed_20" type="radio" /><input id="__tabbed_20_3" name="__tabbed_20" type="radio" /><input id="__tabbed_20_4" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">Pandas</label><label for="__tabbed_20_2">SQL</label><label for="__tabbed_20_3">PySpark</label><label for="__tabbed_20_4">Polars</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In Pandas it is first necessary to group the sales data by <code>category</code> and <code>product_id</code>, then aggregate the data for the <a href="https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.DataFrameGroupBy.sum.html"><code>.sum()</code></a> of the <code>quantity</code> to find the <code>total_quantity</code> sold for each product. After that, we can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rank.html"><code>.rank()</code></a> method to rank the products within each category based on the total quantity sold.</p>
<p>It is important to note here that we are implementing the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rank.html"><code>.rank()</code></a> method from within an <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.assign.html"><code>.assign()</code></a> method. This is a common pattern in Pandas to create new columns on a DataFrame based on other columns already existing on the DataFrame, while keeping the DataFrame immutable. Here, we are using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html"><code>.groupby()</code></a> method to group the DataFrame by <code>category</code>, and then applying the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rank.html"><code>.rank()</code></a> method to the <code>total_quantity</code> column within each category. In this way, we are creating a partitioned DataFrame that ranks products by quantity sold within each category.</p>
<div class="pandas highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rank products by quantity sold, by category</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">product_popularity_pd</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_sales_pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;product_id&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span>
        <span class="n">total_quantity</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">rank</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)[</span><span class="s2">&quot;total_quantity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product Popularity Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">product_popularity_pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_popularity_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_popularity_pd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Product Popularity Summary: 78
</code></pre></div>
<div class="highlight"><pre><span></span><code>      category  product_id  total_quantity  rank
0        Books          11              14   1.0
1     Clothing           7               9   1.0
2  Electronics          37              16   1.0
3         Food          45              34   1.0
4         Home           3              10   1.0
5        Books          28               9   2.0
6     Clothing          35               8   2.0
7  Electronics          35              11   2.0
8         Food           1              16   2.0
9         Home           9               5   2.0
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: right;">total_quantity</th>
<th style="text-align: right;">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In SQL, we can use the <code>RANK()</code> window function to rank products within each category based on the total quantity sold. The <code>PARTITION BY</code> clause allows us to partition the data by <code>category</code>, and the <code>ORDER BY</code> clause specifies the order in which the rows are ranked within each partition.</p>
<div class="sql highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rank products by quantity sold, by category</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">product_popularity_txt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        category,</span>
<span class="s2">        product_id,</span>
<span class="s2">        SUM(quantity) AS total_quantity,</span>
<span class="s2">        RANK() OVER (PARTITION BY category ORDER BY SUM(quantity) DESC) AS rank</span>
<span class="s2">    FROM sales</span>
<span class="s2">    GROUP BY category, product_id</span>
<span class="s2">    ORDER BY rank</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product Popularity: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">product_popularity_txt</span><span class="p">,</span><span class="w"> </span><span class="n">conn</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">product_popularity_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 10&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">product_popularity_txt</span> <span class="o">+</span> <span class="s2">&quot;LIMIT 10&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Product Popularity: 78
</code></pre></div>
<div class="highlight"><pre><span></span><code>      category  product_id  total_quantity  rank
0        Books          11              14     1
1     Clothing           7               9     1
2  Electronics          37              16     1
3         Food          45              34     1
4         Home           3              10     1
5        Books          28               9     2
6     Clothing          35               8     2
7  Electronics          35              11     2
8         Food           1              16     2
9         Home          48               5     2
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: right;">total_quantity</th>
<th style="text-align: right;">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In PySpark, we can use the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.dense_rank.html"><code>F.dense_rank()</code></a> function in combination with the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.html"><code>Window()</code></a> class to rank products within each category based on the total quantity sold. We can define the partitioning by using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.partitionBy.html"><code>.partitionBy()</code></a> method and parse'ing in the <code>"category"</code> column. We can then define the ordering by using the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.Window.orderBy.html"><code>.orderBy()</code></a> method and parse'ing in the <code>"total_quantity"</code> expression to order the products by total quantity sold in descending order with the <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.desc.html"><code>F.desc()</code></a> method.</p>
<p>Here, we have also provided an alternative way to define the rank by using the Spark SQL method. The outcome is the same, it's simply written in a SQL-like expression.</p>
<div class="pyspark highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rank products by quantity sold, by category</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">product_popularity_ps</span><span class="p">:</span> <span class="n">psDataFrame</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_sales_ps</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;product_id&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_quantity&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;rank_p&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">dense_rank</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">Window</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s2">&quot;total_quantity&quot;</span><span class="p">))),</span>
            <span class="s2">&quot;rank_s&quot;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;DENSE_RANK() OVER (PARTITION BY category ORDER BY total_quantity DESC)&quot;</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s2">&quot;rank_p&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product Popularity Summary: </span><span class="si">{</span><span class="n">product_popularity_ps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">product_popularity_ps</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_popularity_ps</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Product Popularity Summary: 78
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-----------+----------+--------------+------+------+
|   category|product_id|total_quantity|rank_p|rank_s|
+-----------+----------+--------------+------+------+
|   Clothing|         7|             9|     1|     1|
|      Books|        11|            14|     1|     1|
|Electronics|        37|            16|     1|     1|
|       Food|        45|            34|     1|     1|
|       Home|         3|            10|     1|     1|
|      Books|        28|             9|     2|     2|
|Electronics|        35|            11|     2|     2|
|       Home|        29|             5|     2|     2|
|       Home|        48|             5|     2|     2|
|       Home|         9|             5|     2|     2|
+-----------+----------+--------------+------+------+
only showing top 10 rows
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: right;">total_quantity</th>
<th style="text-align: right;">rank_p</th>
<th style="text-align: right;">rank_s</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<p>In Polars, we can use the <a href="https://docs.pola.rs/api/python/dev/reference/expressions/api/polars.Expr.rank.html"><code>.rank()</code></a> method to rank products within each category based on the total quantity sold. We first group the sales data by <code>category</code> and <code>product_id</code>, then aggregate the data for the <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/api/polars.dataframe.group_by.GroupBy.sum.html"><code>.sum()</code></a> of the <code>quantity</code> to find the <code>total_quantity</code> sold for each product. After that, we can use the <a href="https://docs.pola.rs/api/python/dev/reference/expressions/api/polars.Expr.rank.html"><code>.rank()</code></a> method to rank the products within each category based on the total quantity sold. Finally, we can define the partitioning by using the <a href="https://docs.pola.rs/api/python/dev/reference/expressions/api/polars.Expr.over.html"><code>.over()</code></a> method and parse'ing in <code>partition_by="category"</code>.</p>
<div class="polars highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Rank products by quantity sold, by category</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">product_popularity_pl</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_sales_pl</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;product_id&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;total_quantity&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;total_quantity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">partition_by</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product Popularity Summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">product_popularity_pl</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_popularity_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_popularity_pl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<div class="result" markdown>
<div class="highlight"><pre><span></span><code>Product Popularity Summary: 78
</code></pre></div>
<div class="highlight"><pre><span></span><code>shape: (10, 4)
┌─────────────┬────────────┬────────────────┬──────┐
│ category    ┆ product_id ┆ total_quantity ┆ rank │
│ ---         ┆ ---        ┆ ---            ┆ ---  │
│ str         ┆ i64        ┆ i64            ┆ u32  │
╞═════════════╪════════════╪════════════════╪══════╡
│ Books       ┆ 11         ┆ 14             ┆ 1    │
│ Clothing    ┆ 7          ┆ 9              ┆ 1    │
│ Electronics ┆ 37         ┆ 16             ┆ 1    │
│ Food        ┆ 45         ┆ 34             ┆ 1    │
│ Home        ┆ 3          ┆ 10             ┆ 1    │
│ Books       ┆ 28         ┆ 9              ┆ 2    │
│ Clothing    ┆ 35         ┆ 8              ┆ 2    │
│ Electronics ┆ 35         ┆ 11             ┆ 2    │
│ Food        ┆ 1          ┆ 16             ┆ 2    │
│ Home        ┆ 48         ┆ 5              ┆ 2    │
└─────────────┴────────────┴────────────────┴──────┘
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;">category</th>
<th style="text-align: right;">product_id</th>
<th style="text-align: right;">total_quantity</th>
<th style="text-align: right;">rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Books</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Clothing</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Electronics</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Food</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Home</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">🔗</a></h2>
<p>This comprehensive guide has demonstrated how to perform essential data querying and manipulation operations across four powerful tools: <a href="https://pandas.pydata.org/">Pandas</a>, <a href="https://sqlite.org/">SQL</a>, <a href="https://spark.apache.org/docs/latest/api/python/">PySpark</a>, and <a href="https://www.pola.rs/">Polars</a>. Each tool brings unique advantages to the data processing landscape, and understanding their strengths helps you choose the right tool for your specific use case.</p>
<h3 id="tool-comparison-and-use-cases">Tool Comparison and Use Cases<a class="headerlink" href="#tool-comparison-and-use-cases" title="Permanent link">🔗</a></h3>
<div class="grid cards">
<ul>
<li>
<p><a href="https://pandas.pydata.org/"><strong>Pandas</strong></a> has an extensive ecosystem, making it ideal for:</p>
<ul>
<li>Small to medium datasets (up to millions of rows)</li>
<li>Interactive data exploration and visualization</li>
<li>Data preprocessing for machine learning workflows</li>
<li>Quick statistical analysis and reporting</li>
</ul>
<hr />
<p><strong>Pandas</strong> remains the go-to choice for exploratory data analysis and rapid prototyping.</p>
</li>
<li>
<p><a href="https://sqlite.org/"><strong>SQL</strong></a> excels in:</p>
<ul>
<li>Working with relational databases and data warehouses</li>
<li>Complex joins and subqueries</li>
<li>Declarative data transformations</li>
<li>Team environments where SQL knowledge is widespread</li>
</ul>
<hr />
<p><strong>SQL</strong> provides the universal language of data with unmatched expressiveness for complex queries</p>
</li>
<li>
<p><a href="https://spark.apache.org/docs/latest/api/python/"><strong>PySpark</strong></a> is great for when you need:</p>
<ul>
<li>Processing datasets that don't fit in memory (terabytes or larger)</li>
<li>Distributed computing across clusters</li>
<li>Integration with Hadoop ecosystem components</li>
<li>Scalable machine learning with MLlib</li>
</ul>
<hr />
<p><strong>PySpark</strong> unlocks the power of distributed computing for big data scenarios.</p>
</li>
<li>
<p><a href="https://www.pola.rs/"><strong>Polars</strong></a> is particularly valuable for:</p>
<ul>
<li>Large datasets that require fast processing (gigabytes to small terabytes)</li>
<li>Performance-critical applications</li>
<li>Memory-constrained environments</li>
<li>Lazy evaluation and query optimization</li>
</ul>
<hr />
<p><strong>Polars</strong> emerges as the high-performance alternative with excellent memory efficiency.</p>
</li>
</ul>
</div>
<h3 id="key-techniques-covered">Key Techniques Covered<a class="headerlink" href="#key-techniques-covered" title="Permanent link">🔗</a></h3>
<p>Throughout this guide, we've explored fundamental data manipulation patterns that remain consistent across all tools:</p>
<ol>
<li><strong>Data Filtering and Selection</strong> - Essential for subsetting data based on conditions</li>
<li><strong>Grouping and Aggregation</strong> - Critical for summarizing data by categories</li>
<li><strong>Joining and Merging</strong> - Necessary for combining data from multiple sources</li>
<li><strong>Window Functions</strong> - Powerful for time-series analysis and advanced calculations</li>
<li><strong>Ranking and Partitioning</strong> - Useful for identifying top performers and comparative analysis</li>
</ol>
<h3 id="best-practices-and-recommendations">Best Practices and Recommendations<a class="headerlink" href="#best-practices-and-recommendations" title="Permanent link">🔗</a></h3>
<p>When working with any of these tools, consider these best practices:</p>
<ul>
<li><strong>Start with the right tool</strong>: Match your tool choice to your data size, infrastructure, and team expertise</li>
<li><strong>Understand your data</strong>: Always examine data types, null values, and distributions before processing</li>
<li><strong>Optimize for readability</strong>: Write clear, well-documented code that your future self and teammates can understand</li>
<li><strong>Profile performance</strong>: Measure execution time and memory usage, especially for large datasets</li>
<li><strong>Leverage built-in optimizations</strong>: Use vectorized operations, avoid loops, and take advantage of lazy evaluation where available</li>
</ul>
<h3 id="moving-forward">Moving Forward<a class="headerlink" href="#moving-forward" title="Permanent link">🔗</a></h3>
<p>The data landscape continues to evolve rapidly, with new tools and techniques emerging regularly. The fundamental concepts demonstrated in this guide—filtering, grouping, joining, and analytical functions—remain constant across platforms. By mastering these core concepts, you'll be well-equipped to adapt to new tools and technologies as they arise.</p>
<p>Whether you're analyzing customer behavior, processing sensor data, or building machine learning models, the techniques in this guide provide a solid foundation for effective data manipulation. Remember that the best tool is often the one that best fits your specific requirements for performance, scalability, and team capabilities.</p>
<p>Continue practicing with real datasets, explore advanced features of each tool, and stay curious about emerging technologies in the data processing ecosystem. The skills you've learned here will serve as building blocks for increasingly sophisticated data analysis and engineering tasks.</p>
<!--
-- ------------------------ --
--  Shortcuts & Hyperlinks  --
-- ------------------------ --
-->

<!-- Python -->
<!-- Storage -->
<!-- Guides -->
<!-- Pandas -->
<!-- SQL -->
<!-- SQL -->
<!-- Polars -->
<!-- Plotly -->












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.instant", "search.highlight", "search.suggest", "toc.follow", "content.action.edit", "content.action.view", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>